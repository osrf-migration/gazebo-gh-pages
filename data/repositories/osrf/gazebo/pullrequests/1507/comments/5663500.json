{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1507/comments/5663500.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1507/_/diff#comment-5663500"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1507, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1507.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1507"}}, "title": "fix the dRecip operation for when numerically denominator equals 0"}, "content": {"raw": "I did spend some time on this issue. And now the test passed... But I changed one line [here](https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-500) in the test code.  It is really weird, when we run more time steps (`i=11`), the test passed, while run fewer (`i=10`), the test fails. \n\nThere might be three causes:\n \n1. numerical issue \n\n2. `world->Reset()` [here](https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-439), for all the 8 double pendulum, after reset, not all of the double pendulum has velocity as `0`, I am not sure whether they should be, but the one that fails the test, has a relatively large velocity after reset the world \n\n3. `joint->Detach()` [here](https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-475), I know this is to detach the parent and child, but didn't get an idea of the implementation. \n\nThe test passes for now, with `i=11`, Jenkins build [here](http://build.osrfoundation.org/job/gazebo-any-external-trusty-amd64-gpu-nvidia/32/console)\n", "markup": "markdown", "html": "<p>I did spend some time on this issue. And now the test passed... But I changed one line <a data-is-external-link=\"true\" href=\"https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-500\" rel=\"nofollow\">here</a> in the test code.  It is really weird, when we run more time steps (<code>i=11</code>), the test passed, while run fewer (<code>i=10</code>), the test fails. </p>\n<p>There might be three causes:</p>\n<ol>\n<li>\n<p>numerical issue </p>\n</li>\n<li>\n<p><code>world-&gt;Reset()</code> <a data-is-external-link=\"true\" href=\"https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-439\" rel=\"nofollow\">here</a>, for all the 8 double pendulum, after reset, not all of the double pendulum has velocity as <code>0</code>, I am not sure whether they should be, but the one that fails the test, has a relatively large velocity after reset the world </p>\n</li>\n<li>\n<p><code>joint-&gt;Detach()</code> <a data-is-external-link=\"true\" href=\"https://bitbucket.org/rosebudflyaway/gazebo/src/854cf67f5cdbb771a780525b5d9fe2041e91d95b/test/integration/joint_revolute.cc?at=world_step_cfm_issue1437#cl-475\" rel=\"nofollow\">here</a>, I know this is to detach the parent and child, but didn't get an idea of the implementation. </p>\n</li>\n</ol>\n<p>The test passes for now, with <code>i=11</code>, Jenkins build <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-external-trusty-amd64-gpu-nvidia/32/console\" rel=\"nofollow\">here</a></p>", "type": "rendered"}, "created_on": "2015-03-14T01:43:02.970146+00:00", "user": {"display_name": "Ying Lu", "uuid": "{11ec131e-4af6-4228-beaf-167b1c8d1c2c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D"}, "html": {"href": "https://bitbucket.org/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:659bfe31-d941-44f5-aa6d-00058b070ea8/c88d5925-8a09-40c7-8684-c02aeafe0f59/128"}}, "nickname": "rosebudflyaway", "type": "user", "account_id": "557058:659bfe31-d941-44f5-aa6d-00058b070ea8"}, "updated_on": "2015-03-14T01:43:22.337303+00:00", "type": "pullrequest_comment", "id": 5663500}