{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/275/comments/109735.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/275/_/diff#comment-109735"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 275, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/275.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/275"}}, "title": "Fix the PROFILE building mode"}, "content": {"raw": "When I run:\n\nCPUPROFILE=/tmp/profile gzserver\n\nI get a segault with this backtrace:\n\n\n```\n#0  0x00007ffff4c99f79 in ?? () from /usr/lib/libunwind.so.7\n#1  0x00007ffff4c97194 in ?? () from /usr/lib/libunwind.so.7\n#2  0x00007ffff4c98363 in ?? () from /usr/lib/libunwind.so.7\n#3  0x00007ffff4c986e9 in ?? () from /usr/lib/libunwind.so.7\n#4  0x00007ffff4c9ab1a in _ULx86_64_step () from /usr/lib/libunwind.so.7\n#5  0x00007ffff7bcf6d8 in GetStackTraceWithContext(void**, int, int, void const*) () from /usr/lib/libprofiler.so.0\n#6  0x00007ffff7bcd4dd in ?? () from /usr/lib/libprofiler.so.0\n#7  0x00007ffff7bcde93 in ProfileHandler::SignalHandler(int, siginfo*, void*)\n    () from /usr/lib/libprofiler.so.0\n#8  <signal handler called>\n#9  __GI__dl_debug_state () at dl-debug.c:77\n#10 0x00007ffff7de09fa in _dl_map_object_from_fd (\n    name=0x7fffffffc300 \"libnss_files.so.2\", fd=15, fbp=0x7fffffffbb20, \n    realname=0x821310 \"/lib/x86_64-linux-gnu/libnss_files.so.2\", loader=0x0, \n    l_type=2, mode=-1879048191, stack_endp=0x7fffffffbe80, nsid=0)\n    at dl-load.c:1044\n#11 0x00007ffff7de269a in _dl_map_object (loader=0x0, \n    name=0x7fffffffc300 \"libnss_files.so.2\", type=2, trace_mode=0, \n    mode=-1879048191, nsid=<optimized out>) at dl-load.c:2568\n#12 0x00007ffff7ded84b in dl_open_worker (a=0x7fffffffc0b0) at dl-open.c:225\n#13 0x00007ffff7de9176 in _dl_catch_error (objname=0x7fffffffc0f8, \n    errstring=0x7fffffffc100, mallocedp=0x7fffffffc10f, \n    operate=0x7ffff7ded700 <dl_open_worker>, args=0x7fffffffc0b0)\n    at dl-error.c:178\n#14 0x00007ffff7ded31a in _dl_open (file=0x7fffffffc300 \"libnss_files.so.2\", \n    mode=-2147483647, caller_dlopen=0x7ffff4fb1a1e, nsid=-2, argc=1, \n    argv=<optimized out>, env=0x7fffffffdd48) at dl-open.c:639\n#15 0x00007ffff4fdc602 in do_dlopen (ptr=0x7fffffffc2b0) at dl-libc.c:89\n#16 0x00007ffff7de9176 in _dl_catch_error (objname=0x7fffffffc2e0, \n    errstring=0x7fffffffc2d0, mallocedp=0x7fffffffc2ef, \n    operate=0x7ffff4fdc5c0 <do_dlopen>, args=0x7fffffffc2b0) at dl-error.c:178\n#17 0x00007ffff4fdc6c4 in dlerror_run (args=0x7fffffffc2b0, \n    operate=0x7ffff4fdc5c0 <do_dlopen>) at dl-libc.c:48\n#18 __GI___libc_dlopen_mode (name=<optimized out>, mode=<optimized out>)\n    at dl-libc.c:165\n#19 0x00007ffff4fb1a1e in nss_load_library (ni=<optimized out>)\n    at nsswitch.c:372\n#20 0x00007ffff4fb247d in __GI___nss_lookup_function (ni=0x8756f0, \n    fct_name=0x7ffff50272b9 \"gethostbyname4_r\") at nsswitch.c:474\n#21 0x00007ffff4f77012 in gaih_inet (name=0x85f398 \"localhost\", \n    service=<optimized out>, req=0x7fffffffcdd0, pai=<optimized out>, \n    naddrs=0x7fffffffcb80) at ../sysdeps/posix/getaddrinfo.c:834\n#22 0x00007ffff4f7a98e in __GI_getaddrinfo (name=0x85f398 \"localhost\", \n    service=<optimized out>, hints=0x7fffffffcdd0, pai=0x7fffffffcce8)\n    at ../sysdeps/posix/getaddrinfo.c:2423\n#23 0x00007ffff740547c in boost::asio::detail::socket_ops::getaddrinfo (\n    host=0x85f398 \"localhost\", service=0x7ee388 \"11345\", hints=..., \n    result=0x7fffffffcce8, ec=...)\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:2702\n#24 0x00007ffff7413bc3 in boost::asio::detail::resolver_service<boost::asio::ip::tcp>::resolve (this=0x7d3778, query=..., ec=...)\n    at /usr/include/boost/asio/detail/resolver_service.hpp:60\n#25 0x00007ffff74101f3 in boost::asio::ip::resolver_service<boost::asio::ip::tcp>::resolve (this=0x7d3750, impl=..., query=..., ec=...)\n    at /usr/include/boost/asio/ip/resolver_service.hpp:108\n#26 0x00007ffff740b9b3 in boost::asio::ip::basic_resolver<boost::asio::ip::tcp, boost::asio::ip::resolver_service<boost::asio::ip::tcp> >::resolve (\n    this=0x7fffffffce60, q=...)\n    at /usr/include/boost/asio/ip/basic_resolver.hpp:101\n#27 0x00007ffff73fa2d8 in gazebo::transport::Connection::Connect (\n    this=0x81c2b0, _host=..., _port=11345)\n    at /home/nkoenig/work/gazebo/gazebo/transport/Connection.cc:126\n#28 0x00007ffff741e487 in gazebo::transport::ConnectionManager::Init (\n    this=0x6b7040, _masterHost=..., master_port=11345)\n    at /home/nkoenig/work/gazebo/gazebo/transport/ConnectionManager.cc:78\n#29 0x00007ffff74482b1 in gazebo::transport::init (_masterHost=..., \n    _masterPort=0)\n    at /home/nkoenig/work/gazebo/gazebo/transport/Transport.cc:73\n#30 0x0000000000493088 in gazebo::load (argc=1, argv=0x6e00b0)\n    at /home/nkoenig/work/gazebo/gazebo/gazebo.cc:68\n#31 0x0000000000469aa4 in gazebo::Server::LoadImpl (this=0x6f71e0, _elem=...)\n    at /home/nkoenig/work/gazebo/gazebo/Server.cc:284\n#32 0x00000000004694ae in gazebo::Server::LoadFile (this=0x6f71e0, \n    _filename=...) at /home/nkoenig/work/gazebo/gazebo/Server.cc:247\n#33 0x0000000000468a72 in gazebo::Server::ParseArgs (this=0x6f71e0, argc=1, \n    argv=0x7fffffffdd38) at /home/nkoenig/work/gazebo/gazebo/Server.cc:205\n#34 0x0000000000465610 in main (argc=1, argv=0x7fffffffdd38)\n    at /home/nkoenig/work/gazebo/gazebo/server_main.cc:40\n```", "markup": "markdown", "html": "<p>When I run:</p>\n<p>CPUPROFILE=/tmp/profile gzserver</p>\n<p>I get a segault with this backtrace:</p>\n<div class=\"codehilite\"><pre><span></span>#0  0x00007ffff4c99f79 in ?? () from /usr/lib/libunwind.so.7\n#1  0x00007ffff4c97194 in ?? () from /usr/lib/libunwind.so.7\n#2  0x00007ffff4c98363 in ?? () from /usr/lib/libunwind.so.7\n#3  0x00007ffff4c986e9 in ?? () from /usr/lib/libunwind.so.7\n#4  0x00007ffff4c9ab1a in _ULx86_64_step () from /usr/lib/libunwind.so.7\n#5  0x00007ffff7bcf6d8 in GetStackTraceWithContext(void**, int, int, void const*) () from /usr/lib/libprofiler.so.0\n#6  0x00007ffff7bcd4dd in ?? () from /usr/lib/libprofiler.so.0\n#7  0x00007ffff7bcde93 in ProfileHandler::SignalHandler(int, siginfo*, void*)\n    () from /usr/lib/libprofiler.so.0\n#8  &lt;signal handler called&gt;\n#9  __GI__dl_debug_state () at dl-debug.c:77\n#10 0x00007ffff7de09fa in _dl_map_object_from_fd (\n    name=0x7fffffffc300 &quot;libnss_files.so.2&quot;, fd=15, fbp=0x7fffffffbb20, \n    realname=0x821310 &quot;/lib/x86_64-linux-gnu/libnss_files.so.2&quot;, loader=0x0, \n    l_type=2, mode=-1879048191, stack_endp=0x7fffffffbe80, nsid=0)\n    at dl-load.c:1044\n#11 0x00007ffff7de269a in _dl_map_object (loader=0x0, \n    name=0x7fffffffc300 &quot;libnss_files.so.2&quot;, type=2, trace_mode=0, \n    mode=-1879048191, nsid=&lt;optimized out&gt;) at dl-load.c:2568\n#12 0x00007ffff7ded84b in dl_open_worker (a=0x7fffffffc0b0) at dl-open.c:225\n#13 0x00007ffff7de9176 in _dl_catch_error (objname=0x7fffffffc0f8, \n    errstring=0x7fffffffc100, mallocedp=0x7fffffffc10f, \n    operate=0x7ffff7ded700 &lt;dl_open_worker&gt;, args=0x7fffffffc0b0)\n    at dl-error.c:178\n#14 0x00007ffff7ded31a in _dl_open (file=0x7fffffffc300 &quot;libnss_files.so.2&quot;, \n    mode=-2147483647, caller_dlopen=0x7ffff4fb1a1e, nsid=-2, argc=1, \n    argv=&lt;optimized out&gt;, env=0x7fffffffdd48) at dl-open.c:639\n#15 0x00007ffff4fdc602 in do_dlopen (ptr=0x7fffffffc2b0) at dl-libc.c:89\n#16 0x00007ffff7de9176 in _dl_catch_error (objname=0x7fffffffc2e0, \n    errstring=0x7fffffffc2d0, mallocedp=0x7fffffffc2ef, \n    operate=0x7ffff4fdc5c0 &lt;do_dlopen&gt;, args=0x7fffffffc2b0) at dl-error.c:178\n#17 0x00007ffff4fdc6c4 in dlerror_run (args=0x7fffffffc2b0, \n    operate=0x7ffff4fdc5c0 &lt;do_dlopen&gt;) at dl-libc.c:48\n#18 __GI___libc_dlopen_mode (name=&lt;optimized out&gt;, mode=&lt;optimized out&gt;)\n    at dl-libc.c:165\n#19 0x00007ffff4fb1a1e in nss_load_library (ni=&lt;optimized out&gt;)\n    at nsswitch.c:372\n#20 0x00007ffff4fb247d in __GI___nss_lookup_function (ni=0x8756f0, \n    fct_name=0x7ffff50272b9 &quot;gethostbyname4_r&quot;) at nsswitch.c:474\n#21 0x00007ffff4f77012 in gaih_inet (name=0x85f398 &quot;localhost&quot;, \n    service=&lt;optimized out&gt;, req=0x7fffffffcdd0, pai=&lt;optimized out&gt;, \n    naddrs=0x7fffffffcb80) at ../sysdeps/posix/getaddrinfo.c:834\n#22 0x00007ffff4f7a98e in __GI_getaddrinfo (name=0x85f398 &quot;localhost&quot;, \n    service=&lt;optimized out&gt;, hints=0x7fffffffcdd0, pai=0x7fffffffcce8)\n    at ../sysdeps/posix/getaddrinfo.c:2423\n#23 0x00007ffff740547c in boost::asio::detail::socket_ops::getaddrinfo (\n    host=0x85f398 &quot;localhost&quot;, service=0x7ee388 &quot;11345&quot;, hints=..., \n    result=0x7fffffffcce8, ec=...)\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:2702\n#24 0x00007ffff7413bc3 in boost::asio::detail::resolver_service&lt;boost::asio::ip::tcp&gt;::resolve (this=0x7d3778, query=..., ec=...)\n    at /usr/include/boost/asio/detail/resolver_service.hpp:60\n#25 0x00007ffff74101f3 in boost::asio::ip::resolver_service&lt;boost::asio::ip::tcp&gt;::resolve (this=0x7d3750, impl=..., query=..., ec=...)\n    at /usr/include/boost/asio/ip/resolver_service.hpp:108\n#26 0x00007ffff740b9b3 in boost::asio::ip::basic_resolver&lt;boost::asio::ip::tcp, boost::asio::ip::resolver_service&lt;boost::asio::ip::tcp&gt; &gt;::resolve (\n    this=0x7fffffffce60, q=...)\n    at /usr/include/boost/asio/ip/basic_resolver.hpp:101\n#27 0x00007ffff73fa2d8 in gazebo::transport::Connection::Connect (\n    this=0x81c2b0, _host=..., _port=11345)\n    at /home/nkoenig/work/gazebo/gazebo/transport/Connection.cc:126\n#28 0x00007ffff741e487 in gazebo::transport::ConnectionManager::Init (\n    this=0x6b7040, _masterHost=..., master_port=11345)\n    at /home/nkoenig/work/gazebo/gazebo/transport/ConnectionManager.cc:78\n#29 0x00007ffff74482b1 in gazebo::transport::init (_masterHost=..., \n    _masterPort=0)\n    at /home/nkoenig/work/gazebo/gazebo/transport/Transport.cc:73\n#30 0x0000000000493088 in gazebo::load (argc=1, argv=0x6e00b0)\n    at /home/nkoenig/work/gazebo/gazebo/gazebo.cc:68\n#31 0x0000000000469aa4 in gazebo::Server::LoadImpl (this=0x6f71e0, _elem=...)\n    at /home/nkoenig/work/gazebo/gazebo/Server.cc:284\n#32 0x00000000004694ae in gazebo::Server::LoadFile (this=0x6f71e0, \n    _filename=...) at /home/nkoenig/work/gazebo/gazebo/Server.cc:247\n#33 0x0000000000468a72 in gazebo::Server::ParseArgs (this=0x6f71e0, argc=1, \n    argv=0x7fffffffdd38) at /home/nkoenig/work/gazebo/gazebo/Server.cc:205\n#34 0x0000000000465610 in main (argc=1, argv=0x7fffffffdd38)\n    at /home/nkoenig/work/gazebo/gazebo/server_main.cc:40\n</pre></div>", "type": "rendered"}, "created_on": "2013-02-07T16:01:03.446654+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2013-02-07T16:01:38.841172+00:00", "type": "pullrequest_comment", "id": 109735}