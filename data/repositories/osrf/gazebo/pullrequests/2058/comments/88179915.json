{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2058/comments/88179915.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2058/_/diff#comment-88179915"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2058, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2058.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2058"}}, "title": "Added camera intrinsics (fx, fy, cx, cy, s)."}, "content": {"raw": "Here\u2019re some very minor coding style changes. Could you apply this patch?\n\n    diff -r abb20f3a0c28 gazebo/rendering/Camera.cc\n    --- a/gazebo/rendering/Camera.cc        Thu Jul 12 00:44:27 2018 +0100\n    +++ b/gazebo/rendering/Camera.cc        Tue Jan 15 17:06:04 2019 -0800\n    @@ -191,7 +191,7 @@\n         this->dataPtr->distortion->Load(this->sdf->GetElement(\"distortion\"));\n       }\n     \n    -  LoadCameraIntrinsics();\n    +  this->LoadCameraIntrinsics();\n     }\n     \n     //////////////////////////////////////////////////\n    @@ -203,7 +203,7 @@\n         if (sdfLens->HasElement(\"intrinsics\"))\n         {\n           sdf::ElementPtr sdfIntrinsics = sdfLens->GetElement(\"intrinsics\");\n    -      UpdateCameraIntrinsics(\n    +      this->UpdateCameraIntrinsics(\n               sdfIntrinsics->Get<double>(\"fx\"),\n               sdfIntrinsics->Get<double>(\"fy\"),\n               sdfIntrinsics->Get<double>(\"cx\"),\n    @@ -229,15 +229,17 @@\n         clipFar = clipElem->Get<double>(\"far\");\n       }\n     \n    -  this->cameraProjectiveMatrix = BuildProjectiveMatrix(\n    +  this->cameraProjectiveMatrix = this->BuildProjectiveMatrix(\n         this->imageWidth, this->imageHeight,\n         _cameraIntrinsicsFx, _cameraIntrinsicsFy,\n         _cameraIntrinsicsCx, _cameraIntrinsicsCy,\n         _cameraIntrinsicsS, clipNear, clipFar);\n     \n    -  if (this->camera != NULL)\n    +  if (this->camera != nullptr)\n    +  {\n         this->camera->setCustomProjectionMatrix(true,\n             Conversions::Convert(cameraProjectiveMatrix));\n    +  }\n     \n       this->cameraUsingIntrinsics = true;\n     }\n    @@ -305,9 +307,9 @@\n         const double _intrinsicsS,\n         const double _clipNear, const double _clipFar)\n     {\n    -  return BuildNDCMatrix(\n    +  return this->BuildNDCMatrix(\n                0, _imageWidth, 0, _imageHeight, _clipNear, _clipFar) *\n    -         BuildPerspectiveMatrix(\n    +         this->BuildPerspectiveMatrix(\n                _intrinsicsFx, _intrinsicsFy, _intrinsicsCx, _intrinsicsCy,\n                _intrinsicsS, _clipNear, _clipFar);\n     }", "markup": "markdown", "html": "<p>Here\u2019re some very minor coding style changes. Could you apply this patch?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r abb20f3a0c28 gazebo/rendering/Camera.cc</span>\n<span class=\"gd\">--- a/gazebo/rendering/Camera.cc        Thu Jul 12 00:44:27 2018 +0100</span>\n<span class=\"gi\">+++ b/gazebo/rendering/Camera.cc        Tue Jan 15 17:06:04 2019 -0800</span>\n<span class=\"gu\">@@ -191,7 +191,7 @@</span>\n     this-&gt;dataPtr-&gt;distortion-&gt;Load(this-&gt;sdf-&gt;GetElement(&quot;distortion&quot;));\n   }\n\n<span class=\"gd\">-  LoadCameraIntrinsics();</span>\n<span class=\"gi\">+  this-&gt;LoadCameraIntrinsics();</span>\n }\n\n //////////////////////////////////////////////////\n<span class=\"gu\">@@ -203,7 +203,7 @@</span>\n     if (sdfLens-&gt;HasElement(&quot;intrinsics&quot;))\n     {\n       sdf::ElementPtr sdfIntrinsics = sdfLens-&gt;GetElement(&quot;intrinsics&quot;);\n<span class=\"gd\">-      UpdateCameraIntrinsics(</span>\n<span class=\"gi\">+      this-&gt;UpdateCameraIntrinsics(</span>\n           sdfIntrinsics-&gt;Get&lt;double&gt;(&quot;fx&quot;),\n           sdfIntrinsics-&gt;Get&lt;double&gt;(&quot;fy&quot;),\n           sdfIntrinsics-&gt;Get&lt;double&gt;(&quot;cx&quot;),\n<span class=\"gu\">@@ -229,15 +229,17 @@</span>\n     clipFar = clipElem-&gt;Get&lt;double&gt;(&quot;far&quot;);\n   }\n\n<span class=\"gd\">-  this-&gt;cameraProjectiveMatrix = BuildProjectiveMatrix(</span>\n<span class=\"gi\">+  this-&gt;cameraProjectiveMatrix = this-&gt;BuildProjectiveMatrix(</span>\n     this-&gt;imageWidth, this-&gt;imageHeight,\n     _cameraIntrinsicsFx, _cameraIntrinsicsFy,\n     _cameraIntrinsicsCx, _cameraIntrinsicsCy,\n     _cameraIntrinsicsS, clipNear, clipFar);\n\n<span class=\"gd\">-  if (this-&gt;camera != NULL)</span>\n<span class=\"gi\">+  if (this-&gt;camera != nullptr)</span>\n<span class=\"gi\">+  {</span>\n     this-&gt;camera-&gt;setCustomProjectionMatrix(true,\n         Conversions::Convert(cameraProjectiveMatrix));\n<span class=\"gi\">+  }</span>\n\n   this-&gt;cameraUsingIntrinsics = true;\n }\n<span class=\"gu\">@@ -305,9 +307,9 @@</span>\n     const double _intrinsicsS,\n     const double _clipNear, const double _clipFar)\n {\n<span class=\"gd\">-  return BuildNDCMatrix(</span>\n<span class=\"gi\">+  return this-&gt;BuildNDCMatrix(</span>\n            0, _imageWidth, 0, _imageHeight, _clipNear, _clipFar) *\n<span class=\"gd\">-         BuildPerspectiveMatrix(</span>\n<span class=\"gi\">+         this-&gt;BuildPerspectiveMatrix(</span>\n            _intrinsicsFx, _intrinsicsFy, _intrinsicsCx, _intrinsicsCy,\n            _intrinsicsS, _clipNear, _clipFar);\n }\n</pre></div>", "type": "rendered"}, "created_on": "2019-01-16T01:07:09.775194+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2019-01-16T01:07:09.781972+00:00", "type": "pullrequest_comment", "id": 88179915}