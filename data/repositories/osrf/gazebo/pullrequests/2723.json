{"rendered": {"description": {"raw": "## Reproduce issue\r\n\r\n1. Open Gazebo recording a log `gazebo --verbose -r`\r\n2. Insert a double pendulum (to have movement)\r\n3. Insert a model which has a scaled mesh, such as the `table_marble`\r\n4. Close Gazebo\r\n5. Playback the log file with `gazebo --verbose -p ~/.gazebo/log/...`\r\n6. You'll see that the mesh is inserted with the wrong scale.\r\n\r\n## Solution\r\n\r\nThe solution to this problem was simply to change `UnscaledSDF` to `GetSDF` when getting the inserted model.\r\n\r\nBut that looks fishy, since it looks like the intention of the code was precisely to use unscaled models.\r\n\r\nSo I went back to the [pull request](#!/osrf/gazebo/pull-requests/2020/user-scaling-commands-are-properly-logged/diff#chg-gazebo/physics/WorldState.cc) where that line was changed, and it looks like the intention was to properly record scaling while logging and then properly play it back.\r\n\r\nI manually checked that even with this fix:\r\n\r\n* It's possible to scale shapes while recording and that is properly played back\r\n* Undo scaling works (that uses states)\r\n* The underlying issue of scaled meshes is fixed\r\n\r\nSo... It looks like it's safe to change that line...", "markup": "markdown", "html": "<h2 id=\"markdown-header-reproduce-issue\">Reproduce issue</h2>\n<ol>\n<li>Open Gazebo recording a log <code>gazebo --verbose -r</code></li>\n<li>Insert a double pendulum (to have movement)</li>\n<li>Insert a model which has a scaled mesh, such as the <code>table_marble</code></li>\n<li>Close Gazebo</li>\n<li>Playback the log file with <code>gazebo --verbose -p ~/.gazebo/log/...</code></li>\n<li>You'll see that the mesh is inserted with the wrong scale.</li>\n</ol>\n<h2 id=\"markdown-header-solution\">Solution</h2>\n<p>The solution to this problem was simply to change <code>UnscaledSDF</code> to <code>GetSDF</code> when getting the inserted model.</p>\n<p>But that looks fishy, since it looks like the intention of the code was precisely to use unscaled models.</p>\n<p>So I went back to the <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-requests/2020/user-scaling-commands-are-properly-logged/diff#chg-gazebo/physics/WorldState.cc\" rel=\"nofollow\">pull request</a> where that line was changed, and it looks like the intention was to properly record scaling while logging and then properly play it back.</p>\n<p>I manually checked that even with this fix:</p>\n<ul>\n<li>It's possible to scale shapes while recording and that is properly played back</li>\n<li>Undo scaling works (that uses states)</li>\n<li>The underlying issue of scaled meshes is fixed</li>\n</ul>\n<p>So... It looks like it's safe to change that line...</p>", "type": "rendered"}, "title": {"raw": "Fix inserted mesh scale during log playback", "markup": "markdown", "html": "<p>Fix inserted mesh scale during log playback</p>", "type": "rendered"}}, "type": "pullrequest", "description": "## Reproduce issue\r\n\r\n1. Open Gazebo recording a log `gazebo --verbose -r`\r\n2. Insert a double pendulum (to have movement)\r\n3. Insert a model which has a scaled mesh, such as the `table_marble`\r\n4. Close Gazebo\r\n5. Playback the log file with `gazebo --verbose -p ~/.gazebo/log/...`\r\n6. You'll see that the mesh is inserted with the wrong scale.\r\n\r\n## Solution\r\n\r\nThe solution to this problem was simply to change `UnscaledSDF` to `GetSDF` when getting the inserted model.\r\n\r\nBut that looks fishy, since it looks like the intention of the code was precisely to use unscaled models.\r\n\r\nSo I went back to the [pull request](#!/osrf/gazebo/pull-requests/2020/user-scaling-commands-are-properly-logged/diff#chg-gazebo/physics/WorldState.cc) where that line was changed, and it looks like the intention was to properly record scaling while logging and then properly play it back.\r\n\r\nI manually checked that even with this fix:\r\n\r\n* It's possible to scale shapes while recording and that is properly played back\r\n* Undo scaling works (that uses states)\r\n* The underlying issue of scaled meshes is fixed\r\n\r\nSo... It looks like it's safe to change that line...", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/2723/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diffstat/osrf/gazebo:6c3209d9404e%0D5c0ee95babe7?from_pullrequest_id=2723"}, "commits": {"href": "data/repositories/osrf/gazebo/pullrequests/2723/commits.json"}, "self": {"href": "data/repositories/osrf/gazebo/pullrequests/2723.json"}, "comments": {"href": "data/repositories/osrf/gazebo/pullrequests/2723/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/2723/merge"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2723"}, "activity": {"href": "data/repositories/osrf/gazebo/pullrequests/2723/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:6c3209d9404e%0D5c0ee95babe7?from_pullrequest_id=2723"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/2723/approve"}, "statuses": {"href": "data/repositories/osrf/gazebo/pullrequests/2723/statuses_page=1.json"}}, "title": "Fix inserted mesh scale during log playback", "close_source_branch": true, "reviewers": [], "id": 2723, "destination": {"commit": {"hash": "5c0ee95babe7", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/5c0ee95babe7.json"}, "html": {"href": "#!/osrf/gazebo/commits/5c0ee95babe7"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "created_on": "2017-06-01T01:07:37.474044+00:00", "summary": {"raw": "## Reproduce issue\r\n\r\n1. Open Gazebo recording a log `gazebo --verbose -r`\r\n2. Insert a double pendulum (to have movement)\r\n3. Insert a model which has a scaled mesh, such as the `table_marble`\r\n4. Close Gazebo\r\n5. Playback the log file with `gazebo --verbose -p ~/.gazebo/log/...`\r\n6. You'll see that the mesh is inserted with the wrong scale.\r\n\r\n## Solution\r\n\r\nThe solution to this problem was simply to change `UnscaledSDF` to `GetSDF` when getting the inserted model.\r\n\r\nBut that looks fishy, since it looks like the intention of the code was precisely to use unscaled models.\r\n\r\nSo I went back to the [pull request](#!/osrf/gazebo/pull-requests/2020/user-scaling-commands-are-properly-logged/diff#chg-gazebo/physics/WorldState.cc) where that line was changed, and it looks like the intention was to properly record scaling while logging and then properly play it back.\r\n\r\nI manually checked that even with this fix:\r\n\r\n* It's possible to scale shapes while recording and that is properly played back\r\n* Undo scaling works (that uses states)\r\n* The underlying issue of scaled meshes is fixed\r\n\r\nSo... It looks like it's safe to change that line...", "markup": "markdown", "html": "<h2 id=\"markdown-header-reproduce-issue\">Reproduce issue</h2>\n<ol>\n<li>Open Gazebo recording a log <code>gazebo --verbose -r</code></li>\n<li>Insert a double pendulum (to have movement)</li>\n<li>Insert a model which has a scaled mesh, such as the <code>table_marble</code></li>\n<li>Close Gazebo</li>\n<li>Playback the log file with <code>gazebo --verbose -p ~/.gazebo/log/...</code></li>\n<li>You'll see that the mesh is inserted with the wrong scale.</li>\n</ol>\n<h2 id=\"markdown-header-solution\">Solution</h2>\n<p>The solution to this problem was simply to change <code>UnscaledSDF</code> to <code>GetSDF</code> when getting the inserted model.</p>\n<p>But that looks fishy, since it looks like the intention of the code was precisely to use unscaled models.</p>\n<p>So I went back to the <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-requests/2020/user-scaling-commands-are-properly-logged/diff#chg-gazebo/physics/WorldState.cc\" rel=\"nofollow\">pull request</a> where that line was changed, and it looks like the intention was to properly record scaling while logging and then properly play it back.</p>\n<p>I manually checked that even with this fix:</p>\n<ul>\n<li>It's possible to scale shapes while recording and that is properly played back</li>\n<li>Undo scaling works (that uses states)</li>\n<li>The underlying issue of scaled meshes is fixed</li>\n</ul>\n<p>So... It looks like it's safe to change that line...</p>", "type": "rendered"}, "source": {"commit": {"hash": "31b10a7152dd", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/31b10a7152dd.json"}, "html": {"href": "#!/osrf/gazebo/commits/31b10a7152dd"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "log_playback_mesh_scale"}}, "comment_count": 13, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2017-06-02T19:06:10.323781+00:00", "type": "participant", "approved": false, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}, {"role": "PARTICIPANT", "participated_on": "2017-06-02T18:18:51.654161+00:00", "type": "participant", "approved": false, "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}}, {"role": "PARTICIPANT", "participated_on": "2017-06-05T21:59:22.246119+00:00", "type": "participant", "approved": true, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, {"role": "PARTICIPANT", "participated_on": "2017-06-06T01:42:11.391228+00:00", "type": "participant", "approved": true, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, {"role": "PARTICIPANT", "participated_on": "2017-11-14T17:05:02.344203+00:00", "type": "participant", "approved": false, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, {"role": "PARTICIPANT", "participated_on": "2017-11-14T14:26:48.978070+00:00", "type": "participant", "approved": false, "user": {"display_name": "Ji\u0159\u00ed Kerner", "uuid": "{e3011390-469b-4f6b-9336-c5e1f1bac93c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3011390-469b-4f6b-9336-c5e1f1bac93c%7D"}, "html": {"href": "https://bitbucket.org/%7Be3011390-469b-4f6b-9336-c5e1f1bac93c%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/5d0d66f1837c78f05698369afb5c2f43d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-2.png"}}, "nickname": "jiriker", "type": "user", "account_id": "557058:72be3796-b267-4f69-b6ba-449605b7a62f"}}], "reason": "", "updated_on": "2017-11-14T17:05:02.422585+00:00", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "merge_commit": {"hash": "6c3209d9404e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/6c3209d9404e.json"}, "html": {"href": "#!/osrf/gazebo/commits/6c3209d9404e"}}}, "closed_by": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}