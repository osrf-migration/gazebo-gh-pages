{"pagelen": 50, "values": [{"update": {"description": "In many of my physics tests, I like to check things after every timestep. With the world paused, I use loops like the following:\r\n~~~\r\nfor (lots of steps)\r\n{\r\n  world->Step(1);\r\n  // get physics properties and check their validity\r\n}\r\n~~~\r\nI added a test to `INTEGRATION_speed` that shows that this currently can't go faster than real-time. The problem was a 1 ms wait in the `World::Step(unsigned int)` function. I changed it to a 1 ns wait and now the test passes.\r\n\r\nI need this for my accuracy testing branch.", "title": "Speed up World::Step in loops", "destination": {"commit": {"hash": "f9f52167dfc6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f9f52167dfc6.json"}, "html": {"href": "#!/osrf/gazebo/commits/f9f52167dfc6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo_4.1"}}, "reason": "", "source": {"commit": {"hash": "37bb2e6f28d8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/37bb2e6f28d8.json"}, "html": {"href": "#!/osrf/gazebo/commits/37bb2e6f28d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "unthrottle_step_4.1"}}, "state": "MERGED", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2015-03-11T00:33:00.942739+00:00"}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"approval": {"date": "2015-03-11T00:11:32.382024+00:00", "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"approval": {"date": "2015-03-10T00:52:45.180094+00:00", "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "user": {"display_name": "Jackie K", "uuid": "{e3d60b62-b7c7-4863-b9b9-cdae9f123cec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D"}, "html": {"href": "https://bitbucket.org/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/ea011fa2919d4bd4568b32b440eda779d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-0.png"}}, "nickname": "jacquelinekay", "type": "user", "account_id": "557058:f56c822f-f75c-4665-80f9-6e7764893b9c"}}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5558427.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5558427"}}, "parent": {"id": 5557859, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5557859.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5557859"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "yes, thanks!", "markup": "markdown", "html": "<p>yes, thanks!</p>", "type": "rendered"}, "created_on": "2015-03-09T21:47:21.703672+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": "2015-03-09T21:47:21.714036+00:00", "type": "pullrequest_comment", "id": 5558427}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5557859.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5557859"}}, "parent": {"id": 5557758, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5557758.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5557758"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "@hsu does that address your concerns?", "markup": "markdown", "html": "<p>@hsu does that address your concerns?</p>", "type": "rendered"}, "created_on": "2015-03-09T21:15:28.607878+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-09T21:15:28.619758+00:00", "type": "pullrequest_comment", "id": 5557859}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5557758.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5557758"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "There's been lots of good discussion here. To summarize:\n\n* I'm going to keep the `NSleep(1)` call for 4.1\n* I'll look into using a [c++11 condition variable](http://www.cplusplus.com/reference/condition_variable/condition_variable/) to replace the polling loop in [World::Step(unsigned int)](#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-594) (issue #1502)", "markup": "markdown", "html": "<p>There's been lots of good discussion here. To summarize:</p>\n<ul>\n<li>I'm going to keep the <code>NSleep(1)</code> call for 4.1</li>\n<li>I'll look into using a <a data-is-external-link=\"true\" href=\"http://www.cplusplus.com/reference/condition_variable/condition_variable/\" rel=\"nofollow\">c++11 condition variable</a> to replace the polling loop in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-594\" rel=\"nofollow\">World::Step(unsigned int)</a> (issue <a href=\"#!/osrf/gazebo/issues/1502/use-condition-variable-instead-of-polling\" rel=\"nofollow\" title=\"Use condition variable instead of polling in World::Step(unsigned int)\" class=\"ap-connect-link\">#1502</a>)</li>\n</ul>", "type": "rendered"}, "created_on": "2015-03-09T21:09:07.111577+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-09T21:09:07.122445+00:00", "type": "pullrequest_comment", "id": 5557758}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531479.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531479"}}, "parent": {"id": 5531471, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531471.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531471"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "+1", "markup": "markdown", "html": "<p>+1</p>", "type": "rendered"}, "created_on": "2015-03-06T23:46:58.322372+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2015-03-06T23:46:58.328290+00:00", "type": "pullrequest_comment", "id": 5531479}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531471.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531471"}}, "parent": {"id": 5530988, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530988.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530988"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "What if I add a condition variable on default as discussed below and use `NSleep(1)` for now?", "markup": "markdown", "html": "<p>What if I add a condition variable on default as discussed below and use <code>NSleep(1)</code> for now?</p>", "type": "rendered"}, "created_on": "2015-03-06T23:46:18.906193+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T23:46:18.914894+00:00", "type": "pullrequest_comment", "id": 5531471}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531447.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531447"}}, "parent": {"id": 5531395, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531395.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531395"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Ok, if we want to add a condition variable to `World` then we can do that on default. For simplicity, I'd like to keep it as `NSleep(1)` for now on this branch.", "markup": "markdown", "html": "<p>Ok, if we want to add a condition variable to <code>World</code> then we can do that on default. For simplicity, I'd like to keep it as <code>NSleep(1)</code> for now on this branch.</p>", "type": "rendered"}, "created_on": "2015-03-06T23:44:45.650684+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:44:45.656387+00:00", "type": "pullrequest_comment", "id": 5531447}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531395.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531395"}}, "parent": {"id": 5531307, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531307.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531307"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Yes, that would be ideal.\n\nThis might work:\n\n```\n#!c++\n\n   while (true)\n   {\n     boost::recursive_mutex::scoped_lock lock(*this->worldUpdateMutex);\n     this->stepCondition.wait(lock);\n     if (this->stepInc == 0 || this->stop)\n       break;\n   }\n```\n", "markup": "markdown", "html": "<p>Yes, that would be ideal.</p>\n<p>This might work:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>   <span class=\"k\">while</span> <span class=\"p\">(</span><span class=\"nb\">true</span><span class=\"p\">)</span>\n   <span class=\"p\">{</span>\n     <span class=\"n\">boost</span><span class=\"o\">::</span><span class=\"n\">recursive_mutex</span><span class=\"o\">::</span><span class=\"n\">scoped_lock</span> <span class=\"n\">lock</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">worldUpdateMutex</span><span class=\"p\">);</span>\n     <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">stepCondition</span><span class=\"p\">.</span><span class=\"n\">wait</span><span class=\"p\">(</span><span class=\"n\">lock</span><span class=\"p\">);</span>\n     <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">stepInc</span> <span class=\"o\">==</span> <span class=\"mi\">0</span> <span class=\"o\">||</span> <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">stop</span><span class=\"p\">)</span>\n       <span class=\"k\">break</span><span class=\"p\">;</span>\n   <span class=\"p\">}</span>\n</pre></div>", "type": "rendered"}, "created_on": "2015-03-06T23:38:51.477745+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-03-06T23:38:51.486386+00:00", "type": "pullrequest_comment", "id": 5531395}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531307.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531307"}}, "parent": {"id": 5531266, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531266.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531266"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Yield would still be used for polling right? Wouldn't a condition variable be better for not having to poll?", "markup": "markdown", "html": "<p>Yield would still be used for polling right? Wouldn't a condition variable be better for not having to poll?</p>", "type": "rendered"}, "created_on": "2015-03-06T23:30:44.990196+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:30:44.997286+00:00", "type": "pullrequest_comment", "id": 5531307}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531281.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531281"}}, "parent": {"id": 5530988, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530988.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530988"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "`worldUpdateMutex` is private and doesn't have a public accessor. So the only things that can access it are inside the `World` class:\n\n* [World::Step()](#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-553) locks the mutex to protect against calls to `World::Update`, where the actual physics updates are called. The duration of this mutex lock depends on the physics engine and the complexity of the world.\n* [World::Step(unsigned int)](#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-594) (the function I'm modifying in this pull request) locks the mutex once in order to set `this->stepInc` and then in the polling loop it locks it in order to set a flag if an `if` statement is satisfied. The actual duration of the lock is very short, though it can be called repeatedly.\n* `World::SetPaused`\n* `World::Reset`\n* `World::OnControl`\n\nI'll add more detail if necessary...", "markup": "markdown", "html": "<p><code>worldUpdateMutex</code> is private and doesn't have a public accessor. So the only things that can access it are inside the <code>World</code> class:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-553\" rel=\"nofollow\">World::Step()</a> locks the mutex to protect against calls to <code>World::Update</code>, where the actual physics updates are called. The duration of this mutex lock depends on the physics engine and the complexity of the world.</li>\n<li><a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-594\" rel=\"nofollow\">World::Step(unsigned int)</a> (the function I'm modifying in this pull request) locks the mutex once in order to set <code>this-&gt;stepInc</code> and then in the polling loop it locks it in order to set a flag if an <code>if</code> statement is satisfied. The actual duration of the lock is very short, though it can be called repeatedly.</li>\n<li><code>World::SetPaused</code></li>\n<li><code>World::Reset</code></li>\n<li><code>World::OnControl</code></li>\n</ul>\n<p>I'll add more detail if necessary...</p>", "type": "rendered"}, "created_on": "2015-03-06T23:28:58.090704+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T23:28:58.098588+00:00", "type": "pullrequest_comment", "id": 5531281}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531266.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531266"}}, "parent": {"id": 5531141, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531141.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531141"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "More food for thought: http://en.cppreference.com/w/cpp/thread/yield\nDon't need to use it. I just find it interesting.", "markup": "markdown", "html": "<p>More food for thought: <a href=\"http://en.cppreference.com/w/cpp/thread/yield\" rel=\"nofollow\" class=\"ap-connect-link\">http://en.cppreference.com/w/cpp/thread/yield</a>\nDon't need to use it. I just find it interesting.</p>", "type": "rendered"}, "created_on": "2015-03-06T23:27:43.748811+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-03-06T23:27:43.758882+00:00", "type": "pullrequest_comment", "id": 5531266}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531240.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531240"}}, "parent": {"id": 5530990, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530990.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530990"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "yes! that's what I am trying to say with my test suggestion :)", "markup": "markdown", "html": "<p>yes! that's what I am trying to say with my test suggestion :)</p>", "type": "rendered"}, "created_on": "2015-03-06T23:26:03.375942+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "inline": {}, "updated_on": "2015-03-06T23:26:03.382477+00:00", "type": "pullrequest_comment", "id": 5531240}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531238.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531238"}}, "parent": {"id": 5531230, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531230.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531230"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "No problem. I will keep it at `NSleep(1)`", "markup": "markdown", "html": "<p>No problem. I will keep it at <code>NSleep(1)</code></p>", "type": "rendered"}, "created_on": "2015-03-06T23:25:51.934768+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:25:51.941183+00:00", "type": "pullrequest_comment", "id": 5531238}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531230.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531230"}}, "parent": {"id": 5531141, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531141.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531141"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Good to know. Thanks for looking into it.", "markup": "markdown", "html": "<p>Good to know. Thanks for looking into it.</p>", "type": "rendered"}, "created_on": "2015-03-06T23:24:46.244377+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-03-06T23:24:46.249632+00:00", "type": "pullrequest_comment", "id": 5531230}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531141.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531141"}}, "parent": {"id": 5531112, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531112.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531112"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "With `NSleep(1)` on my desktop, ODE, bullet and DART have real time factors greater than 10 in the `UnthrottledStep` test, Simbody is around 6.5.\n\nWith `NSleep(0)` on my desktop, they are all around 3.25", "markup": "markdown", "html": "<p>With <code>NSleep(1)</code> on my desktop, ODE, bullet and DART have real time factors greater than 10 in the <code>UnthrottledStep</code> test, Simbody is around 6.5.</p>\n<p>With <code>NSleep(0)</code> on my desktop, they are all around 3.25</p>", "type": "rendered"}, "created_on": "2015-03-06T23:17:08.445138+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:17:08.453498+00:00", "type": "pullrequest_comment", "id": 5531141}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531112.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531112"}}, "parent": {"id": 5530990, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530990.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530990"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "I haven't committed this yet. Testing on my machine shows that the following owns my console, and the resulting real time factor is substantially lower (I'll post numbers in a reply to this comment).\n~~~\n[Wrn] [Time.cc:205] Sleep time is larger than clock resolution, skipping sleep\n~~~", "markup": "markdown", "html": "<p>I haven't committed this yet. Testing on my machine shows that the following owns my console, and the resulting real time factor is substantially lower (I'll post numbers in a reply to this comment).</p>\n<div class=\"codehilite\"><pre><span></span>[Wrn] [Time.cc:205] Sleep time is larger than clock resolution, skipping sleep\n</pre></div>", "type": "rendered"}, "created_on": "2015-03-06T23:14:25.715687+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:14:25.722192+00:00", "type": "pullrequest_comment", "id": 5531112}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531020.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531020"}}, "parent": {"id": 5530990, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530990.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530990"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Sure, and I'll schedule another jenkins build to confirm.", "markup": "markdown", "html": "<p>Sure, and I'll schedule another jenkins build to confirm.</p>", "type": "rendered"}, "created_on": "2015-03-06T23:05:46.751328+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2015-03-06T23:05:46.759886+00:00", "type": "pullrequest_comment", "id": 5531020}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5531007.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5531007"}}, "parent": {"id": 5530686, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530686.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530686"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "backported a fix for PhysicsEngines/ContactSensor.MultipleSensors from pull request #1450 in 37bb2e6f28d8", "markup": "markdown", "html": "<p>backported a fix for PhysicsEngines/ContactSensor.MultipleSensors from <a href=\"#!/osrf/gazebo/pull-requests/1450/test-for-602-segfault-after-unsubscribe\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #1450</a> in <a href=\"#!/osrf/gazebo/commits/37bb2e6f28d8\" rel=\"nofollow\" class=\"ap-connect-link\">37bb2e6f28d8</a></p>", "type": "rendered"}, "created_on": "2015-03-06T23:05:03.778900+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T23:05:03.790272+00:00", "type": "pullrequest_comment", "id": 5531007}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"update": {"description": "In many of my physics tests, I like to check things after every timestep. With the world paused, I use loops like the following:\r\n~~~\r\nfor (lots of steps)\r\n{\r\n  world->Step(1);\r\n  // get physics properties and check their validity\r\n}\r\n~~~\r\nI added a test to `INTEGRATION_speed` that shows that this currently can't go faster than real-time. The problem was a 1 ms wait in the `World::Step(unsigned int)` function. I changed it to a 1 ns wait and now the test passes.\r\n\r\nI need this for my accuracy testing branch.", "title": "Speed up World::Step in loops", "destination": {"commit": {"hash": "b9e206b52c04", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b9e206b52c04.json"}, "html": {"href": "#!/osrf/gazebo/commits/b9e206b52c04"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo_4.1"}}, "reason": "", "source": {"commit": {"hash": "37bb2e6f28d8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/37bb2e6f28d8.json"}, "html": {"href": "#!/osrf/gazebo/commits/37bb2e6f28d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "unthrottle_step_4.1"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2015-03-06T23:04:16.516575+00:00"}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530990.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530990"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "This is essentially tells the kernel to break execution of this thread, and reschedule almost immediately. \n\nCan you try using `common::Time::NSleep(0)`? This should have the same effect, but is a bit more clear about its purpose. ", "markup": "markdown", "html": "<p>This is essentially tells the kernel to break execution of this thread, and reschedule almost immediately. </p>\n<p>Can you try using <code>common::Time::NSleep(0)</code>? This should have the same effect, but is a bit more clear about its purpose. </p>", "type": "rendered"}, "created_on": "2015-03-06T23:02:57.186306+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-03-06T23:02:57.194109+00:00", "type": "pullrequest_comment", "id": 5530990}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530988.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530988"}}, "parent": {"id": 5530708, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530708.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530708"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "No. As @jacquelinekay mentioned, if your `World::Step` loop grabs `worldUpdateMutex` on every update, and there's a second separate thread that's running internal to gazebo also needing `worldUpdateMutex`, the test is to make sure the second thread can also access `worldUpdateMutex` from time to time.", "markup": "markdown", "html": "<p>No. As @jacquelinekay mentioned, if your <code>World::Step</code> loop grabs <code>worldUpdateMutex</code> on every update, and there's a second separate thread that's running internal to gazebo also needing <code>worldUpdateMutex</code>, the test is to make sure the second thread can also access <code>worldUpdateMutex</code> from time to time.</p>", "type": "rendered"}, "created_on": "2015-03-06T23:02:52.778934+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": "2015-03-06T23:02:52.793557+00:00", "type": "pullrequest_comment", "id": 5530988}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530873.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530873"}}, "parent": {"id": 5530814, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530814.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530814"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "5058de755285", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/5058de755285\" rel=\"nofollow\" class=\"ap-connect-link\">5058de755285</a></p>", "type": "rendered"}, "created_on": "2015-03-06T22:54:28.810452+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:54:28.817372+00:00", "type": "pullrequest_comment", "id": 5530873}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"update": {"description": "In many of my physics tests, I like to check things after every timestep. With the world paused, I use loops like the following:\r\n~~~\r\nfor (lots of steps)\r\n{\r\n  world->Step(1);\r\n  // get physics properties and check their validity\r\n}\r\n~~~\r\nI added a test to `INTEGRATION_speed` that shows that this currently can't go faster than real-time. The problem was a 1 ms wait in the `World::Step(unsigned int)` function. I changed it to a 1 ns wait and now the test passes.\r\n\r\nI need this for my accuracy testing branch.", "title": "Speed up World::Step in loops", "destination": {"commit": {"hash": "b9e206b52c04", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b9e206b52c04.json"}, "html": {"href": "#!/osrf/gazebo/commits/b9e206b52c04"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo_4.1"}}, "reason": "", "source": {"commit": {"hash": "5058de755285", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/5058de755285.json"}, "html": {"href": "#!/osrf/gazebo/commits/5058de755285"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "unthrottle_step_4.1"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2015-03-06T22:54:19.724267+00:00"}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530814.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530814"}}, "parent": {"id": 5530686, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530686.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530686"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "The msgs and gzSDF tests are failing. I'll backport fixes from pull request #1484?", "markup": "markdown", "html": "<p>The msgs and gzSDF tests are failing. I'll backport fixes from <a href=\"#!/osrf/gazebo/pull-requests/1484/gazebo5-allow-sdformat3-and-fix-tests\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #1484</a>?</p>", "type": "rendered"}, "created_on": "2015-03-06T22:49:17.237449+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:49:17.246814+00:00", "type": "pullrequest_comment", "id": 5530814}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530708.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530708"}}, "parent": {"id": 5530663, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530663.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530663"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "do you mean calling `World::Step(unsigned int)` from multiple threads?", "markup": "markdown", "html": "<p>do you mean calling <code>World::Step(unsigned int)</code> from multiple threads?</p>", "type": "rendered"}, "created_on": "2015-03-06T22:41:49.465278+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:41:49.473705+00:00", "type": "pullrequest_comment", "id": 5530708}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530704.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530704"}}, "parent": {"id": 5530695, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530695.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530695"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Probably `worldUpdateMutex`", "markup": "markdown", "html": "<p>Probably <code>worldUpdateMutex</code></p>", "type": "rendered"}, "created_on": "2015-03-06T22:41:40.011938+00:00", "user": {"display_name": "Jackie K", "uuid": "{e3d60b62-b7c7-4863-b9b9-cdae9f123cec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D"}, "html": {"href": "https://bitbucket.org/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/ea011fa2919d4bd4568b32b440eda779d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-0.png"}}, "nickname": "jacquelinekay", "type": "user", "account_id": "557058:f56c822f-f75c-4665-80f9-6e7764893b9c"}, "updated_on": "2015-03-06T22:41:40.017881+00:00", "type": "pullrequest_comment", "id": 5530704}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530695.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530695"}}, "parent": {"id": 5530663, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530663.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530663"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "which mutex?", "markup": "markdown", "html": "<p>which mutex?</p>", "type": "rendered"}, "created_on": "2015-03-06T22:41:03.624576+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:41:03.633996+00:00", "type": "pullrequest_comment", "id": 5530695}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530693.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530693"}}, "parent": {"id": 5530686, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530686.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530686"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "also, the test will fail in 0ceb699 (before the fix was applied)", "markup": "markdown", "html": "<p>also, the test will fail in <a href=\"#!/osrf/gazebo/commits/0ceb699\" rel=\"nofollow\" class=\"ap-connect-link\">0ceb699</a> (before the fix was applied)</p>", "type": "rendered"}, "created_on": "2015-03-06T22:40:48.643902+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:40:48.651888+00:00", "type": "pullrequest_comment", "id": 5530693}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530686.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530686"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "test passes in:\n\n* [jenkins no gpu job](http://build.osrfoundation.org/view/gazebo/job/gazebo-any-devel-trusty-amd64-no-gpu/4/)\n* [jenkins trusty nvidia](http://build.osrfoundation.org/view/gazebo/job/gazebo-any-devel-trusty-amd64-gpu-nvidia/583/)\n* [jenkins homebrew](http://build.osrfoundation.org/job/gazebo-any-devel-homebrew-amd64/507/)", "markup": "markdown", "html": "<p>test passes in:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/view/gazebo/job/gazebo-any-devel-trusty-amd64-no-gpu/4/\" rel=\"nofollow\">jenkins no gpu job</a></li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/view/gazebo/job/gazebo-any-devel-trusty-amd64-gpu-nvidia/583/\" rel=\"nofollow\">jenkins trusty nvidia</a></li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-devel-homebrew-amd64/507/\" rel=\"nofollow\">jenkins homebrew</a></li>\n</ul>", "type": "rendered"}, "created_on": "2015-03-06T22:40:16.382292+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:40:16.389921+00:00", "type": "pullrequest_comment", "id": 5530686}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530663.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530663"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "One thing to test is to have two threads sharing a mutex, and see if with 1ns sleep allows both threads to access the mutex.", "markup": "markdown", "html": "<p>One thing to test is to have two threads sharing a mutex, and see if with 1ns sleep allows both threads to access the mutex.</p>", "type": "rendered"}, "created_on": "2015-03-06T22:38:26.471246+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": "2015-03-06T22:38:26.476791+00:00", "type": "pullrequest_comment", "id": 5530663}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530655.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530655"}}, "parent": {"id": 5530363, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530363.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530363"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "It's my understanding that the sleep time in `World::Step(unsigned int)` is not used for controlling the rate of physics updates. Physics updates happen in a separate thread. Some user code (usually a gtest instance) can call `Step(unsigned int)` from its thread, which increases `World::stepInc` and then polls the condition `this->stepInc == 0 || this->stop` inside a while loop. The actual physics update happen in another thread that decrements `this->stepInc` as steps are taken. The other thread also controls the real time update rate (see [World::Step()](#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-553) with no arguments).", "markup": "markdown", "html": "<p>It's my understanding that the sleep time in <code>World::Step(unsigned int)</code> is not used for controlling the rate of physics updates. Physics updates happen in a separate thread. Some user code (usually a gtest instance) can call <code>Step(unsigned int)</code> from its thread, which increases <code>World::stepInc</code> and then polls the condition <code>this-&gt;stepInc == 0 || this-&gt;stop</code> inside a while loop. The actual physics update happen in another thread that decrements <code>this-&gt;stepInc</code> as steps are taken. The other thread also controls the real time update rate (see <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/571432555923ed898da6726c9a419c82b2c2deeb/gazebo/physics/World.cc#cl-553\" rel=\"nofollow\">World::Step()</a> with no arguments).</p>", "type": "rendered"}, "created_on": "2015-03-06T22:37:14.015096+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-03-06T22:37:14.021915+00:00", "type": "pullrequest_comment", "id": 5530655}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530621.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530621"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "This sleep is related to wait  the mutex operations, it should not affect the other tests. I would approve this. ", "markup": "markdown", "html": "<p>This sleep is related to wait  the mutex operations, it should not affect the other tests. I would approve this. </p>", "type": "rendered"}, "created_on": "2015-03-06T22:34:50.784898+00:00", "user": {"display_name": "Ying Lu", "uuid": "{11ec131e-4af6-4228-beaf-167b1c8d1c2c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D"}, "html": {"href": "https://bitbucket.org/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:659bfe31-d941-44f5-aa6d-00058b070ea8/c88d5925-8a09-40c7-8684-c02aeafe0f59/128"}}, "nickname": "rosebudflyaway", "type": "user", "account_id": "557058:659bfe31-d941-44f5-aa6d-00058b070ea8"}, "updated_on": "2015-03-06T22:34:50.837790+00:00", "type": "pullrequest_comment", "id": 5530621}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530466.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530466"}}, "parent": {"id": 5530363, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530363.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530363"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "I think real time factor is defined as the ratio of simulation time versus clock time, say we set the simulation time step dt = 0.001 seconds, then we run for 1000 time steps, but due to our collision detection, or solver computation time, then the wall clock time for simulating 1000 time steps is 1.2 second, the real time factor would be 0.001*1000/1.2, which is slower than real time. Correct me if anything not accurate @scpeters ", "markup": "markdown", "html": "<p>I think real time factor is defined as the ratio of simulation time versus clock time, say we set the simulation time step dt = 0.001 seconds, then we run for 1000 time steps, but due to our collision detection, or solver computation time, then the wall clock time for simulating 1000 time steps is 1.2 second, the real time factor would be 0.001*1000/1.2, which is slower than real time. Correct me if anything not accurate @scpeters </p>", "type": "rendered"}, "created_on": "2015-03-06T22:23:00.735616+00:00", "user": {"display_name": "Ying Lu", "uuid": "{11ec131e-4af6-4228-beaf-167b1c8d1c2c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D"}, "html": {"href": "https://bitbucket.org/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:659bfe31-d941-44f5-aa6d-00058b070ea8/c88d5925-8a09-40c7-8684-c02aeafe0f59/128"}}, "nickname": "rosebudflyaway", "type": "user", "account_id": "557058:659bfe31-d941-44f5-aa6d-00058b070ea8"}, "updated_on": "2015-03-06T22:23:01.051718+00:00", "type": "pullrequest_comment", "id": 5530466}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492/comments/5530363.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492/_/diff#comment-5530363"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}, "content": {"raw": "Is there a way of deriving the sleep time in Step from the desired real time factor? I don't know how real time factor is calculated/enforced in physics, can you enlighten me?", "markup": "markdown", "html": "<p>Is there a way of deriving the sleep time in Step from the desired real time factor? I don't know how real time factor is calculated/enforced in physics, can you enlighten me?</p>", "type": "rendered"}, "created_on": "2015-03-06T22:15:54.334246+00:00", "user": {"display_name": "Jackie K", "uuid": "{e3d60b62-b7c7-4863-b9b9-cdae9f123cec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D"}, "html": {"href": "https://bitbucket.org/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/ea011fa2919d4bd4568b32b440eda779d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-0.png"}}, "nickname": "jacquelinekay", "type": "user", "account_id": "557058:f56c822f-f75c-4665-80f9-6e7764893b9c"}, "updated_on": "2015-03-06T22:15:54.341432+00:00", "type": "pullrequest_comment", "id": 5530363}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"update": {"description": "In many of my physics tests, I like to check things after every timestep. With the world paused, I use loops like the following:\r\n~~~\r\nfor (lots of steps)\r\n{\r\n  world->Step(1);\r\n  // get physics properties and check their validity\r\n}\r\n~~~\r\nI added a test to `INTEGRATION_speed` that shows that this currently can't go faster than real-time. The problem was a 1 ms wait in the `World::Step(unsigned int)` function. I changed it to a 1 ns wait and now the test passes.\r\n\r\nI need this for my accuracy testing branch.", "title": "Speed up World::Step in loops", "destination": {"commit": {"hash": "b9e206b52c04", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b9e206b52c04.json"}, "html": {"href": "#!/osrf/gazebo/commits/b9e206b52c04"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo_4.1"}}, "reason": "", "source": {"commit": {"hash": "571432555923", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/571432555923.json"}, "html": {"href": "#!/osrf/gazebo/commits/571432555923"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "unthrottle_step_4.1"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2015-03-06T18:57:07.286896+00:00"}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}, {"update": {"description": "In many of my physics tests, I like to check things after every timestep. With the world paused, I use loops like the following:\r\n~~~\r\nfor (lots of steps)\r\n{\r\n  world->Step(1);\r\n  // get physics properties and check their validity\r\n}\r\n~~~\r\nI added a test to `INTEGRATION_speed` that shows that this currently can't go faster than real-time. The problem was a 1 ms wait in the `World::Step(unsigned int)` function. I changed it to a 1 ns wait and now the test passes.\r\n\r\nI need this for my accuracy testing branch.", "title": "Speed up World::Step in loops", "destination": {"commit": {"hash": "b9e206b52c04", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b9e206b52c04.json"}, "html": {"href": "#!/osrf/gazebo/commits/b9e206b52c04"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo_4.1"}}, "reason": "", "source": {"commit": {"hash": "571432555923", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/571432555923.json"}, "html": {"href": "#!/osrf/gazebo/commits/571432555923"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "unthrottle_step_4.1"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2015-03-06T18:57:07.257076+00:00"}, "pull_request": {"type": "pullrequest", "id": 1492, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1492.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1492"}}, "title": "Speed up World::Step in loops"}}]}