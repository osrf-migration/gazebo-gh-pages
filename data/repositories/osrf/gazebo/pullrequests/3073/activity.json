{"pagelen": 50, "values": [{"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "2ae2a4a8dbe9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/2ae2a4a8dbe9.json"}, "html": {"href": "#!/osrf/gazebo/commits/2ae2a4a8dbe9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "MERGED", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "date": "2019-09-05T00:38:53.659867+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"approval": {"date": "2019-09-05T00:38:22.977937+00:00", "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115672045.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115672045"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "jenkins: looks good, no related test failures\n\n[xenial](https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-ci-pr_any-xenial-amd64-gpu-nvidia/866/)\n\n[homebrew](https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1746/)", "markup": "markdown", "html": "<p>jenkins: looks good, no related test failures</p>\n<p><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-ci-pr_any-xenial-amd64-gpu-nvidia/866/\" rel=\"nofollow\">xenial</a></p>\n<p><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1746/\" rel=\"nofollow\">homebrew</a></p>", "type": "rendered"}, "created_on": "2019-09-04T22:55:56.044689+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2019-09-04T22:55:56.051529+00:00", "type": "pullrequest_comment", "id": 115672045}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115668685.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115668685"}}, "parent": {"id": 115637963, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115637963.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115637963"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "good call, added in 2ae2a4a8dbe9", "markup": "markdown", "html": "<p>good call, added in <a href=\"#!/osrf/gazebo/commits/2ae2a4a8dbe9\" rel=\"nofollow\" class=\"ap-connect-link\">2ae2a4a8dbe9</a></p>", "type": "rendered"}, "created_on": "2019-09-04T22:07:02.080833+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-09-04T22:07:02.090908+00:00", "type": "pullrequest_comment", "id": 115668685}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "2ae2a4a8dbe9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/2ae2a4a8dbe9.json"}, "html": {"href": "#!/osrf/gazebo/commits/2ae2a4a8dbe9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-04T22:06:20.034730+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115658429.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115658429"}}, "parent": {"id": 115638528, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115638528.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115638528"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "the [report](https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-abichecker-any_to_any-xenial-amd64/848/API_5fABI_20report/) shows a couple of low severity warnings related to this but it's still 100% compatible so should be ok", "markup": "markdown", "html": "<p>the <a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-abichecker-any_to_any-xenial-amd64/848/API_5fABI_20report/\" rel=\"nofollow\">report</a> shows a couple of low severity warnings related to this but it's still 100% compatible so should be ok</p>", "type": "rendered"}, "created_on": "2019-09-04T20:24:31.347174+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-09-04T20:24:31.357622+00:00", "type": "pullrequest_comment", "id": 115658429}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "8f0cfe5082ff", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/8f0cfe5082ff.json"}, "html": {"href": "#!/osrf/gazebo/commits/8f0cfe5082ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-04T19:44:17.311669+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115653971.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115653971"}}, "parent": {"id": 115638612, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115638612.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115638612"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "8f0cfe5082ff", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/8f0cfe5082ff\" rel=\"nofollow\" class=\"ap-connect-link\">8f0cfe5082ff</a></p>", "type": "rendered"}, "created_on": "2019-09-04T19:44:01.962855+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-09-04T19:44:01.972493+00:00", "type": "pullrequest_comment", "id": 115653971}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115638528.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115638528"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "looks like these headers are installed. I queued an [ABI checker build](https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-abichecker-any_to_any-xenial-amd64) to see if these virtual functions are ABI compatible", "markup": "markdown", "html": "<p>looks like these headers are installed. I queued an <a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-abichecker-any_to_any-xenial-amd64\" rel=\"nofollow\">ABI checker build</a> to see if these virtual functions are ABI compatible</p>", "type": "rendered"}, "created_on": "2019-09-04T17:31:24.040125+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-09-04T19:01:17.770875+00:00", "type": "pullrequest_comment", "id": 115638528}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115638612.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115638612"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "use `std::bind`?", "markup": "markdown", "html": "<p>use <code>std::bind</code>?</p>", "type": "rendered"}, "created_on": "2019-09-04T17:32:02.863020+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-09-04T17:32:02.873421+00:00", "type": "pullrequest_comment", "id": 115638612}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/115637963.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-115637963"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "could you add some documentation on the plugin? I think what you wrote in the description of the PR is quite helpful", "markup": "markdown", "html": "<p>could you add some documentation on the plugin? I think what you wrote in the description of the PR is quite helpful</p>", "type": "rendered"}, "created_on": "2019-09-04T17:27:09.829945+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-09-04T17:27:09.879208+00:00", "type": "pullrequest_comment", "id": 115637963}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "185f807a3c7c", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/185f807a3c7c.json"}, "html": {"href": "#!/osrf/gazebo/commits/185f807a3c7c"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-03T23:21:26.566926+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "185f807a3c7c", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/185f807a3c7c.json"}, "html": {"href": "#!/osrf/gazebo/commits/185f807a3c7c"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-03T23:21:24.195984+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "d27c1d94657e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d27c1d94657e.json"}, "html": {"href": "#!/osrf/gazebo/commits/d27c1d94657e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-03T23:19:47.495536+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "d27c1d94657e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d27c1d94657e.json"}, "html": {"href": "#!/osrf/gazebo/commits/d27c1d94657e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-03T23:19:45.902843+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "f08b775c293e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f08b775c293e.json"}, "html": {"href": "#!/osrf/gazebo/commits/f08b775c293e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "6f31373bb8cf", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/6f31373bb8cf.json"}, "html": {"href": "#!/osrf/gazebo/commits/6f31373bb8cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-09-03T23:17:33.132991+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96987524.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96987524"}}, "parent": {"id": 96848837, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96848837.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96848837"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "thanks, I hadn't thought about the others: 170bdbe9c57e", "markup": "markdown", "html": "<p>thanks, I hadn't thought about the others: <a href=\"#!/osrf/gazebo/commits/170bdbe9c57e\" rel=\"nofollow\" class=\"ap-connect-link\">170bdbe9c57e</a></p>", "type": "rendered"}, "created_on": "2019-03-30T00:43:25.858864+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-03-30T00:43:25.866512+00:00", "type": "pullrequest_comment", "id": 96987524}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "170bdbe9c57e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/170bdbe9c57e.json"}, "html": {"href": "#!/osrf/gazebo/commits/170bdbe9c57e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-30T00:42:56.674751+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"approval": {"date": "2019-03-29T01:42:15.989325+00:00", "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96848837.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96848837"}}, "parent": {"id": 96845679, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96845679.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96845679"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "Recommend throwing for the other errors in Load, but in case you disagree I\u2019m fine with the PR as is.", "markup": "markdown", "html": "<p>Recommend throwing for the other errors in Load, but in case you disagree I\u2019m fine with the PR as is.</p>", "type": "rendered"}, "created_on": "2019-03-29T01:42:13.583279+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-29T01:42:13.591072+00:00", "type": "pullrequest_comment", "id": 96848837}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "9af2ceec7496", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/9af2ceec7496.json"}, "html": {"href": "#!/osrf/gazebo/commits/9af2ceec7496"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-29T00:28:39.586272+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96845679.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96845679"}}, "parent": {"id": 96842117, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96842117.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96842117"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "9af2ceec7496", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/9af2ceec7496\" rel=\"nofollow\" class=\"ap-connect-link\">9af2ceec7496</a></p>", "type": "rendered"}, "created_on": "2019-03-29T00:28:30.035784+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-03-29T00:28:30.045975+00:00", "type": "pullrequest_comment", "id": 96845679}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96842287.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96842287"}}, "parent": {"id": 96841365, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96841365.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96841365"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "Yeah, that makes sense.", "markup": "markdown", "html": "<p>Yeah, that makes sense.</p>", "type": "rendered"}, "created_on": "2019-03-28T23:24:19.088054+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T23:24:19.099563+00:00", "type": "pullrequest_comment", "id": 96842287}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96842117.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96842117"}}, "parent": {"id": 96834856, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96834856.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96834856"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "ok, I'm waiting for it to compile and then I will test the following:\n\n~~~\ndiff -r 4c13949814db plugins/VariableGearboxPlugin.cc\n--- a/plugins/VariableGearboxPlugin.cc\tThu Mar 28 16:14:22 2019 -0700\n+++ b/plugins/VariableGearboxPlugin.cc\tThu Mar 28 16:21:21 2019 -0700\n@@ -19,6 +19,7 @@\n #include <functional>\n #include <gazebo/common/Assert.hh>\n #include <gazebo/common/Events.hh>\n+#include <gazebo/common/Exception.hh>\n #include <gazebo/physics/Joint.hh>\n #include <gazebo/physics/Link.hh>\n #include \"VariableGearboxPlugin.hh\"\n@@ -264,9 +265,7 @@\n   }\n   else\n   {\n-    gzerr << \"No x_y_dydx elements detected\"\n-          << std::endl;\n-    return;\n+    gzthrow(\"No x_y_dydx elements detected\");\n   }\n \n   this->dataPtr->updateConnection = event::Events::ConnectWorldUpdateBegin(\n~~~", "markup": "markdown", "html": "<p>ok, I'm waiting for it to compile and then I will test the following:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 4c13949814db plugins/VariableGearboxPlugin.cc</span>\n<span class=\"gd\">--- a/plugins/VariableGearboxPlugin.cc  Thu Mar 28 16:14:22 2019 -0700</span>\n<span class=\"gi\">+++ b/plugins/VariableGearboxPlugin.cc  Thu Mar 28 16:21:21 2019 -0700</span>\n<span class=\"gu\">@@ -19,6 +19,7 @@</span>\n #include &lt;functional&gt;\n #include &lt;gazebo/common/Assert.hh&gt;\n #include &lt;gazebo/common/Events.hh&gt;\n<span class=\"gi\">+#include &lt;gazebo/common/Exception.hh&gt;</span>\n #include &lt;gazebo/physics/Joint.hh&gt;\n #include &lt;gazebo/physics/Link.hh&gt;\n #include &quot;VariableGearboxPlugin.hh&quot;\n<span class=\"gu\">@@ -264,9 +265,7 @@</span>\n   }\n   else\n   {\n<span class=\"gd\">-    gzerr &lt;&lt; &quot;No x_y_dydx elements detected&quot;</span>\n<span class=\"gd\">-          &lt;&lt; std::endl;</span>\n<span class=\"gd\">-    return;</span>\n<span class=\"gi\">+    gzthrow(&quot;No x_y_dydx elements detected&quot;);</span>\n   }\n\n   this-&gt;dataPtr-&gt;updateConnection = event::Events::ConnectWorldUpdateBegin(\n</pre></div>", "type": "rendered"}, "created_on": "2019-03-28T23:22:07.367703+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-03-28T23:22:07.381330+00:00", "type": "pullrequest_comment", "id": 96842117}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "4c13949814db", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/4c13949814db.json"}, "html": {"href": "#!/osrf/gazebo/commits/4c13949814db"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-28T23:14:46.620146+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "45352a41e1bd", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/45352a41e1bd.json"}, "html": {"href": "#!/osrf/gazebo/commits/45352a41e1bd"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-28T23:13:21.872222+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "45352a41e1bd", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/45352a41e1bd.json"}, "html": {"href": "#!/osrf/gazebo/commits/45352a41e1bd"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-28T23:13:21.431385+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96841495.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96841495"}}, "parent": {"id": 96823820, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96823820.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96823820"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": " cb6b1f1", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/cb6b1f1\" rel=\"nofollow\" class=\"ap-connect-link\">cb6b1f1</a></p>", "type": "rendered"}, "created_on": "2019-03-28T23:11:16.022065+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-03-28T23:11:16.031513+00:00", "type": "pullrequest_comment", "id": 96841495}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "eb0f984f3af9", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/eb0f984f3af9.json"}, "html": {"href": "#!/osrf/gazebo/commits/eb0f984f3af9"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "cb6b1f181e65", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/cb6b1f181e65.json"}, "html": {"href": "#!/osrf/gazebo/commits/cb6b1f181e65"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-03-28T23:10:53.940023+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96841365.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96841365"}}, "parent": {"id": 96840824, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96840824.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96840824"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "I really wanted the `x_y_dydx` data to be consistent. If I reverse the sign, then it will be x, y, and -dy/dx. It was hard to get the math right even without reversing one of the signs. Does that make sense? I do think we need to document it, but I'm worried about messing with the definition of `x_y_dydx`", "markup": "markdown", "html": "<p>I really wanted the <code>x_y_dydx</code> data to be consistent. If I reverse the sign, then it will be x, y, and -dy/dx. It was hard to get the math right even without reversing one of the signs. Does that make sense? I do think we need to document it, but I'm worried about messing with the definition of <code>x_y_dydx</code></p>", "type": "rendered"}, "created_on": "2019-03-28T23:09:31.571682+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-03-28T23:09:31.582762+00:00", "type": "pullrequest_comment", "id": 96841365}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96840824.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96840824"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "This is the only place I see a gear ratio having it\u2019s sign changed. When a gearbox is loaded from SDF [ODEGearboxJoint::Load](#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/ode/ODEGearboxJoint.cc#lines-52:57) calls [GearboxJoint<ODEJoint>::Load](#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/gazebo/physics/GearboxJoint.hh#lines-59:86) which saves `<gearbox_ratio>` [without changing the sign](#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/gazebo/physics/GearboxJoint.hh#lines-64:65). Then [ODEGearboxJoint::SetGearboxRatio](#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/ode/ODEGearboxJoint.cc#lines-78:82) calls [dJointSetGearboxRatio](#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/deps/opende/src/joints/gearbox.cpp#lines-223:229) which stores it without changing the sign either.\n\nThe [documentation for dJointSetGearboxRatio](#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/deps/opende/include/gazebo/ode/objects.h#lines-2931:2935) says:\n\n```\n * This is the ratio of the angular velocity of the first body to that\n * of the second body along the joint axis.  If the ratio is N then\n * the first body is constrained to rotate N times faster than the\n * second body.  Set it to 1 / N or reverse the bodies for the reverse\n * effect.\n```\n\nwhich is opposite of `angle1 = -ratio * angle2` mentioned in the issue body. I guess the negative sign comes from [here](#!/osrf/gazebo/src/69ebf26d1637e203004da12b11e010e7fee4ce08/deps/opende/src/joints/gearbox.cpp#lines-77:78); however as written the ratio in `<x_y_dydx>` would have the opposite sign convention as the existing `<gearbox_ratio>` on a gearbox joint.\n\nIf I create a gearbox with `<gearbox_ratio>1.0</gearbox_ratio>` between two revolute joints with the same joint axis then the output joint rotates in the opposite direction of the input joint. If I add this plugin to the same model with the same gear ratio then the joints spin in the same direction.\n\n```\n      <plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\n        <gearbox_joint_name>gearbox_joint</gearbox_joint_name>\n        <x_y_dydx>0 0 1.0</x_y_dydx>\n      </plugin>\n```\n\nFor consistency with the current gearbox code, maybe don\u2019t negate the slope here and document the existing convention?", "markup": "markdown", "html": "<p>This is the only place I see a gear ratio having it\u2019s sign changed. When a gearbox is loaded from SDF <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/ode/ODEGearboxJoint.cc#lines-52:57\" rel=\"nofollow\">ODEGearboxJoint::Load</a> calls <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/gazebo/physics/GearboxJoint.hh#lines-59:86\" rel=\"nofollow\">GearboxJoint&lt;ODEJoint&gt;::Load</a> which saves <code>&lt;gearbox_ratio&gt;</code> <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/gazebo/physics/GearboxJoint.hh#lines-64:65\" rel=\"nofollow\">without changing the sign</a>. Then <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/ode/ODEGearboxJoint.cc#lines-78:82\" rel=\"nofollow\">ODEGearboxJoint::SetGearboxRatio</a> calls <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/deps/opende/src/joints/gearbox.cpp#lines-223:229\" rel=\"nofollow\">dJointSetGearboxRatio</a> which stores it without changing the sign either.</p>\n<p>The <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/676a14f7642c3516e6a779ac276e8898cd7d0f79/deps/opende/include/gazebo/ode/objects.h#lines-2931:2935\" rel=\"nofollow\">documentation for dJointSetGearboxRatio</a> says:</p>\n<div class=\"codehilite\"><pre><span></span> * This is the ratio of the angular velocity of the first body to that\n * of the second body along the joint axis.  If the ratio is N then\n * the first body is constrained to rotate N times faster than the\n * second body.  Set it to 1 / N or reverse the bodies for the reverse\n * effect.\n</pre></div>\n\n\n<p>which is opposite of <code>angle1 = -ratio * angle2</code> mentioned in the issue body. I guess the negative sign comes from <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/69ebf26d1637e203004da12b11e010e7fee4ce08/deps/opende/src/joints/gearbox.cpp#lines-77:78\" rel=\"nofollow\">here</a>; however as written the ratio in <code>&lt;x_y_dydx&gt;</code> would have the opposite sign convention as the existing <code>&lt;gearbox_ratio&gt;</code> on a gearbox joint.</p>\n<p>If I create a gearbox with <code>&lt;gearbox_ratio&gt;1.0&lt;/gearbox_ratio&gt;</code> between two revolute joints with the same joint axis then the output joint rotates in the opposite direction of the input joint. If I add this plugin to the same model with the same gear ratio then the joints spin in the same direction.</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;variable_gearbox&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libVariableGearboxPlugin.so&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;gearbox_joint_name&gt;</span>gearbox_joint<span class=\"nt\">&lt;/gearbox_joint_name&gt;</span>\n        <span class=\"nt\">&lt;x_y_dydx&gt;</span>0 0 1.0<span class=\"nt\">&lt;/x_y_dydx&gt;</span>\n      <span class=\"nt\">&lt;/plugin&gt;</span>\n</pre></div>\n\n\n<p>For consistency with the current gearbox code, maybe don\u2019t negate the slope here and document the existing convention?</p>", "type": "rendered"}, "created_on": "2019-03-28T23:00:58.661908+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T23:00:58.672079+00:00", "type": "pullrequest_comment", "id": 96840824}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96834856.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96834856"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "Recommend `throw`ing here. Gazebo catches exceptions in `Load()` , prints an error message, and avoids calling `Init()` or storing the plugin instance. [#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/Model.cc#lines-1091:1099](#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/Model.cc#lines-1091:1099)", "markup": "markdown", "html": "<p>Recommend <code>throw</code>ing here. Gazebo catches exceptions in <code>Load()</code> , prints an error message, and avoids calling <code>Init()</code> or storing the plugin instance. <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/Model.cc#lines-1091:1099\" rel=\"nofollow\">#!/osrf/gazebo/src/8491fe37f72f2dd1623c7c7fc6bd2dce8be14b72/gazebo/physics/Model.cc#lines-1091:1099</a></p>", "type": "rendered"}, "created_on": "2019-03-28T21:42:18.866861+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T21:42:18.876606+00:00", "type": "pullrequest_comment", "id": 96834856}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96824122.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96824122"}}, "parent": {"id": 96823803, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96823803.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96823803"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "Ah nevermind, the joint\\_spawn test checks that and the sign is the same in and out. It must be something higher level.", "markup": "markdown", "html": "<p>Ah nevermind, the joint_spawn test checks that and the sign is the same in and out. It must be something higher level.</p>", "type": "rendered"}, "created_on": "2019-03-28T19:58:36.512991+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T19:58:36.525268+00:00", "type": "pullrequest_comment", "id": 96824122}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96823820.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96823820"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "nit, `1.6`", "markup": "markdown", "html": "<p>nit, <code>1.6</code></p>", "type": "rendered"}, "created_on": "2019-03-28T19:55:52.730483+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T19:55:52.739016+00:00", "type": "pullrequest_comment", "id": 96823820}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/96823803.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-96823803"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "Does this mean `SetParam(\"ratio\", -1.0)` results in `GetParam(\"ratio\", 0)` returning `1.0`? If so, that\u2019s confusing", "markup": "markdown", "html": "<p>Does this mean <code>SetParam(\"ratio\", -1.0)</code> results in <code>GetParam(\"ratio\", 0)</code> returning <code>1.0</code>? If so, that\u2019s confusing</p>", "type": "rendered"}, "created_on": "2019-03-28T19:55:42.630208+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-03-28T19:55:42.642875+00:00", "type": "pullrequest_comment", "id": 96823803}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/92360505.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-92360505"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "To aid in visualizing the splines produced by this plugin, I've created an ipython notebook with some plotting functions and uploaded it to a gist. It includes plots of the input-output relationship used in the example world\n\n* https://gist.github.com/scpeters/f7d87dd6578dee3fb95b90b402046679", "markup": "markdown", "html": "<p>To aid in visualizing the splines produced by this plugin, I've created an ipython notebook with some plotting functions and uploaded it to a gist. It includes plots of the input-output relationship used in the example world</p>\n<ul>\n<li><a href=\"https://gist.github.com/scpeters/f7d87dd6578dee3fb95b90b402046679\" rel=\"nofollow\" class=\"ap-connect-link\">https://gist.github.com/scpeters/f7d87dd6578dee3fb95b90b402046679</a></li>\n</ul>", "type": "rendered"}, "created_on": "2019-02-20T21:52:17.834778+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-02-20T21:52:17.846228+00:00", "type": "pullrequest_comment", "id": 92360505}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91195035.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91195035"}}, "parent": {"id": 91004755, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91004755.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91004755"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "that's a good point. the ABI checker is not complaining either, so I think it's ok in this case\n\n* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=gazebo-abichecker-any_to_any-xenial-amd64&build=756)](https://build.osrfoundation.org/job/gazebo-abichecker-any_to_any-xenial-amd64/756/) https://build.osrfoundation.org/job/gazebo-abichecker-any_to_any-xenial-amd64/756/API_5fABI_20report/", "markup": "markdown", "html": "<p>that's a good point. the ABI checker is not complaining either, so I think it's ok in this case</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/gazebo-abichecker-any_to_any-xenial-amd64/756/\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=gazebo-abichecker-any_to_any-xenial-amd64&amp;build=756\" /></a> <a href=\"https://build.osrfoundation.org/job/gazebo-abichecker-any_to_any-xenial-amd64/756/API_5fABI_20report/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/gazebo-abichecker-any_to_any-xenial-amd64/756/API_5fABI_20report/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2019-02-11T22:12:46.038759+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-02-11T22:12:46.047308+00:00", "type": "pullrequest_comment", "id": 91195035}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "050049dcb2bb", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/050049dcb2bb.json"}, "html": {"href": "#!/osrf/gazebo/commits/050049dcb2bb"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "8491fe37f72f", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/8491fe37f72f.json"}, "html": {"href": "#!/osrf/gazebo/commits/8491fe37f72f"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-02-08T23:41:13.695299+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91018658.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91018658"}}, "parent": {"id": 91004892, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91004892.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91004892"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "8491fe37f72f", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/8491fe37f72f\" rel=\"nofollow\" class=\"ap-connect-link\">8491fe37f72f</a></p>", "type": "rendered"}, "created_on": "2019-02-08T23:40:55.787522+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-02-08T23:40:55.798788+00:00", "type": "pullrequest_comment", "id": 91018658}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91004892.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91004892"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "2019", "markup": "markdown", "html": "<p>2019</p>", "type": "rendered"}, "created_on": "2019-02-08T20:08:28.728128+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-02-08T20:08:28.737816+00:00", "type": "pullrequest_comment", "id": 91004892}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073/comments/91004755.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073/_/diff#comment-91004755"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}, "content": {"raw": "It looks like can overriding an virtual method can break ABI, but I think it\u2019s fine in this case. [https://stackoverflow.com/questions/5746076/in-c-does-overriding-an-existing-virtual-function-break-abi](https://stackoverflow.com/questions/5746076/in-c-does-overriding-an-existing-virtual-function-break-abi)\n\nCompiled code with a cast to `ODEGearboxJoint` and a call to `GetParam()` might have been devirtualized, so they might call the base class method, but code before this PR didn\u2019t know about gearbox parameters anyways so no harm there. Multiple  inheritance isn\u2019t used so no trouble there either.", "markup": "markdown", "html": "<p>It looks like can overriding an virtual method can break ABI, but I think it\u2019s fine in this case. <a data-is-external-link=\"true\" href=\"https://stackoverflow.com/questions/5746076/in-c-does-overriding-an-existing-virtual-function-break-abi\" rel=\"nofollow\">https://stackoverflow.com/questions/5746076/in-c-does-overriding-an-existing-virtual-function-break-abi</a></p>\n<p>Compiled code with a cast to <code>ODEGearboxJoint</code> and a call to <code>GetParam()</code> might have been devirtualized, so they might call the base class method, but code before this PR didn\u2019t know about gearbox parameters anyways so no harm there. Multiple  inheritance isn\u2019t used so no trouble there either.</p>", "type": "rendered"}, "created_on": "2019-02-08T20:06:43.022068+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2019-02-08T20:06:43.030967+00:00", "type": "pullrequest_comment", "id": 91004755}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "050049dcb2bb", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/050049dcb2bb.json"}, "html": {"href": "#!/osrf/gazebo/commits/050049dcb2bb"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "fc78db1ef79e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/fc78db1ef79e.json"}, "html": {"href": "#!/osrf/gazebo/commits/fc78db1ef79e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-02-08T16:45:42.255586+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}, {"update": {"description": "This pull request adds the VariableGearboxPlugin, which uses piecewise cubic Hermite splines to support arbitrary smooth input-output relationships between the input and output angles of a gearbox. This includes the plugin, an example world, a test, and some added API's to ODE to support this feature.\r\n\r\nThe ODE gearbox joint currently supports joint constraints of the form `angle1 = -ratio * angle2`. In order to support arbitrary constraint profiles, reference angles are added to the linear constraint: `angle1 - refAngle1 = -ratio * (angle2 - refAngle2)`. Then at each time step, the smooth input-output curve is linearized at the current joint state to compute refAngle1, refAngle2, and ratio and solved. API's for setting the refAngle's are added to ODE, which can be accessed via `SetParam` / `GetParam` in the physics Joint interface. Tests are added for these new API's to the `joint_spawn` test.\r\n\r\nThe `VariableGearboxPlugin` is a `ModelPlugin` that takes a `gearbox_joint_name` parameter and multiple `x_y_dydx` parameters. The `x_y_dydx` parameters specify points and slopes on the input-output curve. The snippet below is copied from `variable_gearbox_plugin.world`. Documentation of the spline math is provided in the code.\r\n\r\n* x: angle of input joint\r\n* y: angle of output joint\r\n* dy/dx: instantaneous gear ratio of change in output / change in input.\r\n\r\n~~~\r\n<plugin name=\"variable_gearbox\" filename=\"libVariableGearboxPlugin.so\">\r\n  <gearbox_joint_name>demo_joint_types::gearbox_demo</gearbox_joint_name>\r\n  <x_y_dydx>1.2  -1.2  -1.0</x_y_dydx>\r\n  <x_y_dydx>1.8  -7.5 -20.0</x_y_dydx>\r\n</plugin>\r\n~~~\r\n\r\nThe example world uses the `demo_joint_types` model, which has a pendulum connected via a gearbox to a flywheel. This plugin shifts the gear ratio from a low speed of the flywheel to a high speed as the pendulum swings.", "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles", "destination": {"commit": {"hash": "050049dcb2bb", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/050049dcb2bb.json"}, "html": {"href": "#!/osrf/gazebo/commits/050049dcb2bb"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "fc78db1ef79e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/fc78db1ef79e.json"}, "html": {"href": "#!/osrf/gazebo/commits/fc78db1ef79e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gearbox_reference_angles7"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-02-08T16:45:42.170140+00:00"}, "pull_request": {"type": "pullrequest", "id": 3073, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3073.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3073"}}, "title": "VariableGearboxPlugin: use splines to support arbitrary smooth input-output gearbox profiles"}}]}