{"rendered": {"description": {"raw": "Let's take this as an ugly workaround.\r\n\r\nStory: while testing the Apple built, @scpeters [realized](#!/osrf/gazebo/issue/1026/osx-seg-faults-during-plugin-teardown) that the dlclose call make the tests and plugins to segfault on Mach-O. In my works to prepare the hidden by default symbols branch, I have [realized](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on) that exactly the same thing was happening.\r\n\r\nI was unable to find the reason (grrrrr) why they are segfaulting under these two circumstances. The workaround is to disable the dlclose call. This should leave the plugin lodaded in memory since the internal counteref is not decrease. \r\n\r\nThe point is that I was able to [verify](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on#comment-8815755) that after finishing gazebo or tests, the plugin and the rest of gazebo libraries are not loaded in memory any more. So my opinion is that the impact of not unload the plugin at the right moment (specially if this only occurs while closing the app) is limited.", "markup": "markdown", "html": "<p>Let's take this as an ugly workaround.</p>\n<p>Story: while testing the Apple built, @scpeters <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1026/osx-seg-faults-during-plugin-teardown\" rel=\"nofollow\">realized</a> that the dlclose call make the tests and plugins to segfault on Mach-O. In my works to prepare the hidden by default symbols branch, I have <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on\" rel=\"nofollow\">realized</a> that exactly the same thing was happening.</p>\n<p>I was unable to find the reason (grrrrr) why they are segfaulting under these two circumstances. The workaround is to disable the dlclose call. This should leave the plugin lodaded in memory since the internal counteref is not decrease. </p>\n<p>The point is that I was able to <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on#comment-8815755\" rel=\"nofollow\">verify</a> that after finishing gazebo or tests, the plugin and the rest of gazebo libraries are not loaded in memory any more. So my opinion is that the impact of not unload the plugin at the right moment (specially if this only occurs while closing the app) is limited.</p>", "type": "rendered"}, "title": {"raw": "Disable dlclose call in plugins", "markup": "markdown", "html": "<p>Disable dlclose call in plugins</p>", "type": "rendered"}}, "type": "pullrequest", "description": "Let's take this as an ugly workaround.\r\n\r\nStory: while testing the Apple built, @scpeters [realized](#!/osrf/gazebo/issue/1026/osx-seg-faults-during-plugin-teardown) that the dlclose call make the tests and plugins to segfault on Mach-O. In my works to prepare the hidden by default symbols branch, I have [realized](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on) that exactly the same thing was happening.\r\n\r\nI was unable to find the reason (grrrrr) why they are segfaulting under these two circumstances. The workaround is to disable the dlclose call. This should leave the plugin lodaded in memory since the internal counteref is not decrease. \r\n\r\nThe point is that I was able to [verify](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on#comment-8815755) that after finishing gazebo or tests, the plugin and the rest of gazebo libraries are not loaded in memory any more. So my opinion is that the impact of not unload the plugin at the right moment (specially if this only occurs while closing the app) is limited.", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/994/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diffstat/osrf/gazebo:343a987165af%0D12e147c89c29?from_pullrequest_id=994"}, "commits": {"href": "data/repositories/osrf/gazebo/pullrequests/994/commits.json"}, "self": {"href": "data/repositories/osrf/gazebo/pullrequests/994.json"}, "comments": {"href": "data/repositories/osrf/gazebo/pullrequests/994/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/994/merge"}, "html": {"href": "#!/osrf/gazebo/pull-requests/994"}, "activity": {"href": "data/repositories/osrf/gazebo/pullrequests/994/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:343a987165af%0D12e147c89c29?from_pullrequest_id=994"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/994/approve"}, "statuses": {"href": "data/repositories/osrf/gazebo/pullrequests/994/statuses_page=1.json"}}, "title": "Disable dlclose call in plugins", "close_source_branch": true, "reviewers": [], "id": 994, "destination": {"commit": {"hash": "12e147c89c29", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/12e147c89c29.json"}, "html": {"href": "#!/osrf/gazebo/commits/12e147c89c29"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "default"}}, "created_on": "2014-02-28T20:04:15.111755+00:00", "summary": {"raw": "Let's take this as an ugly workaround.\r\n\r\nStory: while testing the Apple built, @scpeters [realized](#!/osrf/gazebo/issue/1026/osx-seg-faults-during-plugin-teardown) that the dlclose call make the tests and plugins to segfault on Mach-O. In my works to prepare the hidden by default symbols branch, I have [realized](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on) that exactly the same thing was happening.\r\n\r\nI was unable to find the reason (grrrrr) why they are segfaulting under these two circumstances. The workaround is to disable the dlclose call. This should leave the plugin lodaded in memory since the internal counteref is not decrease. \r\n\r\nThe point is that I was able to [verify](#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on#comment-8815755) that after finishing gazebo or tests, the plugin and the rest of gazebo libraries are not loaded in memory any more. So my opinion is that the impact of not unload the plugin at the right moment (specially if this only occurs while closing the app) is limited.", "markup": "markdown", "html": "<p>Let's take this as an ugly workaround.</p>\n<p>Story: while testing the Apple built, @scpeters <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1026/osx-seg-faults-during-plugin-teardown\" rel=\"nofollow\">realized</a> that the dlclose call make the tests and plugins to segfault on Mach-O. In my works to prepare the hidden by default symbols branch, I have <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on\" rel=\"nofollow\">realized</a> that exactly the same thing was happening.</p>\n<p>I was unable to find the reason (grrrrr) why they are segfaulting under these two circumstances. The workaround is to disable the dlclose call. This should leave the plugin lodaded in memory since the internal counteref is not decrease. </p>\n<p>The point is that I was able to <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/1066/tests-segfaults-when-calling-dlclose-on#comment-8815755\" rel=\"nofollow\">verify</a> that after finishing gazebo or tests, the plugin and the rest of gazebo libraries are not loaded in memory any more. So my opinion is that the impact of not unload the plugin at the right moment (specially if this only occurs while closing the app) is limited.</p>", "type": "rendered"}, "source": {"commit": {"hash": "fe45d6b037b2", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/fe45d6b037b2.json"}, "html": {"href": "#!/osrf/gazebo/commits/fe45d6b037b2"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "no_dlclose"}}, "comment_count": 2, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2014-03-03T16:56:43.831786+00:00", "type": "participant", "approved": false, "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}}, {"role": "PARTICIPANT", "participated_on": "2014-03-02T06:24:50.370954+00:00", "type": "participant", "approved": true, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, {"role": "PARTICIPANT", "participated_on": "2014-03-03T16:16:22.746427+00:00", "type": "participant", "approved": true, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}], "reason": "", "updated_on": "2014-03-03T18:03:13.650582+00:00", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "merge_commit": {"hash": "343a987165af", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/343a987165af.json"}, "html": {"href": "#!/osrf/gazebo/commits/343a987165af"}}}, "closed_by": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}}