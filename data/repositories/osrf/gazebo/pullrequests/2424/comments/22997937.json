{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2424/comments/22997937.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2424/_/diff#comment-22997937"}}, "parent": {"id": 22997445, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2424/comments/22997445.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2424/_/diff#comment-22997445"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2424, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2424.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2424"}}, "title": "LookAt"}, "content": {"raw": "good point, maybe the following is the best one could do:\n\n~~~\ndiff -r 283b32605b2c gazebo/rendering/Camera.cc\n--- a/gazebo/rendering/Camera.cc\tSun Aug 28 16:01:40 2016 -0700\n+++ b/gazebo/rendering/Camera.cc\tMon Aug 29 15:12:58 2016 -0700\n@@ -366,9 +366,11 @@\n       this->dataPtr->trackedVisual->GetWorldPose().pos.Ign() -\n                               this->WorldPose().Pos();\n \n-    double yaw = atan2(direction.Y(), direction.X());\n-    double pitch = atan2(-direction.Z(),\n-                         sqrt(pow(direction.X(), 2) + pow(direction.Y(), 2)));\n+    auto look = ignition::math::Matrix4d::LookAt(\n+                  ignition::math::Vector3d::Zero,\n+                  direction).Rotation().Euler();\n+    double yaw = look.Z();\n+    double pitch = look.Y();\n \n     Ogre::Quaternion localRotOgre = this->sceneNode->getOrientation();\n     ignition::math::Quaterniond localRot = ignition::math::Quaterniond(\n~~~", "markup": "markdown", "html": "<p>good point, maybe the following is the best one could do:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 283b32605b2c gazebo/rendering/Camera.cc</span>\n<span class=\"gd\">--- a/gazebo/rendering/Camera.cc    Sun Aug 28 16:01:40 2016 -0700</span>\n<span class=\"gi\">+++ b/gazebo/rendering/Camera.cc    Mon Aug 29 15:12:58 2016 -0700</span>\n<span class=\"gu\">@@ -366,9 +366,11 @@</span>\n       this-&gt;dataPtr-&gt;trackedVisual-&gt;GetWorldPose().pos.Ign() -\n                               this-&gt;WorldPose().Pos();\n\n<span class=\"gd\">-    double yaw = atan2(direction.Y(), direction.X());</span>\n<span class=\"gd\">-    double pitch = atan2(-direction.Z(),</span>\n<span class=\"gd\">-                         sqrt(pow(direction.X(), 2) + pow(direction.Y(), 2)));</span>\n<span class=\"gi\">+    auto look = ignition::math::Matrix4d::LookAt(</span>\n<span class=\"gi\">+                  ignition::math::Vector3d::Zero,</span>\n<span class=\"gi\">+                  direction).Rotation().Euler();</span>\n<span class=\"gi\">+    double yaw = look.Z();</span>\n<span class=\"gi\">+    double pitch = look.Y();</span>\n\n     Ogre::Quaternion localRotOgre = this-&gt;sceneNode-&gt;getOrientation();\n     ignition::math::Quaterniond localRot = ignition::math::Quaterniond(\n</pre></div>", "type": "rendered"}, "created_on": "2016-08-29T22:14:51.190101+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2016-08-29T22:14:51.195607+00:00", "type": "pullrequest_comment", "id": 22997937}