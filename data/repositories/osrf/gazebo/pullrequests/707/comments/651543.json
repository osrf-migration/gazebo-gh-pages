{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/707/comments/651543.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/707/_/diff#comment-651543"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 707, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/707.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/707"}}, "title": "Caching generated terrain files"}, "content": {"raw": "Note sure if it's related but I'll bring it up here. Running  `./test/integration/INTEGRATION_heightmap` gives me:\n\n\n```\n#!\n\nINTEGRATION_heightmap: /build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp:88: static Ogre::TerrainGlobalOptions& Ogre::TerrainGlobalOptions::getSingleton(): Assertion `ms_Singleton' failed.\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffdf9fa700 (LWP 6831)]\n0x00007ffff4b16425 in __GI_raise (sig=<optimized out>)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n64\t../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff4b16425 in __GI_raise (sig=<optimized out>)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#1  0x00007ffff4b19b8b in __GI_abort () at abort.c:91\n#2  0x00007ffff4b0f0ee in __assert_fail_base (fmt=<optimized out>, \n    assertion=0x7ffff06653e8 \"ms_Singleton\", \n    file=0x7ffff0665798 \"/build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp\", \n    line=<optimized out>, function=<optimized out>) at assert.c:94\n#3  0x00007ffff4b0f192 in __GI___assert_fail (assertion=0x7ffff06653e8 \"ms_Singleton\", \n    file=0x7ffff0665798 \"/build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp\", \n    line=88, \n    function=0x7ffff0665d80 \"static Ogre::TerrainGlobalOptions& Ogre::TerrainGlobalOptions::getSingleton()\") at assert.c:103\n#4  0x00007ffff0635c57 in Ogre::TerrainGlobalOptions::getSingleton() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#5  0x00007ffff06550a8 in Ogre::TerrainMaterialGenerator::_renderCompositeMap(unsigned long, Ogre::TRect<long> const&, Ogre::MaterialPtr const&, Ogre::TexturePtr const&) ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#6  0x00007ffff0654ce8 in Ogre::TerrainMaterialGenerator::Profile::updateCompositeMap(Ogre::Terrain const*, Ogre::TRect<long> const&) ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#7  0x00007ffff063de77 in Ogre::Terrain::updateCompositeMap() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#8  0x00007ffff0640387 in Ogre::Terrain::handleResponse(Ogre::WorkQueue::Response const*, Ogre::WorkQueue const*) () from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#9  0x00007ffff0cc6f2a in Ogre::DefaultWorkQueueBase::processResponse(Ogre::WorkQueue::Respon---Type <return> to continue, or q <return> to quit---\nse*) () from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.7.4\n#10 0x00007ffff0cc79ab in Ogre::DefaultWorkQueueBase::processResponses() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.7.4\n#11 0x00007ffff0645404 in Ogre::Terrain::waitForDerivedProcesses() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#12 0x00007ffff064566a in Ogre::Terrain::~Terrain() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#13 0x00007ffff0645ca9 in Ogre::Terrain::~Terrain() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#14 0x00007ffff06510e3 in Ogre::TerrainGroup::TerrainSlot::freeInstance() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#15 0x00007ffff065143d in Ogre::TerrainGroup::TerrainSlot::~TerrainSlot() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#16 0x00007ffff0651892 in Ogre::TerrainGroup::removeAllTerrains() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#17 0x00007ffff6fa2bea in gazebo::rendering::Heightmap::~Heightmap (this=0x7fff712cfc30, \n    __in_chrg=<optimized out>)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Heightmap.cc:75\n\n#18 0x00007ffff6fa2eb9 in gazebo::rendering::Heightmap::~Heightmap (this=0x7fff712cfc30, \n    __in_chrg=<optimized out>)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Heightmap.cc:86\n#19 0x00007ffff6fe1caf in gazebo::rendering::Scene::Clear (this=0x7fffdb3c2780)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Scene.cc:181\n#20 0x00007ffff6fcd769 in gazebo::rendering::RenderEngine::RemoveScene (this=0x72cca0, \n    _name=...) at /home/ian/depot/clones/gazebo5/gazebo/rendering/RenderEngine.cc:182\n---Type <return> to continue, or q <return> to quit---\n#21 0x0000000000446ec7 in ServerFixture::RunServer (this=0xd8be00, _worldFilename=..., \n    _paused=true, _physics=...) at /home/ian/depot/clones/gazebo5/test/ServerFixture.hh:235\n#22 0x00007ffff5a57ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\n#23 0x00007ffff669fe9a in start_thread (arg=0x7fffdf9fa700) at pthread_create.c:308\n#24 0x00007ffff4bd3ccd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#25 0x0000000000000000 in ?? ()\n```\n\nWe can file a separate ticket to track this.\n", "markup": "markdown", "html": "<p>Note sure if it's related but I'll bring it up here. Running  <code>./test/integration/INTEGRATION_heightmap</code> gives me:</p>\n<div class=\"codehilite\"><pre><span></span>INTEGRATION_heightmap: /build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp:88: static Ogre::TerrainGlobalOptions&amp; Ogre::TerrainGlobalOptions::getSingleton(): Assertion `ms_Singleton&#39; failed.\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffdf9fa700 (LWP 6831)]\n0x00007ffff4b16425 in __GI_raise (sig=&lt;optimized out&gt;)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n64  ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff4b16425 in __GI_raise (sig=&lt;optimized out&gt;)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#1  0x00007ffff4b19b8b in __GI_abort () at abort.c:91\n#2  0x00007ffff4b0f0ee in __assert_fail_base (fmt=&lt;optimized out&gt;, \n    assertion=0x7ffff06653e8 &quot;ms_Singleton&quot;, \n    file=0x7ffff0665798 &quot;/build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp&quot;, \n    line=&lt;optimized out&gt;, function=&lt;optimized out&gt;) at assert.c:94\n#3  0x00007ffff4b0f192 in __GI___assert_fail (assertion=0x7ffff06653e8 &quot;ms_Singleton&quot;, \n    file=0x7ffff0665798 &quot;/build/buildd/ogre-1.7.4/Components/Terrain/src/OgreTerrain.cpp&quot;, \n    line=88, \n    function=0x7ffff0665d80 &quot;static Ogre::TerrainGlobalOptions&amp; Ogre::TerrainGlobalOptions::getSingleton()&quot;) at assert.c:103\n#4  0x00007ffff0635c57 in Ogre::TerrainGlobalOptions::getSingleton() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#5  0x00007ffff06550a8 in Ogre::TerrainMaterialGenerator::_renderCompositeMap(unsigned long, Ogre::TRect&lt;long&gt; const&amp;, Ogre::MaterialPtr const&amp;, Ogre::TexturePtr const&amp;) ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#6  0x00007ffff0654ce8 in Ogre::TerrainMaterialGenerator::Profile::updateCompositeMap(Ogre::Terrain const*, Ogre::TRect&lt;long&gt; const&amp;) ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#7  0x00007ffff063de77 in Ogre::Terrain::updateCompositeMap() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#8  0x00007ffff0640387 in Ogre::Terrain::handleResponse(Ogre::WorkQueue::Response const*, Ogre::WorkQueue const*) () from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#9  0x00007ffff0cc6f2a in Ogre::DefaultWorkQueueBase::processResponse(Ogre::WorkQueue::Respon---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\nse*) () from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.7.4\n#10 0x00007ffff0cc79ab in Ogre::DefaultWorkQueueBase::processResponses() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreMain.so.1.7.4\n#11 0x00007ffff0645404 in Ogre::Terrain::waitForDerivedProcesses() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#12 0x00007ffff064566a in Ogre::Terrain::~Terrain() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#13 0x00007ffff0645ca9 in Ogre::Terrain::~Terrain() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#14 0x00007ffff06510e3 in Ogre::TerrainGroup::TerrainSlot::freeInstance() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#15 0x00007ffff065143d in Ogre::TerrainGroup::TerrainSlot::~TerrainSlot() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#16 0x00007ffff0651892 in Ogre::TerrainGroup::removeAllTerrains() ()\n   from /usr/lib/x86_64-linux-gnu/libOgreTerrain.so.1.7.4\n#17 0x00007ffff6fa2bea in gazebo::rendering::Heightmap::~Heightmap (this=0x7fff712cfc30, \n    __in_chrg=&lt;optimized out&gt;)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Heightmap.cc:75\n\n#18 0x00007ffff6fa2eb9 in gazebo::rendering::Heightmap::~Heightmap (this=0x7fff712cfc30, \n    __in_chrg=&lt;optimized out&gt;)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Heightmap.cc:86\n#19 0x00007ffff6fe1caf in gazebo::rendering::Scene::Clear (this=0x7fffdb3c2780)\n    at /home/ian/depot/clones/gazebo5/gazebo/rendering/Scene.cc:181\n#20 0x00007ffff6fcd769 in gazebo::rendering::RenderEngine::RemoveScene (this=0x72cca0, \n    _name=...) at /home/ian/depot/clones/gazebo5/gazebo/rendering/RenderEngine.cc:182\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#21 0x0000000000446ec7 in ServerFixture::RunServer (this=0xd8be00, _worldFilename=..., \n    _paused=true, _physics=...) at /home/ian/depot/clones/gazebo5/test/ServerFixture.hh:235\n#22 0x00007ffff5a57ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\n#23 0x00007ffff669fe9a in start_thread (arg=0x7fffdf9fa700) at pthread_create.c:308\n#24 0x00007ffff4bd3ccd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#25 0x0000000000000000 in ?? ()\n</pre></div>\n\n\n<p>We can file a separate ticket to track this.</p>", "type": "rendered"}, "created_on": "2013-10-08T01:17:15.492072+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2013-10-08T01:17:15.502804+00:00", "type": "pullrequest_comment", "id": 651543}