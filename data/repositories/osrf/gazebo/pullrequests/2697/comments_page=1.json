{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/35868876.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-35868876"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I updated the `SetWorldPose` arithmetic in c7a082b after some testing with Valkyrie in srcsim, and we should add another test in which the detach link is not the canonical link of the model, and then verify that the detach link pose matches the pose sent to the attach function.", "markup": "markdown", "html": "<p>I updated the <code>SetWorldPose</code> arithmetic in <a href=\"#!/osrf/gazebo/commits/c7a082b\" rel=\"nofollow\" class=\"ap-connect-link\">c7a082b</a> after some testing with Valkyrie in srcsim, and we should add another test in which the detach link is not the canonical link of the model, and then verify that the detach link pose matches the pose sent to the attach function.</p>", "type": "rendered"}, "created_on": "2017-04-27T22:51:41.416517+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-04-27T22:51:41.418836+00:00", "type": "pullrequest_comment", "id": 35868876}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42166550.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42166550"}}, "parent": {"id": 35868876, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/35868876.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-35868876"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "that test looks good to me; thanks for writing it!", "markup": "markdown", "html": "<p>that test looks good to me; thanks for writing it!</p>", "type": "rendered"}, "created_on": "2017-08-04T06:11:17.152892+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T06:11:17.156949+00:00", "type": "pullrequest_comment", "id": 42166550}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42054182.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42054182"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "@pchorak if you're working on the harness, you may want to consider reviewing this PR as well", "markup": "markdown", "html": "<p>@pchorak if you're working on the harness, you may want to consider reviewing this PR as well</p>", "type": "rendered"}, "created_on": "2017-08-02T23:41:46.497714+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-02T23:41:46.508997+00:00", "type": "pullrequest_comment", "id": 42054182}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42055641.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42055641"}}, "parent": {"id": 42054182, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42054182.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42054182"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "By the way, where could I find the Valkyrie model? It would be nice to have for harness testing since it was the main use case so far.", "markup": "markdown", "html": "<p>By the way, where could I find the Valkyrie model? It would be nice to have for harness testing since it was the main use case so far.</p>", "type": "rendered"}, "created_on": "2017-08-03T00:27:25.606628+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-03T00:27:25.609326+00:00", "type": "pullrequest_comment", "id": 42055641}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42055896.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42055896"}}, "parent": {"id": 42055641, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42055641.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42055641"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "the valkyrie model is hosted on [gitlab](https://gitlab.com/nasa-jsc-robotics/val_description), and there is an outdated version in a [gazebo_models pull request](#!/osrf/gazebo_models/pull-requests/173/added-valkyrie-model/diff)\n\nit might be easier to use a fully-populated urdf like the following which is more recent than the one in that pull request\n\n* https://gist.github.com/scpeters/18c47ae2b0d4e8c2d339df88daa922e9", "markup": "markdown", "html": "<p>the valkyrie model is hosted on <a data-is-external-link=\"true\" href=\"https://gitlab.com/nasa-jsc-robotics/val_description\" rel=\"nofollow\">gitlab</a>, and there is an outdated version in a <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo_models/pull-requests/173/added-valkyrie-model/diff\" rel=\"nofollow\">gazebo_models pull request</a></p>\n<p>it might be easier to use a fully-populated urdf like the following which is more recent than the one in that pull request</p>\n<ul>\n<li><a href=\"https://gist.github.com/scpeters/18c47ae2b0d4e8c2d339df88daa922e9\" rel=\"nofollow\" class=\"ap-connect-link\">https://gist.github.com/scpeters/18c47ae2b0d4e8c2d339df88daa922e9</a></li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-03T00:36:08.966368+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-03T00:36:08.969021+00:00", "type": "pullrequest_comment", "id": 42055896}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42153756.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42153756"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Looks good to me. Ready to accept if the build test is ok.\n\n* https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/590/", "markup": "markdown", "html": "<p>Looks good to me. Ready to accept if the build test is ok.</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/590/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/590/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-04T00:06:48.314628+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-04T00:07:40.694460+00:00", "type": "pullrequest_comment", "id": 42153756}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42166637.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42166637"}}, "parent": {"id": 42153756, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42153756.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42153756"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Two of the `DetachPaused` tests failed, but I think they're flaky", "markup": "markdown", "html": "<p>Two of the <code>DetachPaused</code> tests failed, but I think they're flaky</p>", "type": "rendered"}, "created_on": "2017-08-04T06:13:13.348393+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T06:13:13.350830+00:00", "type": "pullrequest_comment", "id": 42166637}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42217635.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42217635"}}, "parent": {"id": 42166637, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42166637.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42166637"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Yes, they don't fail on my machine. Maybe it wouldn't be a bad spot to use Grey's `VEC_EXPECT_NEAR` macro so we can see how much the positions differ?", "markup": "markdown", "html": "<p>Yes, they don't fail on my machine. Maybe it wouldn't be a bad spot to use Grey's <code>VEC_EXPECT_NEAR</code> macro so we can see how much the positions differ?</p>", "type": "rendered"}, "created_on": "2017-08-04T16:23:05.009280+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-04T16:23:45.178875+00:00", "type": "pullrequest_comment", "id": 42217635}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42222251.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42222251"}}, "parent": {"id": 42217635, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42217635.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42217635"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "That's not a bad idea, but I think we should try to stress-test this for flakiness since it is a new part of the test", "markup": "markdown", "html": "<p>That's not a bad idea, but I think we should try to stress-test this for flakiness since it is a new part of the test</p>", "type": "rendered"}, "created_on": "2017-08-04T17:33:38.476509+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T17:33:38.479199+00:00", "type": "pullrequest_comment", "id": 42222251}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42224982.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42224982"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I just found a race condition different than the jenkins failure: we don't grab a mutex when attaching, so if it attaches a joint during the physics update, it can cause a seg-fault. This would probably happen more frequently if we added the Attach logic to the DetachUnpaused function as well, since it is running unthrottled.", "markup": "markdown", "html": "<p>I just found a race condition different than the jenkins failure: we don't grab a mutex when attaching, so if it attaches a joint during the physics update, it can cause a seg-fault. This would probably happen more frequently if we added the Attach logic to the DetachUnpaused function as well, since it is running unthrottled.</p>", "type": "rendered"}, "created_on": "2017-08-04T18:19:22.155304+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T18:19:22.157944+00:00", "type": "pullrequest_comment", "id": 42224982}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42237503.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42237503"}}, "parent": {"id": 42224982, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42224982.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42224982"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I added a test in 6a9fb63 and a fix in d6706d7 ", "markup": "markdown", "html": "<p>I added a test in <a href=\"#!/osrf/gazebo/commits/6a9fb63\" rel=\"nofollow\" class=\"ap-connect-link\">6a9fb63</a> and a fix in <a href=\"#!/osrf/gazebo/commits/d6706d7\" rel=\"nofollow\" class=\"ap-connect-link\">d6706d7</a> </p>", "type": "rendered"}, "created_on": "2017-08-04T22:45:16.778733+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T22:45:16.781891+00:00", "type": "pullrequest_comment", "id": 42237503}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42237520.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42237520"}}, "parent": {"id": 42237503, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42237503.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42237503"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "started another build here:\n\n* https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/592/", "markup": "markdown", "html": "<p>started another build here:</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/592/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/592/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-04T22:45:57.491025+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-04T22:45:57.493507+00:00", "type": "pullrequest_comment", "id": 42237520}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42239093.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42239093"}}, "parent": {"id": 42237520, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42237520.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42237520"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "harness tests passed in that build, but that doesn't disprove flakiness", "markup": "markdown", "html": "<p>harness tests passed in that build, but that doesn't disprove flakiness</p>", "type": "rendered"}, "created_on": "2017-08-05T00:05:55.759861+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-05T00:05:55.763264+00:00", "type": "pullrequest_comment", "id": 42239093}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42337232.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42337232"}}, "parent": {"id": 42239093, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42239093.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42239093"}}, "depth": 4}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I am still observing flakiness on my machine. In another build, detach fails.\n\n* https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/594/testReport/", "markup": "markdown", "html": "<p>I am still observing flakiness on my machine. In another build, detach fails.</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/594/testReport/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/594/testReport/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-08T00:52:02.183194+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-08T00:52:56.294705+00:00", "type": "pullrequest_comment", "id": 42337232}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42341958.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42341958"}}, "parent": {"id": 42337232, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42337232.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42337232"}}, "depth": 5}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "yeah, detachment failed, but it's unclear why. it might have been a message dropped by the transport layer since we only sent it once. we could try sending it multiple times?", "markup": "markdown", "html": "<p>yeah, detachment failed, but it's unclear why. it might have been a message dropped by the transport layer since we only sent it once. we could try sending it multiple times?</p>", "type": "rendered"}, "created_on": "2017-08-08T03:58:48.433789+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-08T03:58:48.436904+00:00", "type": "pullrequest_comment", "id": 42341958}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42415347.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42415347"}}, "parent": {"id": 42337232, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42337232.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42337232"}}, "depth": 5}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I think some of the failures I may have been before the race condition fix. I ran the integration test a bunch of times this morning on my machine and couldn't reproduce either the attach or detach failure. If I got back one commit to before the race condition is fixed, the pose test frequently fails after reattachment, so perhaps the mutex helped?\n\nMore tests:\n\n* https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/595/testReport/(root)/PhysicsEngines_Harness/", "markup": "markdown", "html": "<p>I think some of the failures I may have been before the race condition fix. I ran the integration test a bunch of times this morning on my machine and couldn't reproduce either the attach or detach failure. If I got back one commit to before the race condition is fixed, the pose test frequently fails after reattachment, so perhaps the mutex helped?</p>\n<p>More tests:</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/595/testReport/(root)/PhysicsEngines_Harness/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/view/main/view/CI%20any%20jobs/job/gazebo-ci-pr_any-xenial-amd64-gpu-none/595/testReport/(root)/PhysicsEngines_Harness/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-08T18:42:20.672279+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-08T18:42:20.674938+00:00", "type": "pullrequest_comment", "id": 42415347}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42336530.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42336530"}}, "parent": {"id": 42237503, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42237503.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42237503"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "This looks like it fixes the race condition to me. Would there be any advantage to having `OnAttach` set a variable that tells the plugin to attach the joint in the `OnUpdate` loop like `OnDetach` to avoid the race condition?", "markup": "markdown", "html": "<p>This looks like it fixes the race condition to me. Would there be any advantage to having <code>OnAttach</code> set a variable that tells the plugin to attach the joint in the <code>OnUpdate</code> loop like <code>OnDetach</code> to avoid the race condition?</p>", "type": "rendered"}, "created_on": "2017-08-08T00:25:06.870172+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-08T00:25:06.872807+00:00", "type": "pullrequest_comment", "id": 42336530}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42336628.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42336628"}}, "parent": {"id": 42336530, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42336530.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42336530"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "On a related topic, I noticed that `Model::RemoveJoint` [pauses the world](#!/osrf/gazebo/src/d6706d724545d9c0cb3c5c4019a1e9da15eca03c/gazebo/physics/Model.cc?at=harness_attach_default&fileviewer=file-view-default#Model.cc-1619) I assume in order to avoid race conditions (although not a problem for the harness plugin because it is called from the update loop). Would it be better to use the update mutex there as well?", "markup": "markdown", "html": "<p>On a related topic, I noticed that <code>Model::RemoveJoint</code> <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/d6706d724545d9c0cb3c5c4019a1e9da15eca03c/gazebo/physics/Model.cc?at=harness_attach_default&amp;fileviewer=file-view-default#Model.cc-1619\" rel=\"nofollow\">pauses the world</a> I assume in order to avoid race conditions (although not a problem for the harness plugin because it is called from the update loop). Would it be better to use the update mutex there as well?</p>", "type": "rendered"}, "created_on": "2017-08-08T00:28:43.100365+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-08T00:28:43.102833+00:00", "type": "pullrequest_comment", "id": 42336628}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42341903.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42341903"}}, "parent": {"id": 42336628, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42336628.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42336628"}}, "depth": 4}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "it quite possibly could work there. I'm not sure if it would cause any deadlocks", "markup": "markdown", "html": "<p>it quite possibly could work there. I'm not sure if it would cause any deadlocks</p>", "type": "rendered"}, "created_on": "2017-08-08T03:56:26.996126+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-08T03:56:26.999544+00:00", "type": "pullrequest_comment", "id": 42341903}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42341881.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42341881"}}, "parent": {"id": 42336530, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42336530.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42336530"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "the first version of code did exactly that, but I had forgotten that Detach disconnects the `OnUpdate` event. So you would have to save all the attachment info then re-connect to `OnUpdate` and then check in `OnUpdate` for cached Attach calls. It worked but it was much shorter to just lock the physics update mutex, so I opted for that", "markup": "markdown", "html": "<p>the first version of code did exactly that, but I had forgotten that Detach disconnects the <code>OnUpdate</code> event. So you would have to save all the attachment info then re-connect to <code>OnUpdate</code> and then check in <code>OnUpdate</code> for cached Attach calls. It worked but it was much shorter to just lock the physics update mutex, so I opted for that</p>", "type": "rendered"}, "created_on": "2017-08-08T03:55:32.331235+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-08T03:55:32.334480+00:00", "type": "pullrequest_comment", "id": 42341881}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524350.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524350"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "sdf pointer to the `<plugin>` block?", "markup": "markdown", "html": "<p>sdf pointer to the <code>&lt;plugin&gt;</code> block?</p>", "type": "rendered"}, "created_on": "2017-08-09T22:25:28.524617+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 38, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-09T22:25:28.527743+00:00", "type": "pullrequest_comment", "id": 42524350}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952066.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952066"}}, "parent": {"id": 42524350, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524350.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524350"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "d569279", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/d569279\" rel=\"nofollow\" class=\"ap-connect-link\">d569279</a></p>", "type": "rendered"}, "created_on": "2017-08-16T18:48:25.927685+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:48:25.931251+00:00", "type": "pullrequest_comment", "id": 42952066}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524430.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524430"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "This is targeted at `default`. What do you think about switching to ignition-transport in this PR?", "markup": "markdown", "html": "<p>This is targeted at <code>default</code>. What do you think about switching to ignition-transport in this PR?</p>", "type": "rendered"}, "created_on": "2017-08-09T22:27:48.483717+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 73, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-09T22:27:48.486782+00:00", "type": "pullrequest_comment", "id": 42524430}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952608.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952608"}}, "parent": {"id": 42524430, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524430.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524430"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I'd prefer to save that for another pull request", "markup": "markdown", "html": "<p>I'd prefer to save that for another pull request</p>", "type": "rendered"}, "created_on": "2017-08-16T18:55:49.061759+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:55:49.064238+00:00", "type": "pullrequest_comment", "id": 42952608}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42959098.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42959098"}}, "parent": {"id": 42952608, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952608.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952608"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Since it now has the PIMPL pattern, it won't break ABI to add an ignition transport node, though we will need a tick-tock cycle to deprecate the gazebo transport interface for this plugin. If we're going to spend time on ignition transport migration, I'd prefer to focus first on services (#2331)", "markup": "markdown", "html": "<p>Since it now has the PIMPL pattern, it won't break ABI to add an ignition transport node, though we will need a tick-tock cycle to deprecate the gazebo transport interface for this plugin. If we're going to spend time on ignition transport migration, I'd prefer to focus first on services (<a href=\"#!/osrf/gazebo/issues/2331/migrate-request-response-behavior-to\" rel=\"nofollow\" title=\"Migrate ~/request, ~/response behavior to ignition services\" class=\"ap-connect-link\">#2331</a>)</p>", "type": "rendered"}, "created_on": "2017-08-16T20:32:55.001589+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T20:32:55.005191+00:00", "type": "pullrequest_comment", "id": 42959098}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524894.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524894"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I see elsewhere that `winchIndex` and `detachIndex` are set to `-1` to indicate the harness is not attached. If the harness is initially unattached, should `-1` be the initial value?", "markup": "markdown", "html": "<p>I see elsewhere that <code>winchIndex</code> and <code>detachIndex</code> are set to <code>-1</code> to indicate the harness is not attached. If the harness is initially unattached, should <code>-1</code> be the initial value?</p>", "type": "rendered"}, "created_on": "2017-08-09T22:40:30.572692+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 48, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-09T22:40:30.576001+00:00", "type": "pullrequest_comment", "id": 42524894}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952083.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952083"}}, "parent": {"id": 42524894, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524894.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524894"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "yes indeed: 0cf8915", "markup": "markdown", "html": "<p>yes indeed: <a href=\"#!/osrf/gazebo/commits/0cf8915\" rel=\"nofollow\" class=\"ap-connect-link\">0cf8915</a></p>", "type": "rendered"}, "created_on": "2017-08-16T18:48:41.346623+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:48:41.350293+00:00", "type": "pullrequest_comment", "id": 42952083}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524989.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524989"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "`const int winchIndex`?", "markup": "markdown", "html": "<p><code>const int winchIndex</code>?</p>", "type": "rendered"}, "created_on": "2017-08-09T22:42:51.075929+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 214, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-09T22:42:51.078317+00:00", "type": "pullrequest_comment", "id": 42524989}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952540.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952540"}}, "parent": {"id": 42524989, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42524989.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42524989"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "\"Constancy is the complement of all other human virtues.\" [Giuseppe Mazzini](https://www.brainyquote.com/quotes/quotes/g/giuseppema158625.html?src=t_constancy)\n\ncd74a9d", "markup": "markdown", "html": "<p>\"Constancy is the complement of all other human virtues.\" <a data-is-external-link=\"true\" href=\"https://www.brainyquote.com/quotes/quotes/g/giuseppema158625.html?src=t_constancy\" rel=\"nofollow\">Giuseppe Mazzini</a></p>\n<p><a href=\"#!/osrf/gazebo/commits/cd74a9d\" rel=\"nofollow\" class=\"ap-connect-link\">cd74a9d</a></p>", "type": "rendered"}, "created_on": "2017-08-16T18:54:55.013976+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:54:55.016767+00:00", "type": "pullrequest_comment", "id": 42952540}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42525465.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42525465"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "If `dataPtr->winchIndex` can change in another callback, it seems like it should be `std::atomic<int>` at the very least. However, since this index used to access other data, the whole plugin should probably acquire a lock during both the physics and transport callbacks. Otherwise it's possible to get into a situations where `winchIndex` was set and stored here, but `dataPtr->joints` was cleared in another callback in another thread just before this thread tries to access the joint at that index.", "markup": "markdown", "html": "<p>If <code>dataPtr-&gt;winchIndex</code> can change in another callback, it seems like it should be <code>std::atomic&lt;int&gt;</code> at the very least. However, since this index used to access other data, the whole plugin should probably acquire a lock during both the physics and transport callbacks. Otherwise it's possible to get into a situations where <code>winchIndex</code> was set and stored here, but <code>dataPtr-&gt;joints</code> was cleared in another callback in another thread just before this thread tries to access the joint at that index.</p>", "type": "rendered"}, "created_on": "2017-08-09T22:56:19.698397+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 212, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-09T22:56:19.701219+00:00", "type": "pullrequest_comment", "id": 42525465}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42799573.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42799573"}}, "parent": {"id": 42525465, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42525465.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42525465"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "well, `winchIndex` can be set to `-1` in the `OnDetach` callback, but I think `joints` is protected; I should double-check\n\n`std::atomic<int>` sounds like a good idea", "markup": "markdown", "html": "<p>well, <code>winchIndex</code> can be set to <code>-1</code> in the <code>OnDetach</code> callback, but I think <code>joints</code> is protected; I should double-check</p>\n<p><code>std::atomic&lt;int&gt;</code> sounds like a good idea</p>", "type": "rendered"}, "created_on": "2017-08-15T01:07:36.919881+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-15T01:07:36.922050+00:00", "type": "pullrequest_comment", "id": 42799573}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42864520.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42864520"}}, "parent": {"id": 42799573, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42799573.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42799573"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "What kind of protection is used on `joints`? I don't see any. Are gazebo transport callbacks guaranteed to not be called during `WorldUpdateBegin`?\n\nIf not then I think there's a possible crash:  `OnUpdate` is called in  the physics thread, and the OS context switches after the check of winchIndex on lines 215-216. In another thread `OnDetach` is called by gazebo transport and it completes or at least finishes `this->dataPtr->joints.clear();` on line 432). Then there's a context switch back to the physics thread and a potential to crash on line 238 where `this->dataPtr->joints[winchIndex]->GetVelocity(0)` is called.", "markup": "markdown", "html": "<p>What kind of protection is used on <code>joints</code>? I don't see any. Are gazebo transport callbacks guaranteed to not be called during <code>WorldUpdateBegin</code>?</p>\n<p>If not then I think there's a possible crash:  <code>OnUpdate</code> is called in  the physics thread, and the OS context switches after the check of winchIndex on lines 215-216. In another thread <code>OnDetach</code> is called by gazebo transport and it completes or at least finishes <code>this-&gt;dataPtr-&gt;joints.clear();</code> on line 432). Then there's a context switch back to the physics thread and a potential to crash on line 238 where <code>this-&gt;dataPtr-&gt;joints[winchIndex]-&gt;GetVelocity(0)</code> is called.</p>", "type": "rendered"}, "created_on": "2017-08-15T20:07:18.249011+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-15T20:07:18.252143+00:00", "type": "pullrequest_comment", "id": 42864520}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42950050.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42950050"}}, "parent": {"id": 42864520, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42864520.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42864520"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "you're right; I'm adding a mutex and testing it now\n\nthanks for noticing this", "markup": "markdown", "html": "<p>you're right; I'm adding a mutex and testing it now</p>\n<p>thanks for noticing this</p>", "type": "rendered"}, "created_on": "2017-08-16T18:19:40.813143+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:19:40.816846+00:00", "type": "pullrequest_comment", "id": 42950050}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42952059.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42952059"}}, "parent": {"id": 42950050, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42950050.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42950050"}}, "depth": 4}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "d569279", "markup": "markdown", "html": "<p><a href=\"#!/osrf/gazebo/commits/d569279\" rel=\"nofollow\" class=\"ap-connect-link\">d569279</a></p>", "type": "rendered"}, "created_on": "2017-08-16T18:48:18.570917+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-16T18:48:18.574792+00:00", "type": "pullrequest_comment", "id": 42952059}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43062182.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:b1a26f633ea0..bb8abcd6ee11?path=plugins%2FHarnessPlugin.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43062182"}}, "parent": {"id": 42864520, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42864520.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42864520"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I think the hazard was via `OnAttach`. `OnDetach` does not touch the joints. `Detach` (which clears the joints) is only called from within `OnUpdate`. The problem would be if `OnAttach` was called after `Detach` sets the index to -1 (438) but before it clears the joints (439) because then the joints could get cleared by `Detach` after `Attach` resets the index (332).", "markup": "markdown", "html": "<p>I think the hazard was via <code>OnAttach</code>. <code>OnDetach</code> does not touch the joints. <code>Detach</code> (which clears the joints) is only called from within <code>OnUpdate</code>. The problem would be if <code>OnAttach</code> was called after <code>Detach</code> sets the index to -1 (438) but before it clears the joints (439) because then the joints could get cleared by <code>Detach</code> after <code>Attach</code> resets the index (332).</p>", "type": "rendered"}, "created_on": "2017-08-18T00:17:49.601894+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "inline": {"to": null, "from": null, "path": "plugins/HarnessPlugin.cc"}, "updated_on": "2017-08-18T00:17:49.604331+00:00", "type": "pullrequest_comment", "id": 43062182}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42525632.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=test%2Fintegration%2Fharness.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42525632"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "The string output by the `EXPECT_EQ` macro on failure is written expecting the golden value first. `EXPECT_EQ(nullptr, model->GetJoint(\"joint1\"))`.", "markup": "markdown", "html": "<p>The string output by the <code>EXPECT_EQ</code> macro on failure is written expecting the golden value first. <code>EXPECT_EQ(nullptr, model-&gt;GetJoint(\"joint1\"))</code>.</p>", "type": "rendered"}, "created_on": "2017-08-09T23:01:08.189560+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": 214, "from": null, "path": "test/integration/harness.cc"}, "updated_on": "2017-08-09T23:01:08.191521+00:00", "type": "pullrequest_comment", "id": 42525632}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42951376.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:d6706d724545..2c58f1f33766?path=test%2Fintegration%2Fharness.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42951376"}}, "parent": {"id": 42525632, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42525632.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42525632"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I hear you, but there's lots of places in the code that use the other pattern. I'll change the new code in this PR, but I don't want to change everything else en masse right now.\n\nIt may have come to be this way because the [gtest documentation isn't explicit about the difference between the arguments](https://github.com/google/googletest/blame/master/googletest/docs/Primer.md#L205-L207)", "markup": "markdown", "html": "<p>I hear you, but there's lots of places in the code that use the other pattern. I'll change the new code in this PR, but I don't want to change everything else en masse right now.</p>\n<p>It may have come to be this way because the <a data-is-external-link=\"true\" href=\"https://github.com/google/googletest/blame/master/googletest/docs/Primer.md#L205-L207\" rel=\"nofollow\">gtest documentation isn't explicit about the difference between the arguments</a></p>", "type": "rendered"}, "created_on": "2017-08-16T18:38:25.647373+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": null, "from": null, "path": "test/integration/harness.cc"}, "updated_on": "2017-08-16T18:38:25.651124+00:00", "type": "pullrequest_comment", "id": 42951376}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42958984.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42958984"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I just started a new batch of jenkins builds", "markup": "markdown", "html": "<p>I just started a new batch of jenkins builds</p>", "type": "rendered"}, "created_on": "2017-08-16T20:31:13.659115+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-16T20:31:13.661842+00:00", "type": "pullrequest_comment", "id": 42958984}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42966570.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42966570"}}, "parent": {"id": 42958984, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/42958984.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-42958984"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "no unusual failures", "markup": "markdown", "html": "<p>no unusual failures</p>", "type": "rendered"}, "created_on": "2017-08-16T23:08:04.830484+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-16T23:08:04.833107+00:00", "type": "pullrequest_comment", "id": 42966570}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43062892.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43062892"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "There is an issue with multiple joints...\n\nStart Gazebo with the test world modified as follows:\n~~~\ndiff -r 2c58f1f33766 worlds/harness.world\n--- a/worlds/harness.world  Wed Aug 16 01:11:12 2017 +0000\n+++ b/worlds/harness.world  Thu Aug 17 17:35:52 2017 -0700\n@@ -47,7 +47,19 @@\n           <parent>world</parent>\n           <child>link</child>\n           <axis>\n-            <xyz>1 1 1</xyz>\n+            <xyz>1 0 0</xyz>\n+            <dynamics>\n+              <damping>10</damping>\n+            </dynamics>\n+          </axis>\n+        </joint>\n+\n+        <joint name=\"joint2\" type=\"prismatic\">\n+          <pose>0 0 2 0 0 0</pose>\n+          <parent>world</parent>\n+          <child>link</child>\n+          <axis>\n+            <xyz>0 0 1</xyz>\n             <dynamics>\n               <damping>10</damping>\n             </dynamics>\n@@ -75,7 +87,7 @@\n         <winch>\n           <!-- This must be a joint specified within\n                the body of this plugin. -->\n-          <joint>joint1</joint>\n+          <joint>joint2</joint>\n\n           <!-- PID value for velocity control of the winch. These values\n                are tuned to work with this box model. -->\n@@ -102,7 +114,7 @@\n         <!-- Joint to detach. Once the joint is detached, it cannot be\n              reattached. This must be a joint specified within the\n              body of this plugin. -->\n-        <detach>joint1</detach>\n+        <detach>joint2</detach>\n       </plugin>\n     </model>\n\n~~~\n\nIn another terminal call:\n~~~\n./harness_detach\n./harness_attach 0 0 2 0 0 0\n~~~\n\nResult:\n~~~\n[Wrn] [Model.cc:1594] Model [box] already has a joint named [joint1], skipping creating joint.\ngzserver: /usr/include/boost/smart_ptr/shared_ptr.hpp:648: typename boost::detail::sp_member_access<T>::type boost::shared_ptr<T>::operator->() const [with T = gazebo::physics::Joint; typename boost::detail::sp_member_access<T>::type = gazebo::physics::Joint*]: Assertion `px != 0' failed.\n~~~", "markup": "markdown", "html": "<p>There is an issue with multiple joints...</p>\n<p>Start Gazebo with the test world modified as follows:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 2c58f1f33766 worlds/harness.world</span>\n<span class=\"gd\">--- a/worlds/harness.world  Wed Aug 16 01:11:12 2017 +0000</span>\n<span class=\"gi\">+++ b/worlds/harness.world  Thu Aug 17 17:35:52 2017 -0700</span>\n<span class=\"gu\">@@ -47,7 +47,19 @@</span>\n           &lt;parent&gt;world&lt;/parent&gt;\n           &lt;child&gt;link&lt;/child&gt;\n           &lt;axis&gt;\n<span class=\"gd\">-            &lt;xyz&gt;1 1 1&lt;/xyz&gt;</span>\n<span class=\"gi\">+            &lt;xyz&gt;1 0 0&lt;/xyz&gt;</span>\n<span class=\"gi\">+            &lt;dynamics&gt;</span>\n<span class=\"gi\">+              &lt;damping&gt;10&lt;/damping&gt;</span>\n<span class=\"gi\">+            &lt;/dynamics&gt;</span>\n<span class=\"gi\">+          &lt;/axis&gt;</span>\n<span class=\"gi\">+        &lt;/joint&gt;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+        &lt;joint name=&quot;joint2&quot; type=&quot;prismatic&quot;&gt;</span>\n<span class=\"gi\">+          &lt;pose&gt;0 0 2 0 0 0&lt;/pose&gt;</span>\n<span class=\"gi\">+          &lt;parent&gt;world&lt;/parent&gt;</span>\n<span class=\"gi\">+          &lt;child&gt;link&lt;/child&gt;</span>\n<span class=\"gi\">+          &lt;axis&gt;</span>\n<span class=\"gi\">+            &lt;xyz&gt;0 0 1&lt;/xyz&gt;</span>\n             &lt;dynamics&gt;\n               &lt;damping&gt;10&lt;/damping&gt;\n             &lt;/dynamics&gt;\n<span class=\"gu\">@@ -75,7 +87,7 @@</span>\n         &lt;winch&gt;\n           &lt;!-- This must be a joint specified within\n                the body of this plugin. --&gt;\n<span class=\"gd\">-          &lt;joint&gt;joint1&lt;/joint&gt;</span>\n<span class=\"gi\">+          &lt;joint&gt;joint2&lt;/joint&gt;</span>\n\n           &lt;!-- PID value for velocity control of the winch. These values\n                are tuned to work with this box model. --&gt;\n<span class=\"gu\">@@ -102,7 +114,7 @@</span>\n         &lt;!-- Joint to detach. Once the joint is detached, it cannot be\n              reattached. This must be a joint specified within the\n              body of this plugin. --&gt;\n<span class=\"gd\">-        &lt;detach&gt;joint1&lt;/detach&gt;</span>\n<span class=\"gi\">+        &lt;detach&gt;joint2&lt;/detach&gt;</span>\n       &lt;/plugin&gt;\n     &lt;/model&gt;\n</pre></div>\n\n\n<p>In another terminal call:</p>\n<div class=\"codehilite\"><pre><span></span>./harness_detach\n./harness_attach 0 0 2 0 0 0\n</pre></div>\n\n\n<p>Result:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">[</span><span class=\"nx\">Wrn</span><span class=\"cp\">]</span> <span class=\"cp\">[</span><span class=\"nx\">Model.cc</span><span class=\"p\">:</span><span class=\"mi\">1594</span><span class=\"cp\">]</span> <span class=\"nt\">Model</span> <span class=\"cp\">[</span><span class=\"nx\">box</span><span class=\"cp\">]</span> <span class=\"nt\">already</span> <span class=\"nt\">has</span> <span class=\"nt\">a</span> <span class=\"nt\">joint</span> <span class=\"nt\">named</span> <span class=\"cp\">[</span><span class=\"nx\">joint1</span><span class=\"cp\">]</span><span class=\"o\">,</span> <span class=\"nt\">skipping</span> <span class=\"nt\">creating</span> <span class=\"nt\">joint</span><span class=\"o\">.</span>\n<span class=\"nt\">gzserver</span><span class=\"o\">:</span> <span class=\"o\">/</span><span class=\"nt\">usr</span><span class=\"o\">/</span><span class=\"nt\">include</span><span class=\"o\">/</span><span class=\"nt\">boost</span><span class=\"o\">/</span><span class=\"nt\">smart_ptr</span><span class=\"o\">/</span><span class=\"nt\">shared_ptr</span><span class=\"p\">.</span><span class=\"nc\">hpp</span><span class=\"p\">:</span><span class=\"nd\">648</span><span class=\"o\">:</span> <span class=\"nt\">typename</span> <span class=\"nt\">boost</span><span class=\"p\">::</span><span class=\"nd\">detail</span><span class=\"p\">::</span><span class=\"nd\">sp_member_access</span><span class=\"o\">&lt;</span><span class=\"nt\">T</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">type</span> <span class=\"nt\">boost</span><span class=\"p\">::</span><span class=\"nd\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"nt\">T</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">operator-</span><span class=\"o\">&gt;()</span> <span class=\"nt\">const</span> <span class=\"cp\">[</span><span class=\"k\">with</span> <span class=\"n\">T</span><span class=\"o\"> =</span> <span class=\"nx\">gazebo</span><span class=\"nl\">::physics::Joint</span><span class=\"p\">;</span> <span class=\"nx\">typename</span> <span class=\"nx\">boost</span><span class=\"nl\">::detail::sp_member_access</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"nl\">::type</span> <span class=\"o\">=</span> <span class=\"nx\">gazebo</span><span class=\"nl\">::physics::Joint</span><span class=\"o\">*</span><span class=\"cp\">]</span><span class=\"o\">:</span> <span class=\"nt\">Assertion</span> <span class=\"err\">`</span><span class=\"nt\">px</span> <span class=\"o\">!=</span> <span class=\"nt\">0</span><span class=\"err\">&#39;</span> <span class=\"nt\">failed</span><span class=\"o\">.</span>\n</pre></div>", "type": "rendered"}, "created_on": "2017-08-18T00:41:41.119653+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-18T00:41:41.122031+00:00", "type": "pullrequest_comment", "id": 43062892}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43063415.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43063415"}}, "parent": {"id": 43062892, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43062892.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43062892"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "The issue is that `Detach` only removes one joint. So when the harness is reattached, the duplicate joint is not created and a nullptr is added to the joints lists. If the nullptr were not added, then the winch index would exceed the list length and cause a different problem.\n\nThere are a number of options:\n\n* Detach all joints\n* Only allow one harness joint\n* Do not clear the joint list, only the detached joint. Then only reattach the detached joint later\n* Others?", "markup": "markdown", "html": "<p>The issue is that <code>Detach</code> only removes one joint. So when the harness is reattached, the duplicate joint is not created and a nullptr is added to the joints lists. If the nullptr were not added, then the winch index would exceed the list length and cause a different problem.</p>\n<p>There are a number of options:</p>\n<ul>\n<li>Detach all joints</li>\n<li>Only allow one harness joint</li>\n<li>Do not clear the joint list, only the detached joint. Then only reattach the detached joint later</li>\n<li>Others?</li>\n</ul>", "type": "rendered"}, "created_on": "2017-08-18T00:59:15.649488+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-18T01:02:43.017495+00:00", "type": "pullrequest_comment", "id": 43063415}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43068207.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43068207"}}, "parent": {"id": 43063415, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43063415.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43063415"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "I don't know what the use case would be for having multiple joints. I think your 3 bullet points could all potentially work, but I'd like to see some use case ideas before choosing one of them.\n\nI also think we could move this discussion to an issue so it doesn't block this pull request.", "markup": "markdown", "html": "<p>I don't know what the use case would be for having multiple joints. I think your 3 bullet points could all potentially work, but I'd like to see some use case ideas before choosing one of them.</p>\n<p>I also think we could move this discussion to an issue so it doesn't block this pull request.</p>", "type": "rendered"}, "created_on": "2017-08-18T04:14:50.498776+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-18T04:14:50.501377+00:00", "type": "pullrequest_comment", "id": 43068207}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43123361.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43123361"}}, "parent": {"id": 43068207, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43068207.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43068207"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Sounds reasonable to me", "markup": "markdown", "html": "<p>Sounds reasonable to me</p>", "type": "rendered"}, "created_on": "2017-08-18T16:06:39.831179+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-18T16:06:39.834604+00:00", "type": "pullrequest_comment", "id": 43123361}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43124066.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43124066"}}, "parent": {"id": 43068207, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43068207.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43068207"}}, "depth": 3}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "Issue #2336", "markup": "markdown", "html": "<p>Issue <a href=\"#!/osrf/gazebo/issues/2336/handling-multiple-harness-joints\" rel=\"nofollow\" title=\"Handling multiple harness joints\" class=\"ap-connect-link\">#2336</a></p>", "type": "rendered"}, "created_on": "2017-08-18T16:17:00.953686+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-18T16:17:00.956275+00:00", "type": "pullrequest_comment", "id": 43124066}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43130031.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43130031"}}, "parent": {"id": 43124066, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697/comments/43124066.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697/_/diff#comment-43124066"}}, "depth": 4}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2697, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2697.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2697"}}, "title": "HarnessPlugin: PIMPL and allow re-attaching"}, "content": {"raw": "thanks", "markup": "markdown", "html": "<p>thanks</p>", "type": "rendered"}, "created_on": "2017-08-18T17:51:48.328492+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-08-18T17:51:48.330937+00:00", "type": "pullrequest_comment", "id": 43130031}], "page": 1, "size": 45}