{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2720/comments/37860527.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2720/_/diff#comment-37860527"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2720, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2720.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2720"}}, "title": "GuiIface.cc: Fix buffer size for snprintf when putting \"gazebo\" into g_argv"}, "content": {"raw": "No bug actually, it was just a compiler warning with gcc-7.1.1 that you're trying to copy less than the size of the source string when including the null termination character. See below:\n```\n$ cat test_snprintf.cpp \n```\n```\n#include <stdio.h>\n#include <string.h>\n\nint main(void)\n{\n  char *g_argv = new char[strlen(\"gazebo\")];\n  snprintf(g_argv, strlen(\"gazebo\"), \"gazebo\");\n  printf(\"%s\\n\", g_argv);\n  return 0;\n}\n```\n```\n$ g++ test_snprintf.cpp \n$ ./a.out \ngazeb\n```\nIt actually doesn't really matter at all since g_argv just needs to contain some string, which doesn't seem to be used anywhere else. ", "markup": "markdown", "html": "<p>No bug actually, it was just a compiler warning with gcc-7.1.1 that you're trying to copy less than the size of the source string when including the null termination character. See below:</p>\n<div class=\"codehilite\"><pre><span></span>$ cat test_snprintf.cpp \n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">#include</span> <span class=\"cpf\">&lt;stdio.h&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;string.h&gt;</span><span class=\"cp\"></span>\n\n<span class=\"kt\">int</span> <span class=\"nf\">main</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n  <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">g_argv</span> <span class=\"o\">=</span> <span class=\"n\">new</span> <span class=\"kt\">char</span><span class=\"p\">[</span><span class=\"n\">strlen</span><span class=\"p\">(</span><span class=\"s\">&quot;gazebo&quot;</span><span class=\"p\">)];</span>\n  <span class=\"n\">snprintf</span><span class=\"p\">(</span><span class=\"n\">g_argv</span><span class=\"p\">,</span> <span class=\"n\">strlen</span><span class=\"p\">(</span><span class=\"s\">&quot;gazebo&quot;</span><span class=\"p\">),</span> <span class=\"s\">&quot;gazebo&quot;</span><span class=\"p\">);</span>\n  <span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">&quot;%s</span><span class=\"se\">\\n</span><span class=\"s\">&quot;</span><span class=\"p\">,</span> <span class=\"n\">g_argv</span><span class=\"p\">);</span>\n  <span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>$ g++ test_snprintf.cpp \n$ ./a.out \ngazeb\n</pre></div>\n\n\n<p>It actually doesn't really matter at all since g_argv just needs to contain some string, which doesn't seem to be used anywhere else. </p>", "type": "rendered"}, "created_on": "2017-05-30T19:30:46.831984+00:00", "user": {"display_name": "Kartik Mohta", "uuid": "{f9c2f6cf-3db5-4a40-8461-5ec9927684d8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bf9c2f6cf-3db5-4a40-8461-5ec9927684d8%7D"}, "html": {"href": "https://bitbucket.org/%7Bf9c2f6cf-3db5-4a40-8461-5ec9927684d8%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/f91dea787917fba4c98f9ef3ec71d4f7d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsKM-5.png"}}, "nickname": "kartikmohta", "type": "user", "account_id": "557058:8caf3423-5a74-47de-a731-1d50d415d3f2"}, "updated_on": "2017-05-30T19:30:46.899064+00:00", "type": "pullrequest_comment", "id": 37860527}