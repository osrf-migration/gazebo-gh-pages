{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2547/comments/35973100.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2547/_/diff#comment-35973100"}}, "parent": {"id": 35945843, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2547/comments/35945843.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2547/_/diff#comment-35945843"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2547, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2547.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2547"}}, "title": "Dart 6"}, "content": {"raw": "The problem is that the TurtleBot (and also found the same for PR2) have multiple parent joints. DART can't do multiple parent joints - each ``BodyNode`` (basically corresponds to a link) is created simultaneously with one joint as a pair, and can have only one other parent ``BodyNode``.\n\nAt the very least for this PR the simulation shouldn't crash because of this assertion and instead should print a more descriptive error saying that the model is not supported. I've added this.\n\nIt is still a little awkward that the model can still be seen in gzclient, but that's just the way things are set up right now. At some point it would be nice to be able to return an error upon loading models through the factory message (i.e. make it a service). Aside from this, so far neither ``Model::Init`` nor ``Model::Load`` have return values for indicating success - if they fail, the model should not be added to the world in any way at all, to make things nice and clean. But that would be for a separate PR.\n\nNow at least the simulator doesn't crash any more.\n\nWith the iRobot Hand it's a separate issue. The segmentation fault occurs in FCL (``fcl/broadphase/hierarchy_tree.hxx`` line 298), triggered by the DART world update (``dart::simulation::World::step()`` called from within ``gazebo::physics::DARTPhysics::UpdatePhysics``). There will be something about the model which triggers this case. I'm tracking this down now and will let you know when I found something.", "markup": "markdown", "html": "<p>The problem is that the TurtleBot (and also found the same for PR2) have multiple parent joints. DART can't do multiple parent joints - each <code>BodyNode</code> (basically corresponds to a link) is created simultaneously with one joint as a pair, and can have only one other parent <code>BodyNode</code>.</p>\n<p>At the very least for this PR the simulation shouldn't crash because of this assertion and instead should print a more descriptive error saying that the model is not supported. I've added this.</p>\n<p>It is still a little awkward that the model can still be seen in gzclient, but that's just the way things are set up right now. At some point it would be nice to be able to return an error upon loading models through the factory message (i.e. make it a service). Aside from this, so far neither <code>Model::Init</code> nor <code>Model::Load</code> have return values for indicating success - if they fail, the model should not be added to the world in any way at all, to make things nice and clean. But that would be for a separate PR.</p>\n<p>Now at least the simulator doesn't crash any more.</p>\n<p>With the iRobot Hand it's a separate issue. The segmentation fault occurs in FCL (<code>fcl/broadphase/hierarchy_tree.hxx</code> line 298), triggered by the DART world update (<code>dart::simulation::World::step()</code> called from within <code>gazebo::physics::DARTPhysics::UpdatePhysics</code>). There will be something about the model which triggers this case. I'm tracking this down now and will let you know when I found something.</p>", "type": "rendered"}, "created_on": "2017-04-30T13:38:55.461618+00:00", "user": {"display_name": "Jennifer Buehler", "uuid": "{5949baad-8c43-4d52-9a82-bb8c3511fed8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D"}, "html": {"href": "https://bitbucket.org/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/b28ae0e95eada6ee16f0860c1fa59fdcd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJB-4.png"}}, "nickname": "JenniferBuehler", "type": "user", "account_id": "557058:96bd489a-ec14-4a06-8d31-7bb6d46d1209"}, "updated_on": "2017-04-30T15:05:00.999671+00:00", "type": "pullrequest_comment", "id": 35973100}