{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2655/comments/34798348.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2655/_/diff#comment-34798348"}}, "parent": {"id": 34710544, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2655/comments/34710544.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2655/_/diff#comment-34710544"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2655, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2655.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2655"}}, "title": "Subdivide large heightmaps to fix LOD and support global texture mapping"}, "content": {"raw": "to see the LOD bug in with the `red_dem` file, you can update the visual sdf to enable lod using the `HeightmapLODPlugin` and set `sampling` to 4 to make it a 4K dem file, like so:\n\n~~~\n      <visual name=\"visual\">\n        <geometry>\n          <heightmap>\n            <uri>model://red_dem/dem/dem.tif</uri>\n            <size>80 80 7.27</size>\n            <sampling>4</sampling>\n          </heightmap>\n        </geometry>\n        <material>\n          <script>\n            <uri>file://media/materials/scripts/gazebo.material</uri>\n            <name>Gazebo/Red</name>\n          </script>\n        </material>\n        <plugin name=\"lod\" filename=\"libHeightmapLODPlugin.so\">\n          <lod>4</lod>\n        </plugin>\n      </visual>\n~~~\n\nIt takes a while to load this large dem world (load: ~30s, save: ~35s on my machine), and make sure to clean the cache in `~/.gazebo/paging/red_dem` before launching gazebo. Try zooming and moving around and you'll see parts of the heightmap 'pop' in and out as view changes. \n\nThe repeated texture issue is due to terrain partitioning  (which is done to fix these height glitches and it's not a a problem on `gazebo7`) and should be fixed as part of this pull request. . ", "markup": "markdown", "html": "<p>to see the LOD bug in with the <code>red_dem</code> file, you can update the visual sdf to enable lod using the <code>HeightmapLODPlugin</code> and set <code>sampling</code> to 4 to make it a 4K dem file, like so:</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;heightmap&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>model://red_dem/dem/dem.tif<span class=\"nt\">&lt;/uri&gt;</span>\n            <span class=\"nt\">&lt;size&gt;</span>80 80 7.27<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;sampling&gt;</span>4<span class=\"nt\">&lt;/sampling&gt;</span>\n          <span class=\"nt\">&lt;/heightmap&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;material&gt;</span>\n          <span class=\"nt\">&lt;script&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>file://media/materials/scripts/gazebo.material<span class=\"nt\">&lt;/uri&gt;</span>\n            <span class=\"nt\">&lt;name&gt;</span>Gazebo/Red<span class=\"nt\">&lt;/name&gt;</span>\n          <span class=\"nt\">&lt;/script&gt;</span>\n        <span class=\"nt\">&lt;/material&gt;</span>\n        <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;lod&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libHeightmapLODPlugin.so&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;lod&gt;</span>4<span class=\"nt\">&lt;/lod&gt;</span>\n        <span class=\"nt\">&lt;/plugin&gt;</span>\n      <span class=\"nt\">&lt;/visual&gt;</span>\n</pre></div>\n\n\n<p>It takes a while to load this large dem world (load: ~30s, save: ~35s on my machine), and make sure to clean the cache in <code>~/.gazebo/paging/red_dem</code> before launching gazebo. Try zooming and moving around and you'll see parts of the heightmap 'pop' in and out as view changes. </p>\n<p>The repeated texture issue is due to terrain partitioning  (which is done to fix these height glitches and it's not a a problem on <code>gazebo7</code>) and should be fixed as part of this pull request. . </p>", "type": "rendered"}, "created_on": "2017-04-10T20:46:59.404219+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2017-04-10T20:46:59.406953+00:00", "type": "pullrequest_comment", "id": 34798348}