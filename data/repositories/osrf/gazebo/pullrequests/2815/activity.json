{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55879990.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55879990"}}, "parent": {"id": 55878976, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878976.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878976"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "And it is being released on 7.10 as we speak :wink: ", "markup": "markdown", "html": "<p>And it is being released on 7.10 as we speak <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f609.png\" alt=\"\ud83d\ude09\" title=\":wink:\" data-emoji-short-name=\":wink:\" /> </p>", "type": "rendered"}, "created_on": "2018-02-09T01:08:58.967756+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-02-09T01:08:58.970930+00:00", "type": "pullrequest_comment", "id": 55879990}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55879111.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55879111"}}, "parent": {"id": 55879026, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55879026.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55879026"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "I usually look at the `Activity` link at the top of the page (next to Overview and Commits)\n\n* #!/osrf/gazebo/pull-requests/2815/call-disconnectnewimageframe-in-the/activity", "markup": "markdown", "html": "<p>I usually look at the <code>Activity</code> link at the top of the page (next to Overview and Commits)</p>\n<ul>\n<li><a href=\"#!/osrf/gazebo/pull-requests/2815/call-disconnectnewimageframe-in-the/activity\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/gazebo/pull-requests/2815/call-disconnectnewimageframe-in-the/activity</a></li>\n</ul>", "type": "rendered"}, "created_on": "2018-02-09T00:45:27.382109+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2018-02-09T00:45:27.386570+00:00", "type": "pullrequest_comment", "id": 55879111}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55879026.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55879026"}}, "parent": {"id": 55878976, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878976.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878976"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "Ahh, thanks I'm not used to the bitbucket UI", "markup": "markdown", "html": "<p>Ahh, thanks I'm not used to the bitbucket UI</p>", "type": "rendered"}, "created_on": "2018-02-09T00:43:34.909527+00:00", "user": {"display_name": "Tully Foote", "uuid": "{3d90dbd4-b845-466f-b5bd-068566f7ff50}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d90dbd4-b845-466f-b5bd-068566f7ff50%7D"}, "html": {"href": "https://bitbucket.org/%7B3d90dbd4-b845-466f-b5bd-068566f7ff50%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/3bc6528f8fe1fef6b6ecc7312ee0cf04d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsTF-2.png"}}, "nickname": "Tully Foote", "type": "user", "account_id": "557058:e2bf789f-2138-4a4e-ba39-3d618078e20b"}, "updated_on": "2018-02-09T00:43:34.913019+00:00", "type": "pullrequest_comment", "id": 55879026}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878976.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878976"}}, "parent": {"id": 55878964, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878964.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878964"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "as of 2017-12-08", "markup": "markdown", "html": "<p>as of 2017-12-08</p>", "type": "rendered"}, "created_on": "2018-02-09T00:42:03.923444+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2018-02-09T00:42:03.926497+00:00", "type": "pullrequest_comment", "id": 55878976}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878964.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878964"}}, "parent": {"id": 55878277, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878277.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878277"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "this has already been merged", "markup": "markdown", "html": "<p>this has already been merged</p>", "type": "rendered"}, "created_on": "2018-02-09T00:41:43.863143+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2018-02-09T00:41:43.865610+00:00", "type": "pullrequest_comment", "id": 55878964}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/55878277.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-55878277"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "Is there anything else needed for this PR to be merged?", "markup": "markdown", "html": "<p>Is there anything else needed for this PR to be merged?</p>", "type": "rendered"}, "created_on": "2018-02-09T00:26:00.906353+00:00", "user": {"display_name": "Tully Foote", "uuid": "{3d90dbd4-b845-466f-b5bd-068566f7ff50}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d90dbd4-b845-466f-b5bd-068566f7ff50%7D"}, "html": {"href": "https://bitbucket.org/%7B3d90dbd4-b845-466f-b5bd-068566f7ff50%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/3bc6528f8fe1fef6b6ecc7312ee0cf04d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsTF-2.png"}}, "nickname": "Tully Foote", "type": "user", "account_id": "557058:e2bf789f-2138-4a4e-ba39-3d618078e20b"}, "updated_on": "2018-02-09T00:26:00.909547+00:00", "type": "pullrequest_comment", "id": 55878277}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace : [https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795](https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795)\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "f72b73a33dee", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/f72b73a33dee.json"}, "html": {"href": "#!/osrf/gazebo/commits/f72b73a33dee"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "366d9578e34e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/366d9578e34e.json"}, "html": {"href": "#!/osrf/gazebo/commits/366d9578e34e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "MERGED", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2017-12-08T18:19:40.560070+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"approval": {"date": "2017-12-08T06:03:59.219761+00:00", "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/51458237.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-51458237"}}, "parent": {"id": 50155068, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50155068.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50155068"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "we have a few tests in [camera_sensor.cc](#!/osrf/gazebo/src/366d9578e34e8b01a8095b68803e5c9262703614/test/integration/camera_sensor.cc) that rely on new frame connections and looks like they always disconnect before exiting.", "markup": "markdown", "html": "<p>we have a few tests in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/366d9578e34e8b01a8095b68803e5c9262703614/test/integration/camera_sensor.cc\" rel=\"nofollow\">camera_sensor.cc</a> that rely on new frame connections and looks like they always disconnect before exiting.</p>", "type": "rendered"}, "created_on": "2017-12-08T05:13:31.812876+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2017-12-08T05:13:31.815168+00:00", "type": "pullrequest_comment", "id": 51458237}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"approval": {"date": "2017-12-08T04:47:45.143448+00:00", "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50349621.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50349621"}}, "parent": {"id": 50169006, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50169006.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50169006"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "[366d957](#!/osrf/gazebo/commits/366d9578e34e8b01a8095b68803e5c9262703614?at=gazebo7) done. Thanks for the advice.", "markup": "markdown", "html": "<p><a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/commits/366d9578e34e8b01a8095b68803e5c9262703614?at=gazebo7\" rel=\"nofollow\">366d957</a> done. Thanks for the advice.</p>", "type": "rendered"}, "created_on": "2017-11-23T23:59:42.622741+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "inline": {}, "updated_on": "2017-11-23T23:59:42.625372+00:00", "type": "pullrequest_comment", "id": 50349621}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace : [https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795](https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795)\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "4f3e27ebbdec", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/4f3e27ebbdec.json"}, "html": {"href": "#!/osrf/gazebo/commits/4f3e27ebbdec"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "366d9578e34e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/366d9578e34e.json"}, "html": {"href": "#!/osrf/gazebo/commits/366d9578e34e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-23T23:59:04.834099+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50245950.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50245950"}}, "parent": {"id": 50169006, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50169006.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50169006"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "I was in doubt whether that was already true on Gazebo 7, thanks for the clarification!", "markup": "markdown", "html": "<p>I was in doubt whether that was already true on Gazebo 7, thanks for the clarification!</p>", "type": "rendered"}, "created_on": "2017-11-22T18:49:43.638613+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2017-11-22T18:49:43.641029+00:00", "type": "pullrequest_comment", "id": 50245950}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50169006.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50169006"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "it's equivalent to do:\n\n~~~\nthis->newFrameConnection.reset();\n~~~\n\nand I slightly prefer it due to the deprecation that @chapulina mentioned", "markup": "markdown", "html": "<p>it's equivalent to do:</p>\n<div class=\"codehilite\"><pre><span></span>this-&gt;newFrameConnection.reset();\n</pre></div>\n\n\n<p>and I slightly prefer it due to the deprecation that @chapulina mentioned</p>", "type": "rendered"}, "created_on": "2017-11-22T07:02:13.713816+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2017-11-22T07:02:13.723033+00:00", "type": "pullrequest_comment", "id": 50169006}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50155068.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50155068"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "I don't think there are any tests using this plugin, so we wouldn't catch a problem with the CI, right?", "markup": "markdown", "html": "<p>I don't think there are any tests using this plugin, so we wouldn't catch a problem with the CI, right?</p>", "type": "rendered"}, "created_on": "2017-11-22T00:27:20.145352+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2017-11-22T00:27:20.147776+00:00", "type": "pullrequest_comment", "id": 50155068}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50153331.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50153331"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "oh oh, right. [e211fde](#!/osrf/gazebo/commits/e211fde3248a91736de5659c098eaa179958b534?at=gazebo7) ", "markup": "markdown", "html": "<p>oh oh, right. <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/commits/e211fde3248a91736de5659c098eaa179958b534?at=gazebo7\" rel=\"nofollow\">e211fde</a> </p>", "type": "rendered"}, "created_on": "2017-11-21T23:46:12.462380+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": "2017-11-21T23:46:12.464821+00:00", "type": "pullrequest_comment", "id": 50153331}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace : [https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795](https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795)\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "4f3e27ebbdec", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/4f3e27ebbdec.json"}, "html": {"href": "#!/osrf/gazebo/commits/4f3e27ebbdec"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "e211fde3248a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/e211fde3248a.json"}, "html": {"href": "#!/osrf/gazebo/commits/e211fde3248a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T23:45:28.130729+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50150542.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50150542"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "How about disconnecting the event before resetting `parentSensor`. This could prevent a derived plugin accessing a null `parentSensor` on the `OnNewFrame` callback.", "markup": "markdown", "html": "<p>How about disconnecting the event before resetting <code>parentSensor</code>. This could prevent a derived plugin accessing a null <code>parentSensor</code> on the <code>OnNewFrame</code> callback.</p>", "type": "rendered"}, "created_on": "2017-11-21T22:47:30.214594+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2017-11-21T22:47:30.217211+00:00", "type": "pullrequest_comment", "id": 50150542}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815/comments/50145735.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815/_/diff#comment-50145735"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}, "content": {"raw": "Just a heads up for when porting forward, the `Disconnect*` functions were deprecated on Gazebo 8:\n\n#!/osrf/gazebo/pull-requests/2329/deprecate-event-disconnect-connectionptr/diff", "markup": "markdown", "html": "<p>Just a heads up for when porting forward, the <code>Disconnect*</code> functions were deprecated on Gazebo 8:</p>\n<p><a href=\"#!/osrf/gazebo/pull-requests/2329/deprecate-event-disconnect-connectionptr/diff\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/gazebo/pull-requests/2329/deprecate-event-disconnect-connectionptr/diff</a></p>", "type": "rendered"}, "created_on": "2017-11-21T21:34:35.190815+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2017-11-21T21:34:35.192983+00:00", "type": "pullrequest_comment", "id": 50145735}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace : [https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795](https://gist.github.com/j-rivero/7273acc73c0f10d4d5de009bf880a795)\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "d7411f63727d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d7411f63727d.json"}, "html": {"href": "#!/osrf/gazebo/commits/d7411f63727d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "80b3079eaab0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/80b3079eaab0.json"}, "html": {"href": "#!/osrf/gazebo/commits/80b3079eaab0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T18:34:55.878605+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace :\r\n\r\n> #0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled \\(this=0x17ee9b0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52\r\n> 52\t/var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc: No such file or directory.\r\n> \\(gdb\\) bt\r\n> \\#0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled \\(this=0x17ee9b0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52\r\n> \\#1  0x00007fcdede2b5cc in gazebo::event::Connection::~Connection \\(this=0x16a27e0, \\_\\_in\\_chrg=<optimized out>\\)\r\n>     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:85\r\n> \\#2  0x00007fcde4bff492 in checked\\_delete[gazebo::event::Connection](gazebo::event::Connection) \\(x=0x16a27e0\\) at /usr/include/boost/checked\\_delete.hpp:34\r\n> \\#3  boost::detail::sp\\_counted\\_impl\\_p[gazebo::event::Connection](gazebo::event::Connection)::dispose \\(this=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_impl.hpp:78\r\n> \\#4  0x00007fcd380384ee in boost::detail::sp\\_counted\\_base::release \\(this=0x16eafb0\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_base\\_gcc\\_x86.hpp:146\r\n> \\#5  0x00007fcd380377d1 in ~shared\\_count \\(this=0x1043e58, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/shared\\_count.hpp:371\r\n> \\#6  ~shared\\_ptr \\(this=0x1043e50, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/shared\\_ptr.hpp:328\r\n> \\#7  gazebo::CameraPlugin::~CameraPlugin \\(this=0x1043df0, \\_\\_in\\_chrg=<optimized out>\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/plugins/CameraPlugin.cc:36\r\n> \\#8  0x00007fcd38d8ed6d in gazebo::GazeboRosCamera::~GazeboRosCamera\\(\\) \\(\\) from /opt/ros/indigo/lib/libgazebo\\_ros\\_camera.so\r\n> \\#9  0x00007fcd38d8eeb9 in gazebo::GazeboRosCamera::~GazeboRosCamera\\(\\) \\(\\) from /opt/ros/indigo/lib/libgazebo\\_ros\\_camera.so\r\n> \\#10 0x00007fcdec33fb7e in boost::detail::sp\\_counted\\_base::release \\(this=0x1640e30\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_base\\_gcc\\_x86.hpp:146\r\n> \\#11 0x00007fcdec378c04 in ~shared\\_count \\(this=0x166f2c8, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/shared\\_count.hpp:371\r\n> \\#12 ~shared\\_ptr \\(this=0x166f2c0, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/shared\\_ptr.hpp:328\r\n> \\#13 \\_Destroy<boost::shared\\_ptr[gazebo::SensorPlugin](gazebo::SensorPlugin) > \\(\\_\\_pointer=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:93\r\n> \\#14 \\_\\_destroy<boost::shared\\_ptr[gazebo::SensorPlugin](gazebo::SensorPlugin)*> \\(\\_\\_last=<optimized out>, \\_\\_first=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:103\r\n> \\#15 \\_Destroy<boost::shared\\_ptr*[*gazebo::SensorPlugin*](gazebo::SensorPlugin)> \\(\\_\\_last=<optimized out>, \\_\\_first=<optimized out>\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:126\r\n> \\#16 \\_Destroy<boost::shared\\_ptr[gazebo::SensorPlugin](gazebo::SensorPlugin)\\*, boost::shared\\_ptr[gazebo::SensorPlugin](gazebo::SensorPlugin) > \\(\\_\\_last=0x166f2d0, \\_\\_first=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:151\r\n> \\#17 \\_M\\_erase\\_at\\_end \\(this=<optimized out>, \\_\\_pos=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_vector.h:1352\r\n> \\#18 clear \\(this=0x7fcd1ada2d80\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_vector.h:1126\r\n> \\#19 gazebo::sensors::Sensor::Fini \\(this=0x7fcd1ada2cd0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/Sensor.cc:265\r\n> \\#20 0x00007fcdec34802f in gazebo::sensors::CameraSensor::Fini \\(this=0x7fcd1ada2cd0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/CameraSensor.cc:180\r\n> \\#21 0x00007fcdec380253 in gazebo::sensors::SensorManager::SensorContainer::Fini \\(this=0x158cd90\\)\r\n>     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:440\r\n> \\#22 0x00007fcdec380639 in gazebo::sensors::SensorManager::Fini \\(this=0x7fcdec5e0700 <SingletonT[gazebo::sensors::SensorManager](gazebo::sensors::SensorManager)::GetInstance\\(\\)::t>\\)\r\n>     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:236\r\n> \\#23 0x00007fcdec377f01 in gazebo::sensors::fini \\(\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorsIface.cc:76\r\n> \\#24 0x00007fcdee0d7c6c in gazebo::shutdown \\(\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/gazebo.cc:142\r\n> \\#25 0x00007fcdee0c476d in gazebo::Server::Run \\(this=this@entry=0xe04070\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/Server.cc:582\r\n> \\#26 0x00000000004024d9 in main \\(argc=12, argv=0x7fffeb871ca8\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/server\\_main.cc:40\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "d7411f63727d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d7411f63727d.json"}, "html": {"href": "#!/osrf/gazebo/commits/d7411f63727d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "80b3079eaab0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/80b3079eaab0.json"}, "html": {"href": "#!/osrf/gazebo/commits/80b3079eaab0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T18:34:06.993131+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace :\r\n\r\n> Program terminated with signal SIGSEGV, Segmentation fault. #0 0x00007fcdede2b494 in gazebo::event::Event::GetSignaled \\(this=0x17ee9b0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 52 /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc: No such file or directory. \\(gdb\\) bt #0 0x00007fcdede2b494 in gazebo::event::Event::GetSignaled \\(this=0x17ee9b0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 #1 0x00007fcdede2b5cc in gazebo::event::Connection::~Connection \\(this=0x16a27e0, \\_\\_in\\_chrg=<optimized out>\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:85 #2 0x00007fcde4bff492 in checked\\_deletegazebo::event::Connection \\(x=0x16a27e0\\) at /usr/include/boost/checked\\_delete.hpp:34 #3 boost::detail::sp\\_counted\\_impl\\_pgazebo::event::Connection::dispose \\(this=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_impl.hpp:78 #4 0x00007fcd380384ee in boost::detail::sp\\_counted\\_base::release \\(this=0x16eafb0\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_base\\_gcc\\_x86.hpp:146 #5 0x00007fcd380377d1 in ~shared\\_count \\(this=0x1043e58, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/shared\\_count.hpp:371 #6 ~shared\\_ptr \\(this=0x1043e50, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/shared\\_ptr.hpp:328 #7 gazebo::CameraPlugin::~CameraPlugin \\(this=0x1043df0, \\_\\_in\\_chrg=<optimized out>\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/plugins/CameraPlugin.cc:36 #8 0x00007fcd38d8ed6d in gazebo::GazeboRosCamera::~GazeboRosCamera\\(\\) \\(\\) from /opt/ros/indigo/lib/libgazebo\\_ros\\_camera.so #9 0x00007fcd38d8eeb9 in gazebo::GazeboRosCamera::~GazeboRosCamera\\(\\) \\(\\) from /opt/ros/indigo/lib/libgazebo\\_ros\\_camera.so #10 0x00007fcdec33fb7e in boost::detail::sp\\_counted\\_base::release \\(this=0x1640e30\\) at /usr/include/boost/smart\\_ptr/detail/sp\\_counted\\_base\\_gcc\\_x86.hpp:146 #11 0x00007fcdec378c04 in ~shared\\_count \\(this=0x166f2c8, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/detail/shared\\_count.hpp:371 #12 ~shared\\_ptr \\(this=0x166f2c0, \\_\\_in\\_chrg=<optimized out>\\) at /usr/include/boost/smart\\_ptr/shared\\_ptr.hpp:328 #13 \\_Destroy<boost::shared\\_ptrgazebo::SensorPlugin > \\(\\_\\_pointer=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:93 #14 \\_\\_destroy<boost::shared\\_ptrgazebo::SensorPlugin> \\(\\_\\_last=<optimized out>, \\_\\_first=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:103 #15 \\_Destroy<boost::shared\\_ptrgazebo::SensorPlugin> \\(\\_\\_last=<optimized out>, \\_\\_first=<optimized out>\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:126 #16 \\_Destroy<boost::shared\\_ptrgazebo::SensorPlugin\\*, boost::shared\\_ptrgazebo::SensorPlugin > \\(\\_\\_last=0x166f2d0, \\_\\_first=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_construct.h:151 #17 \\_M\\_erase\\_at\\_end \\(this=<optimized out>, \\_\\_pos=0x166f2c0\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_vector.h:1352 #18 clear \\(this=0x7fcd1ada2d80\\) at /usr/include/c\\+\\+/4.8/bits/stl\\_vector.h:1126 #19 gazebo::sensors::Sensor::Fini \\(this=0x7fcd1ada2cd0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/Sensor.cc:265 #20 0x00007fcdec34802f in gazebo::sensors::CameraSensor::Fini \\(this=0x7fcd1ada2cd0\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/CameraSensor.cc:180 #21 0x00007fcdec380253 in gazebo::sensors::SensorManager::SensorContainer::Fini \\(this=0x158cd90\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:440 #22 0x00007fcdec380639 in gazebo::sensors::SensorManager::Fini \\(this=0x7fcdec5e0700 <SingletonTgazebo::sensors::SensorManager::GetInstance\\(\\)::t>\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:236 #23 0x00007fcdec377f01 in gazebo::sensors::fini \\(\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorsIface.cc:76 #24 0x00007fcdee0d7c6c in gazebo::shutdown \\(\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/gazebo.cc:142 #25 0x00007fcdee0c476d in gazebo::Server::Run \\(this=this@entry=0xe04070\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/Server.cc:582 #26 0x00000000004024d9 in main \\(argc=12, argv=0x7fffeb871ca8\\) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/server\\_main.cc:40\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "d7411f63727d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d7411f63727d.json"}, "html": {"href": "#!/osrf/gazebo/commits/d7411f63727d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "80b3079eaab0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/80b3079eaab0.json"}, "html": {"href": "#!/osrf/gazebo/commits/80b3079eaab0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T18:33:08.336224+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace :\r\n\r\n`Program terminated with signal SIGSEGV, Segmentation fault. #0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled (this=0x17ee9b0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 52\t/var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc: No such file or directory. (gdb) bt #0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled (this=0x17ee9b0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 #1  0x00007fcdede2b5cc in gazebo::event::Connection::~Connection (this=0x16a27e0, __in_chrg=<optimized out>)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:85 #2  0x00007fcde4bff492 in checked_deletegazebo::event::Connection (x=0x16a27e0) at /usr/include/boost/checked_delete.hpp:34 #3  boost::detail::sp_counted_impl_pgazebo::event::Connection::dispose (this=<optimized out>) at /usr/include/boost/smart_ptr/detail/sp_counted_impl.hpp:78 #4  0x00007fcd380384ee in boost::detail::sp_counted_base::release (this=0x16eafb0) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146 #5  0x00007fcd380377d1 in ~shared_count (this=0x1043e58, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371 #6  ~shared_ptr (this=0x1043e50, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328 #7  gazebo::CameraPlugin::~CameraPlugin (this=0x1043df0, __in_chrg=<optimized out>) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/plugins/CameraPlugin.cc:36 #8  0x00007fcd38d8ed6d in gazebo::GazeboRosCamera::~GazeboRosCamera() () from /opt/ros/indigo/lib/libgazebo_ros_camera.so #9  0x00007fcd38d8eeb9 in gazebo::GazeboRosCamera::~GazeboRosCamera() () from /opt/ros/indigo/lib/libgazebo_ros_camera.so #10 0x00007fcdec33fb7e in boost::detail::sp_counted_base::release (this=0x1640e30) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146 #11 0x00007fcdec378c04 in ~shared_count (this=0x166f2c8, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371 #12 ~shared_ptr (this=0x166f2c0, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328 #13 _Destroy<boost::shared_ptrgazebo::SensorPlugin > (__pointer=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:93 #14 __destroy<boost::shared_ptrgazebo::SensorPlugin> (__last=<optimized out>, __first=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:103 #15 _Destroy<boost::shared_ptrgazebo::SensorPlugin> (__last=<optimized out>, __first=<optimized out>) at /usr/include/c++/4.8/bits/stl_construct.h:126 #16 _Destroy<boost::shared_ptrgazebo::SensorPlugin*, boost::shared_ptrgazebo::SensorPlugin > (__last=0x166f2d0, __first=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:151 #17 _M_erase_at_end (this=<optimized out>, __pos=0x166f2c0) at /usr/include/c++/4.8/bits/stl_vector.h:1352 #18 clear (this=0x7fcd1ada2d80) at /usr/include/c++/4.8/bits/stl_vector.h:1126 #19 gazebo::sensors::Sensor::Fini (this=0x7fcd1ada2cd0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/Sensor.cc:265 #20 0x00007fcdec34802f in gazebo::sensors::CameraSensor::Fini (this=0x7fcd1ada2cd0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/CameraSensor.cc:180 #21 0x00007fcdec380253 in gazebo::sensors::SensorManager::SensorContainer::Fini (this=0x158cd90)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:440 #22 0x00007fcdec380639 in gazebo::sensors::SensorManager::Fini (this=0x7fcdec5e0700 <SingletonTgazebo::sensors::SensorManager::GetInstance()::t>)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:236 #23 0x00007fcdec377f01 in gazebo::sensors::fini () at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorsIface.cc:76 #24 0x00007fcdee0d7c6c in gazebo::shutdown () at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/gazebo.cc:142 #25 0x00007fcdee0c476d in gazebo::Server::Run (this=this@entry=0xe04070) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/Server.cc:582 #26 0x00000000004024d9 in main (argc=12, argv=0x7fffeb871ca8) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/server_main.cc:40`\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "d7411f63727d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d7411f63727d.json"}, "html": {"href": "#!/osrf/gazebo/commits/d7411f63727d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "80b3079eaab0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/80b3079eaab0.json"}, "html": {"href": "#!/osrf/gazebo/commits/80b3079eaab0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T18:32:33.689555+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}, {"update": {"description": "While testing ROS code that uses gazebo as part of the testing suite, there is a segfault appearing during the teardown \\([repo and instruction for reproducing the problem](https://github.com/osrf/mayfield_bug_15/)\\) The test suite runs without gazebo GUI and if I enable it the segfault is gone. If the code is run under gdb the segfault is also not present.\r\n\r\nThe backtrace :\r\n\r\n`Program terminated with signal SIGSEGV, Segmentation fault. #0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled (this=0x17ee9b0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 52\t/var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc: No such file or directory. (gdb) bt #0  0x00007fcdede2b494 in gazebo::event::Event::GetSignaled (this=0x17ee9b0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:52 #1  0x00007fcdede2b5cc in gazebo::event::Connection::~Connection (this=0x16a27e0, __in_chrg=<optimized out>)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/common/Event.cc:85 #2  0x00007fcde4bff492 in checked_deletegazebo::event::Connection (x=0x16a27e0) at /usr/include/boost/checked_delete.hpp:34 #3  boost::detail::sp_counted_impl_pgazebo::event::Connection::dispose (this=<optimized out>) at /usr/include/boost/smart_ptr/detail/sp_counted_impl.hpp:78 #4  0x00007fcd380384ee in boost::detail::sp_counted_base::release (this=0x16eafb0) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146 #5  0x00007fcd380377d1 in ~shared_count (this=0x1043e58, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371 #6  ~shared_ptr (this=0x1043e50, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328 #7  gazebo::CameraPlugin::~CameraPlugin (this=0x1043df0, __in_chrg=<optimized out>) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/plugins/CameraPlugin.cc:36 #8  0x00007fcd38d8ed6d in gazebo::GazeboRosCamera::~GazeboRosCamera() () from /opt/ros/indigo/lib/libgazebo_ros_camera.so #9  0x00007fcd38d8eeb9 in gazebo::GazeboRosCamera::~GazeboRosCamera() () from /opt/ros/indigo/lib/libgazebo_ros_camera.so #10 0x00007fcdec33fb7e in boost::detail::sp_counted_base::release (this=0x1640e30) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146 #11 0x00007fcdec378c04 in ~shared_count (this=0x166f2c8, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371 #12 ~shared_ptr (this=0x166f2c0, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328 #13 _Destroy<boost::shared_ptrgazebo::SensorPlugin > (__pointer=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:93 #14 __destroy<boost::shared_ptrgazebo::SensorPlugin> (__last=<optimized out>, __first=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:103 #15 _Destroy<boost::shared_ptrgazebo::SensorPlugin> (__last=<optimized out>, __first=<optimized out>) at /usr/include/c++/4.8/bits/stl_construct.h:126 #16 _Destroy<boost::shared_ptrgazebo::SensorPlugin*, boost::shared_ptrgazebo::SensorPlugin > (__last=0x166f2d0, __first=0x166f2c0) at /usr/include/c++/4.8/bits/stl_construct.h:151 #17 _M_erase_at_end (this=<optimized out>, __pos=0x166f2c0) at /usr/include/c++/4.8/bits/stl_vector.h:1352 #18 clear (this=0x7fcd1ada2d80) at /usr/include/c++/4.8/bits/stl_vector.h:1126 #19 gazebo::sensors::Sensor::Fini (this=0x7fcd1ada2cd0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/Sensor.cc:265 #20 0x00007fcdec34802f in gazebo::sensors::CameraSensor::Fini (this=0x7fcd1ada2cd0) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/CameraSensor.cc:180 #21 0x00007fcdec380253 in gazebo::sensors::SensorManager::SensorContainer::Fini (this=0x158cd90)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:440 #22 0x00007fcdec380639 in gazebo::sensors::SensorManager::Fini (this=0x7fcdec5e0700 <SingletonTgazebo::sensors::SensorManager::GetInstance()::t>)     at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorManager.cc:236 #23 0x00007fcdec377f01 in gazebo::sensors::fini () at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/sensors/SensorsIface.cc:76 #24 0x00007fcdee0d7c6c in gazebo::shutdown () at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/gazebo.cc:142 #25 0x00007fcdee0c476d in gazebo::Server::Run (this=this@entry=0xe04070) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/Server.cc:582 #26 0x00000000004024d9 in main (argc=12, argv=0x7fffeb871ca8) at /var/lib/jenkins/workspace/gazebo7-debbuilder/build/gazebo-7.8.1/gazebo/server_main.cc:40`\r\n\r\nMy hypothesis is that it could be a race condition affecting the `newFrameConnection`event. The [newFrameConnection attribute is \"Connected\" in the Load method](#!/osrf/gazebo/src/b4ea1ead18551e1e787183ed511e0b2810ef5e2a/plugins/CameraPlugin.cc?at=default&fileviewer=file-view-default#CameraPlugin.cc-71) but it is not being \"disconnected\" before destruction.\r\n\r\nWith this PR the problem is gone although I'm not sure if the change proposed is the best of the solutions.", "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor", "destination": {"commit": {"hash": "d7411f63727d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d7411f63727d.json"}, "html": {"href": "#!/osrf/gazebo/commits/d7411f63727d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "80b3079eaab0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/80b3079eaab0.json"}, "html": {"href": "#!/osrf/gazebo/commits/80b3079eaab0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7_fix_segfault_event"}}, "state": "OPEN", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "date": "2017-11-21T18:32:33.654613+00:00"}, "pull_request": {"type": "pullrequest", "id": 2815, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2815.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2815"}}, "title": "Call DisconnectNewImageFrame in the CameraPlugin destructor"}}]}