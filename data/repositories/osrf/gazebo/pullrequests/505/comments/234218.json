{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/505/comments/234218.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/505/_/diff#comment-234218"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 505, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/505.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/505"}}, "title": "Fix entity deletion deadlock"}, "content": {"raw": "I was able to confirm that the bug is present permanently in current default but fix is probably failing in somewhat a race condition. Sometimes works, but some others a throws a tbb::captured_exception.\n\ngdb backtrace:\n\n```\nterminate called after throwing an instance of 'tbb::captured_exception'\n  what():  boost::lock_error\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffbb7fe700 (LWP 8799)]\n0x00007ffff4ffe425 in __GI_raise (sig=<optimized out>)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n64\t../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff4ffe425 in __GI_raise (sig=<optimized out>)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#1  0x00007ffff5001b8b in __GI_abort () at abort.c:91\n#2  0x00007ffff565469d in __gnu_cxx::__verbose_terminate_handler() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff5652846 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff5652873 in std::terminate() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff565296e in __cxa_throw ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007ffff636f15e in tbb::captured_exception::throw_self() ()\n   from /usr/lib/libtbb.so.2\n#7  0x00007ffff63737d7 in ?? () from /usr/lib/libtbb.so.2\n#8  0x00007ffff73f6b0d in gazebo::transport::TopicManager::ProcessNodes(bool)\n    () from /usr/lib/libgazebo_transport.so.1\n#9  0x00007ffff73e15e8 in gazebo::transport::ConnectionManager::RunUpdate() ()\n   from /usr/lib/libgazebo_transport.so.1\n#10 0x00007ffff73e238d in gazebo::transport::ConnectionManager::Run() ()\n   from /usr/lib/libgazebo_transport.so.1\n#11 0x00007ffff5d12ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n---Type <return> to continue, or q <return> to quit---\n```", "markup": "markdown", "html": "<p>I was able to confirm that the bug is present permanently in current default but fix is probably failing in somewhat a race condition. Sometimes works, but some others a throws a tbb::captured_exception.</p>\n<p>gdb backtrace:</p>\n<div class=\"codehilite\"><pre><span></span>terminate called after throwing an instance of &#39;tbb::captured_exception&#39;\n  what():  boost::lock_error\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffbb7fe700 (LWP 8799)]\n0x00007ffff4ffe425 in __GI_raise (sig=&lt;optimized out&gt;)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n64  ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff4ffe425 in __GI_raise (sig=&lt;optimized out&gt;)\n    at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#1  0x00007ffff5001b8b in __GI_abort () at abort.c:91\n#2  0x00007ffff565469d in __gnu_cxx::__verbose_terminate_handler() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff5652846 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff5652873 in std::terminate() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff565296e in __cxa_throw ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007ffff636f15e in tbb::captured_exception::throw_self() ()\n   from /usr/lib/libtbb.so.2\n#7  0x00007ffff63737d7 in ?? () from /usr/lib/libtbb.so.2\n#8  0x00007ffff73f6b0d in gazebo::transport::TopicManager::ProcessNodes(bool)\n    () from /usr/lib/libgazebo_transport.so.1\n#9  0x00007ffff73e15e8 in gazebo::transport::ConnectionManager::RunUpdate() ()\n   from /usr/lib/libgazebo_transport.so.1\n#10 0x00007ffff73e238d in gazebo::transport::ConnectionManager::Run() ()\n   from /usr/lib/libgazebo_transport.so.1\n#11 0x00007ffff5d12ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n</pre></div>", "type": "rendered"}, "created_on": "2013-05-03T22:41:16.783542+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": "2013-05-03T22:41:16.794713+00:00", "type": "pullrequest_comment", "id": 234218}