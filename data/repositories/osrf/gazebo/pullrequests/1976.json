{"rendered": {"description": {"raw": "We have built custom debs of bullet 2.82 for trusty that have double precision enabled, but the debs in Ubuntu vivid use single precision. It still works but with less accuracy and with [some test failures](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/1/) (note the test names ending in `/1`). This PR relaxes test expectations to allow them to pass with single-precision bullet.\r\n\r\n* In several instances where `EXPECT_DOUBLE_EQ` is used, I just change it to `EXPECT_FLOAT_EQ` for all physics engines. This slightly weakens the test for engines that are using double precision, but I think it's close enough.\r\n\r\n* In other instances, I check the size of `btScalar` and set different tolerances based on trial and error to make the tests pass.\r\n\r\n* In the contact_sensor test, the normal had correct magnitude but opposite sign, so I take the absolute value.\r\n\r\nThe tests now pass in a [gazebo-any-devel-vivid jenkins job](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/4/).", "markup": "markdown", "html": "<p>We have built custom debs of bullet 2.82 for trusty that have double precision enabled, but the debs in Ubuntu vivid use single precision. It still works but with less accuracy and with <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/1/\" rel=\"nofollow\">some test failures</a> (note the test names ending in <code>/1</code>). This PR relaxes test expectations to allow them to pass with single-precision bullet.</p>\n<ul>\n<li>\n<p>In several instances where <code>EXPECT_DOUBLE_EQ</code> is used, I just change it to <code>EXPECT_FLOAT_EQ</code> for all physics engines. This slightly weakens the test for engines that are using double precision, but I think it's close enough.</p>\n</li>\n<li>\n<p>In other instances, I check the size of <code>btScalar</code> and set different tolerances based on trial and error to make the tests pass.</p>\n</li>\n<li>\n<p>In the contact_sensor test, the normal had correct magnitude but opposite sign, so I take the absolute value.</p>\n</li>\n</ul>\n<p>The tests now pass in a <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/4/\" rel=\"nofollow\">gazebo-any-devel-vivid jenkins job</a>.</p>", "type": "rendered"}, "title": {"raw": "Relax physics tolerances for single-precision bullet", "markup": "markdown", "html": "<p>Relax physics tolerances for single-precision bullet</p>", "type": "rendered"}}, "type": "pullrequest", "description": "We have built custom debs of bullet 2.82 for trusty that have double precision enabled, but the debs in Ubuntu vivid use single precision. It still works but with less accuracy and with [some test failures](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/1/) (note the test names ending in `/1`). This PR relaxes test expectations to allow them to pass with single-precision bullet.\r\n\r\n* In several instances where `EXPECT_DOUBLE_EQ` is used, I just change it to `EXPECT_FLOAT_EQ` for all physics engines. This slightly weakens the test for engines that are using double precision, but I think it's close enough.\r\n\r\n* In other instances, I check the size of `btScalar` and set different tolerances based on trial and error to make the tests pass.\r\n\r\n* In the contact_sensor test, the normal had correct magnitude but opposite sign, so I take the absolute value.\r\n\r\nThe tests now pass in a [gazebo-any-devel-vivid jenkins job](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/4/).", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1976/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diffstat/osrf/gazebo:7d9645e5b2fd%0D9f4ce9d8855a?from_pullrequest_id=1976"}, "commits": {"href": "data/repositories/osrf/gazebo/pullrequests/1976/commits.json"}, "self": {"href": "data/repositories/osrf/gazebo/pullrequests/1976.json"}, "comments": {"href": "data/repositories/osrf/gazebo/pullrequests/1976/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1976/merge"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1976"}, "activity": {"href": "data/repositories/osrf/gazebo/pullrequests/1976/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:7d9645e5b2fd%0D9f4ce9d8855a?from_pullrequest_id=1976"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1976/approve"}, "statuses": {"href": "data/repositories/osrf/gazebo/pullrequests/1976/statuses_page=1.json"}}, "title": "Relax physics tolerances for single-precision bullet", "close_source_branch": true, "reviewers": [], "id": 1976, "destination": {"commit": {"hash": "9f4ce9d8855a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/9f4ce9d8855a.json"}, "html": {"href": "#!/osrf/gazebo/commits/9f4ce9d8855a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo5"}}, "created_on": "2015-11-03T22:33:07.268296+00:00", "summary": {"raw": "We have built custom debs of bullet 2.82 for trusty that have double precision enabled, but the debs in Ubuntu vivid use single precision. It still works but with less accuracy and with [some test failures](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/1/) (note the test names ending in `/1`). This PR relaxes test expectations to allow them to pass with single-precision bullet.\r\n\r\n* In several instances where `EXPECT_DOUBLE_EQ` is used, I just change it to `EXPECT_FLOAT_EQ` for all physics engines. This slightly weakens the test for engines that are using double precision, but I think it's close enough.\r\n\r\n* In other instances, I check the size of `btScalar` and set different tolerances based on trial and error to make the tests pass.\r\n\r\n* In the contact_sensor test, the normal had correct magnitude but opposite sign, so I take the absolute value.\r\n\r\nThe tests now pass in a [gazebo-any-devel-vivid jenkins job](http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/4/).", "markup": "markdown", "html": "<p>We have built custom debs of bullet 2.82 for trusty that have double precision enabled, but the debs in Ubuntu vivid use single precision. It still works but with less accuracy and with <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/1/\" rel=\"nofollow\">some test failures</a> (note the test names ending in <code>/1</code>). This PR relaxes test expectations to allow them to pass with single-precision bullet.</p>\n<ul>\n<li>\n<p>In several instances where <code>EXPECT_DOUBLE_EQ</code> is used, I just change it to <code>EXPECT_FLOAT_EQ</code> for all physics engines. This slightly weakens the test for engines that are using double precision, but I think it's close enough.</p>\n</li>\n<li>\n<p>In other instances, I check the size of <code>btScalar</code> and set different tolerances based on trial and error to make the tests pass.</p>\n</li>\n<li>\n<p>In the contact_sensor test, the normal had correct magnitude but opposite sign, so I take the absolute value.</p>\n</li>\n</ul>\n<p>The tests now pass in a <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/gazebo-any-devel-vivid-amd64-gpu-intel/4/\" rel=\"nofollow\">gazebo-any-devel-vivid jenkins job</a>.</p>", "type": "rendered"}, "source": {"commit": {"hash": "28d961794f18", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/28d961794f18.json"}, "html": {"href": "#!/osrf/gazebo/commits/28d961794f18"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "bullet_single_5"}}, "comment_count": 6, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2015-11-06T17:57:27.508608+00:00", "type": "participant", "approved": false, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, {"role": "PARTICIPANT", "participated_on": "2015-11-16T16:46:08.737743+00:00", "type": "participant", "approved": true, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, {"role": "PARTICIPANT", "participated_on": "2015-11-13T20:07:30.322729+00:00", "type": "participant", "approved": true, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}], "reason": "", "updated_on": "2015-11-16T17:28:38.319955+00:00", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "merge_commit": {"hash": "7d9645e5b2fd", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/7d9645e5b2fd.json"}, "html": {"href": "#!/osrf/gazebo/commits/7d9645e5b2fd"}}}, "closed_by": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}