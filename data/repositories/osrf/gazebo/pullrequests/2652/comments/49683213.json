{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2652/comments/49683213.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2652/_/diff#comment-49683213"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2652, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2652.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2652"}}, "title": "Added support for tracked vehicles"}, "content": {"raw": "Hey @peci1, \n\ni have used you code to simulate a robot with 2 tracks and 4 flippers in gazebo 7. I modified the plugin, so that the variable \"tracks\" of SimpleTrackedVehiclePlugin can now store 6, instead of 2 LinkPtr's. Also BELT_CATEGORY, ROBOT_CATEGORY and, on the left side, LEFT_CATEGORY will be set on the flippers. Everything works on simple surfaces, but i found some bugs:\n\nIf the robot is driving/rotating e.g. on ramps, std::swap() (used in SimpleTrackedVehiclePlugin::DriveTracks) will be triggered. This causes the friction direction to point in the opposite direction. I have fixed this by setting beltDirection to -beltDirection, if std::swap has been used before. You can see the bug in the following video. The result of frictionDirection will be displayed as markers in rviz, with the length of the calculated value of motion1. If motion1 is not equal to zero, the arrows will become red. Also every contact point on the tracks is shown by a blue sphere. The linear and angular velocity, which i have manually controled with a controller, will be visible in the console: https://www.youtube.com/watch?v=u1lSbLIL9a4 In that example video i'am driving the robot onto aramp, and then just turn. But as you can see, the robot is moving sideways, instead of turning.\n\nThere is also a second bug. When the chassis touches the surface, and the tracks have no contact, the simulation will become really unstable and the robot will fly away. Have you encounterd a similar problem? You can see this in this video (the first bug is already fixed in this video, that's why the robot can now rotate on the ramp): https://www.youtube.com/watch?v=oPy5BFjr4g4", "markup": "markdown", "html": "<p>Hey @peci1, </p>\n<p>i have used you code to simulate a robot with 2 tracks and 4 flippers in gazebo 7. I modified the plugin, so that the variable \"tracks\" of SimpleTrackedVehiclePlugin can now store 6, instead of 2 LinkPtr's. Also BELT_CATEGORY, ROBOT_CATEGORY and, on the left side, LEFT_CATEGORY will be set on the flippers. Everything works on simple surfaces, but i found some bugs:</p>\n<p>If the robot is driving/rotating e.g. on ramps, std::swap() (used in SimpleTrackedVehiclePlugin::DriveTracks) will be triggered. This causes the friction direction to point in the opposite direction. I have fixed this by setting beltDirection to -beltDirection, if std::swap has been used before. You can see the bug in the following video. The result of frictionDirection will be displayed as markers in rviz, with the length of the calculated value of motion1. If motion1 is not equal to zero, the arrows will become red. Also every contact point on the tracks is shown by a blue sphere. The linear and angular velocity, which i have manually controled with a controller, will be visible in the console: <a href=\"https://www.youtube.com/watch?v=u1lSbLIL9a4\" rel=\"nofollow\" class=\"ap-connect-link\">https://www.youtube.com/watch?v=u1lSbLIL9a4</a> In that example video i'am driving the robot onto aramp, and then just turn. But as you can see, the robot is moving sideways, instead of turning.</p>\n<p>There is also a second bug. When the chassis touches the surface, and the tracks have no contact, the simulation will become really unstable and the robot will fly away. Have you encounterd a similar problem? You can see this in this video (the first bug is already fixed in this video, that's why the robot can now rotate on the ramp): <a href=\"https://www.youtube.com/watch?v=oPy5BFjr4g4\" rel=\"nofollow\" class=\"ap-connect-link\">https://www.youtube.com/watch?v=oPy5BFjr4g4</a></p>", "type": "rendered"}, "created_on": "2017-11-15T19:11:36.197020+00:00", "user": {"display_name": "Philip", "uuid": "{9698d1a6-994f-4bd0-ac88-485da498f1e3}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9698d1a6-994f-4bd0-ac88-485da498f1e3%7D"}, "html": {"href": "https://bitbucket.org/%7B9698d1a6-994f-4bd0-ac88-485da498f1e3%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/eff00867f81bd0897d79525a81bc0348d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsP-2.png"}}, "nickname": "Flipse789", "type": "user", "account_id": "557058:abcc4a84-8ee8-413a-adc6-e6c8553b65e1"}, "updated_on": "2017-11-15T19:45:44.056854+00:00", "type": "pullrequest_comment", "id": 49683213}