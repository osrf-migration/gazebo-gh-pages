{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2306/comments/18549224.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2306/_/diff#comment-18549224"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2306, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2306.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2306"}}, "title": "Build plugin libraries as MODULE instead of SHARED"}, "content": {"raw": "Ok, there are questions about why this is necessary, and I'm not sure I have an answer.\n\nI've tested this on OS X and Ubuntu, and declaring plugins as `MODULE` libraries will cause a failure at configure time when trying to link other libraries against them. As an example from the past, the `BreakableJointPlugin` previously inherited from `ForceTorqueSensorPlugin`, which would not be possible if the libraries are declared as `MODULE`s. That design was changed in pull request #2202 to fix the windows build, so that `BreakableJointPlugin` is independent of `ForceTorquePlugin`.\n\nSo the main issue at play appears to be whether plugins should be shared libraries that can link against other plugins. This is currently done in gazebo_ros_pkgs ([gazebo_ros_camera](https://github.com/ros-simulation/gazebo_ros_pkgs/blob/jade-devel/gazebo_plugins/CMakeLists.txt#L178) and others) and possibly in rviz plugins. Requiring plugins to be `MODULE` libraries would break these existing plugins, which is a big reason not to merge this PR.\n\nThe open question is whether plugins could be declared as `SHARED` libraries and linked to each other on windows (since that seemed to be a problem fixed by pull request #2202). If windows truly can't handle that, then the `MODULE` keyword would be a restriction valid behavior in Ubuntu and OS X for the sake of portability with windows.", "markup": "markdown", "html": "<p>Ok, there are questions about why this is necessary, and I'm not sure I have an answer.</p>\n<p>I've tested this on OS X and Ubuntu, and declaring plugins as <code>MODULE</code> libraries will cause a failure at configure time when trying to link other libraries against them. As an example from the past, the <code>BreakableJointPlugin</code> previously inherited from <code>ForceTorqueSensorPlugin</code>, which would not be possible if the libraries are declared as <code>MODULE</code>s. That design was changed in <a href=\"#!/osrf/gazebo/pull-requests/2202/windows_build\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #2202</a> to fix the windows build, so that <code>BreakableJointPlugin</code> is independent of <code>ForceTorquePlugin</code>.</p>\n<p>So the main issue at play appears to be whether plugins should be shared libraries that can link against other plugins. This is currently done in gazebo_ros_pkgs (<a data-is-external-link=\"true\" href=\"https://github.com/ros-simulation/gazebo_ros_pkgs/blob/jade-devel/gazebo_plugins/CMakeLists.txt#L178\" rel=\"nofollow\">gazebo_ros_camera</a> and others) and possibly in rviz plugins. Requiring plugins to be <code>MODULE</code> libraries would break these existing plugins, which is a big reason not to merge this PR.</p>\n<p>The open question is whether plugins could be declared as <code>SHARED</code> libraries and linked to each other on windows (since that seemed to be a problem fixed by <a href=\"#!/osrf/gazebo/pull-requests/2202/windows_build\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #2202</a>). If windows truly can't handle that, then the <code>MODULE</code> keyword would be a restriction valid behavior in Ubuntu and OS X for the sake of portability with windows.</p>", "type": "rendered"}, "created_on": "2016-05-17T00:03:33.714855+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2016-05-17T00:03:33.718978+00:00", "type": "pullrequest_comment", "id": 18549224}