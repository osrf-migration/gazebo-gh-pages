{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/970/comments/1303390.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/970/_/diff#comment-1303390"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 970, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/970.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/970"}}, "title": "Updates to propshop plugin and tweaks to rendering"}, "content": {"raw": "Looks good to me.\n\nJust noticed a minor corner case in gzprop where it fails if you pass a file in the current directory, ie:\n~~~\n$ pwd\n/home/ubuntu/.gazebo/models/pr2\n$ gzprop model.sdf\n/home/ubuntu/bin/gzprop:50:in `mkdir': Permission denied - /meta (Errno::EACCES)\n\tfrom /home/ubuntu/bin/gzprop:50:in `<main>'\n~~~\nIt tries and fails to create a folder named /meta (definitely don't recommend to use sudo).\n\nThe following patch should detect this case and give an appropriate error message:\n~~~\ndiff -r 5560c69c3e56 tools/gzprop\n--- a/tools/gzprop\tMon Feb 24 09:52:43 2014 -0800\n+++ b/tools/gzprop\tTue Feb 25 12:16:39 2014 -0800\n@@ -24,7 +24,7 @@\n   abort(\"\")\n end\n \n-# Get the model directory\n+# Get the model file name\n modelFile = ARGV[0]\n \n modelParts = modelFile.split('/')\n@@ -35,6 +35,11 @@\n   abort(\"Missing model file [#{modelFile}]\")\n end\n \n+# Make sure the file wasn't specified in the current directory\n+if modelDir.empty?\n+  abort(\"Cannot specify file in the current directory\")\n+end\n+\n # Get the name of the model (last part of the directory name)\n modelName = modelParts[-2]\n \n~~~", "markup": "markdown", "html": "<p>Looks good to me.</p>\n<p>Just noticed a minor corner case in gzprop where it fails if you pass a file in the current directory, ie:</p>\n<div class=\"codehilite\"><pre><span></span>$ <span class=\"nb\">pwd</span>\n/home/ubuntu/.gazebo/models/pr2\n$ gzprop model.sdf\n/home/ubuntu/bin/gzprop:50:in <span class=\"sb\">`</span>mkdir<span class=\"s1\">&#39;: Permission denied - /meta (Errno::EACCES)</span>\n<span class=\"s1\">    from /home/ubuntu/bin/gzprop:50:in `&lt;main&gt;&#39;</span>\n</pre></div>\n\n\n<p>It tries and fails to create a folder named /meta (definitely don't recommend to use sudo).</p>\n<p>The following patch should detect this case and give an appropriate error message:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 5560c69c3e56 tools/gzprop</span>\n<span class=\"gd\">--- a/tools/gzprop  Mon Feb 24 09:52:43 2014 -0800</span>\n<span class=\"gi\">+++ b/tools/gzprop  Tue Feb 25 12:16:39 2014 -0800</span>\n<span class=\"gu\">@@ -24,7 +24,7 @@</span>\n   abort(&quot;&quot;)\n end\n\n<span class=\"gd\">-# Get the model directory</span>\n<span class=\"gi\">+# Get the model file name</span>\n modelFile = ARGV[0]\n\n modelParts = modelFile.split(&#39;/&#39;)\n<span class=\"gu\">@@ -35,6 +35,11 @@</span>\n   abort(&quot;Missing model file [#{modelFile}]&quot;)\n end\n\n<span class=\"gi\">+# Make sure the file wasn&#39;t specified in the current directory</span>\n<span class=\"gi\">+if modelDir.empty?</span>\n<span class=\"gi\">+  abort(&quot;Cannot specify file in the current directory&quot;)</span>\n<span class=\"gi\">+end</span>\n<span class=\"gi\">+</span>\n # Get the name of the model (last part of the directory name)\n modelName = modelParts[-2]\n</pre></div>", "type": "rendered"}, "created_on": "2014-02-25T20:19:50.074165+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2014-02-25T20:19:50.083880+00:00", "type": "pullrequest_comment", "id": 1303390}