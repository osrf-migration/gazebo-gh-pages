{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1533/comments/5770709.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1533/_/diff#comment-5770709"}}, "parent": {"id": 5770385, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1533/comments/5770385.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1533/_/diff#comment-5770385"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1533, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1533.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1533"}}, "title": "issue #1523: process selection msgs in qt connection event in GLWidget"}, "content": {"raw": "An inspection of default branch:\n\n```\njackie@pol:~/code/gazebo/gazebo$ rgrep \"~/selection\"\nrendering/Scene.cc:  this->dataPtr->selectionSub = this->dataPtr->node->Subscribe(\"~/selection\",\ngui/GLWidget_TEST.cc:  sub = node->Subscribe(\"~/selection\", &OnSelection, this);\ngui/GLWidget.cc:  this->selectionSub = this->node->Subscribe(\"~/selection\",\ngui/GLWidget.cc:    this->node->Advertise<msgs::Selection>(\"~/selection\");\n```\nThe only class that advertises on `~/selection` is `GLWidget` itself. `Scene` and `GLWidget` both subscribe to `~/selection`. This means that `GLWidget` is publishing to `Scene` and to other `GLWidget`s. This PR differentiates between the topic `GLWidget` publishes to and the topic it subscribes to.\n\nSince nobody else publishes to `~/selection`, nobody needs to publish to `~/selection/server` in this PR.\n\nI believe the reason this line is here is so that an external publisher can affect changes in the selection state by publishing to `~/selection` (or `~/selection/server` with this change). However, it does not appear to be tested in Gazebo (`rgrep ~/selection` in `gazebo/test`, `gazebo/plugins`, `gazebo/examples`). I could potentially add a test for this feature to `GLWidget` in this PR.", "markup": "markdown", "html": "<p>An inspection of default branch:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">jackie</span><span class=\"p\">@</span><span class=\"k\">pol</span><span class=\"o\">:~/</span><span class=\"nt\">code</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">$</span> <span class=\"nt\">rgrep</span> <span class=\"s2\">&quot;~/selection&quot;</span>\n<span class=\"nt\">rendering</span><span class=\"o\">/</span><span class=\"nt\">Scene</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"o\">:</span>  <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">dataPtr-</span><span class=\"o\">&gt;</span><span class=\"nt\">selectionSub</span> <span class=\"o\">=</span> <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">dataPtr-</span><span class=\"o\">&gt;</span><span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Subscribe</span><span class=\"o\">(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">,</span>\n<span class=\"nt\">gui</span><span class=\"o\">/</span><span class=\"nt\">GLWidget_TEST</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"o\">:</span>  <span class=\"nt\">sub</span> <span class=\"o\">=</span> <span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Subscribe</span><span class=\"o\">(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">,</span> <span class=\"o\">&amp;</span><span class=\"nt\">OnSelection</span><span class=\"o\">,</span> <span class=\"nt\">this</span><span class=\"o\">)</span><span class=\"p\">;</span>\n<span class=\"nt\">gui</span><span class=\"o\">/</span><span class=\"nt\">GLWidget</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"o\">:</span>  <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">selectionSub</span> <span class=\"o\">=</span> <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Subscribe</span><span class=\"o\">(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">,</span>\n<span class=\"nt\">gui</span><span class=\"o\">/</span><span class=\"nt\">GLWidget</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"o\">:</span>    <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Advertise</span><span class=\"o\">&lt;</span><span class=\"nt\">msgs</span><span class=\"p\">::</span><span class=\"nd\">Selection</span><span class=\"o\">&gt;(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">);</span>\n</pre></div>\n\n\n<p>The only class that advertises on <code>~/selection</code> is <code>GLWidget</code> itself. <code>Scene</code> and <code>GLWidget</code> both subscribe to <code>~/selection</code>. This means that <code>GLWidget</code> is publishing to <code>Scene</code> and to other <code>GLWidget</code>s. This PR differentiates between the topic <code>GLWidget</code> publishes to and the topic it subscribes to.</p>\n<p>Since nobody else publishes to <code>~/selection</code>, nobody needs to publish to <code>~/selection/server</code> in this PR.</p>\n<p>I believe the reason this line is here is so that an external publisher can affect changes in the selection state by publishing to <code>~/selection</code> (or <code>~/selection/server</code> with this change). However, it does not appear to be tested in Gazebo (<code>rgrep ~/selection</code> in <code>gazebo/test</code>, <code>gazebo/plugins</code>, <code>gazebo/examples</code>). I could potentially add a test for this feature to <code>GLWidget</code> in this PR.</p>", "type": "rendered"}, "created_on": "2015-03-19T19:07:20.224012+00:00", "user": {"display_name": "Jackie K", "uuid": "{e3d60b62-b7c7-4863-b9b9-cdae9f123cec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D"}, "html": {"href": "https://bitbucket.org/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/ea011fa2919d4bd4568b32b440eda779d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-0.png"}}, "nickname": "jacquelinekay", "type": "user", "account_id": "557058:f56c822f-f75c-4665-80f9-6e7764893b9c"}, "updated_on": "2015-03-19T19:07:20.229966+00:00", "type": "pullrequest_comment", "id": 5770709}