{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2712/comments/37178073.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:436111cdb3c5..2a03bae6b852?path=gazebo%2Fgui%2FGuiIface.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2712/_/diff#comment-37178073"}}, "parent": {"id": 37176434, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2712/comments/37176434.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2712/_/diff#comment-37176434"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2712, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2712.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2712"}}, "title": "Fix ABI breakage in gazebo 8.1.0 release (issue #2279)"}, "content": {"raw": "Giving another look and in the presence of this error in your branch, my hypothesis now is that [the adittion of the g_plugins_to_load vector](#!/osrf/gazebo/commits/9be1768#Lgazebo/gui/GuiIface.ccT61) to the class is working as an addition of a private member and thus altering the binary size and breaking the ABI.\n\nIf I made this stupid change (that breaks functionality) the ABI dissapeared:\n\n```\n#!diff\n+++ b/gazebo/gui/GuiIface.cc\tThu May 18 18:28:45 2017 +0200\n@@ -57,9 +57,6 @@\n \n boost::property_tree::ptree g_propTree;\n \n-// Names of all GUI plugins loaded at start. Parsed from command line arguments.\n-std::vector<std::string> g_plugins_to_load;\n-\n using namespace gazebo;\n \n gui::ModelRightMenu *g_modelRightMenu = NULL;\n@@ -188,6 +185,9 @@\n     std::vector<std::string> pp =\n       vm[\"gui-plugin\"].as<std::vector<std::string> >();\n \n+    // Names of all GUI plugins loaded at start. Parsed from command line arguments.\n+    std::vector<std::string> g_plugins_to_load;\n+\n     for (std::vector<std::string>::iterator iter = pp.begin();\n          iter != pp.end(); ++iter)\n     {\n@@ -366,6 +366,8 @@\n             \"Main window's RenderWidget must have been created\");\n \n   // Load each plugin\n+  std::vector<std::string> g_plugins_to_load;\n+  \n   for (auto iter = g_plugins_to_load.begin();\n        iter != g_plugins_to_load.end(); ++iter)\n   {\n``` ", "markup": "markdown", "html": "<p>Giving another look and in the presence of this error in your branch, my hypothesis now is that <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/commits/9be1768#Lgazebo/gui/GuiIface.ccT61\" rel=\"nofollow\">the adittion of the g_plugins_to_load vector</a> to the class is working as an addition of a private member and thus altering the binary size and breaking the ABI.</p>\n<p>If I made this stupid change (that breaks functionality) the ABI dissapeared:</p>\n<div class=\"codehilite language-diff\"><pre><span></span><span class=\"gi\">+++ b/gazebo/gui/GuiIface.cc    Thu May 18 18:28:45 2017 +0200</span>\n<span class=\"gu\">@@ -57,9 +57,6 @@</span>\n\n boost::property_tree::ptree g_propTree;\n\n<span class=\"gd\">-// Names of all GUI plugins loaded at start. Parsed from command line arguments.</span>\n<span class=\"gd\">-std::vector&lt;std::string&gt; g_plugins_to_load;</span>\n<span class=\"gd\">-</span>\n using namespace gazebo;\n\n gui::ModelRightMenu *g_modelRightMenu = NULL;\n<span class=\"gu\">@@ -188,6 +185,9 @@</span>\n     std::vector&lt;std::string&gt; pp =\n       vm[&quot;gui-plugin&quot;].as&lt;std::vector&lt;std::string&gt; &gt;();\n\n<span class=\"gi\">+    // Names of all GUI plugins loaded at start. Parsed from command line arguments.</span>\n<span class=\"gi\">+    std::vector&lt;std::string&gt; g_plugins_to_load;</span>\n<span class=\"gi\">+</span>\n     for (std::vector&lt;std::string&gt;::iterator iter = pp.begin();\n          iter != pp.end(); ++iter)\n     {\n<span class=\"gu\">@@ -366,6 +366,8 @@</span>\n             &quot;Main window&#39;s RenderWidget must have been created&quot;);\n\n   // Load each plugin\n<span class=\"gi\">+  std::vector&lt;std::string&gt; g_plugins_to_load;</span>\n<span class=\"gi\">+  </span>\n   for (auto iter = g_plugins_to_load.begin();\n        iter != g_plugins_to_load.end(); ++iter)\n   {\n</pre></div>", "type": "rendered"}, "created_on": "2017-05-18T16:31:59.271027+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "inline": {"to": null, "from": null, "outdated": false, "path": "gazebo/gui/GuiIface.cc"}, "updated_on": "2017-05-18T16:31:59.273939+00:00", "type": "pullrequest_comment", "id": 37178073}