{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2673/comments/34288399.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2673/_/diff#comment-34288399"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2673, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2673.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2673"}}, "title": "Add random walk support to GaussianNoise"}, "content": {"raw": "![random_walk.png](data/bitbucket.org/repo/jgXqbo/images/529147437-random_walk.png)\n\n\n```\n#!xml\n\n      <sensor name=\"imu_sensor\" type=\"imu\">\n        <pose>0 0 0 3.141593 0 0</pose>\n        <always_on>1</always_on>\n        <update_rate>1000.0</update_rate>\n\t\t<imu>\n\t\t\t<angular_velocity>\n\t\t\t\t<x>\n\t\t\t\t\t<noise type=\"gaussian\">\n\t\t\t\t\t\t<mean>0</mean>\n\t\t\t\t\t\t<density>0.0</density>\n\t\t\t\t\t\t<bias_mean>0.0</bias_mean>\n\t\t\t\t\t\t<bias_stddev>0.0</bias_stddev>\n\t\t\t\t\t\t<walk_density>0.1</walk_density>\n\t\t\t\t\t\t<walk_correlation_time>10</walk_correlation_time>\n\t\t\t\t\t</noise>\n\t\t\t\t</x>\n\t\t\t</angular_velocity>\n\t\t</imu>\n      </sensor>\n\n```\n\n\n# Design\n\n* I'm passing dt into the noise Apply method. This is flexible and allows the calling method to keep track of the time since the last call.\n* I decided to extend the existing Gaussian noise class while keeping backwards compatibility with existing sdf models.\n* For more accurate noise simulation it makes sense to specify noise density instead of std. dev, but for backwards compatibility I allow specifying either one, but not both.  std. dev. = sqrt(noise density / sampling time)\n\n# Tasks\n* Extend GaussianNoise class to support bias random walk and noise density  (DONE)\n* sdformat update for new noise params: https://bitbucket.org/osrf/sdformat/pull-requests/329 (DONE)\n* Add an integration test to check the random walk behavior (DONE)\n* Unit tests (DONE) (all pass)\n* style, total errors found: 0 (DONE)\n\n# Questions\n* branch: I based this on gazebo8. This doesn't break API, just extends sdf. Was this the best choice?\n* sdformat version: How do I set the CI server to use the new sdformat?", "markup": "markdown", "html": "<p><img alt=\"random_walk.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/529147437-random_walk.png\" /></p>\n<div class=\"codehilite language-xml\"><pre><span></span>      <span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;imu_sensor&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;imu&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0 0 0 3.141593 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;always_on&gt;</span>1<span class=\"nt\">&lt;/always_on&gt;</span>\n        <span class=\"nt\">&lt;update_rate&gt;</span>1000.0<span class=\"nt\">&lt;/update_rate&gt;</span>\n        <span class=\"nt\">&lt;imu&gt;</span>\n            <span class=\"nt\">&lt;angular_velocity&gt;</span>\n                <span class=\"nt\">&lt;x&gt;</span>\n                    <span class=\"nt\">&lt;noise</span> <span class=\"na\">type=</span><span class=\"s\">&quot;gaussian&quot;</span><span class=\"nt\">&gt;</span>\n                        <span class=\"nt\">&lt;mean&gt;</span>0<span class=\"nt\">&lt;/mean&gt;</span>\n                        <span class=\"nt\">&lt;density&gt;</span>0.0<span class=\"nt\">&lt;/density&gt;</span>\n                        <span class=\"nt\">&lt;bias_mean&gt;</span>0.0<span class=\"nt\">&lt;/bias_mean&gt;</span>\n                        <span class=\"nt\">&lt;bias_stddev&gt;</span>0.0<span class=\"nt\">&lt;/bias_stddev&gt;</span>\n                        <span class=\"nt\">&lt;walk_density&gt;</span>0.1<span class=\"nt\">&lt;/walk_density&gt;</span>\n                        <span class=\"nt\">&lt;walk_correlation_time&gt;</span>10<span class=\"nt\">&lt;/walk_correlation_time&gt;</span>\n                    <span class=\"nt\">&lt;/noise&gt;</span>\n                <span class=\"nt\">&lt;/x&gt;</span>\n            <span class=\"nt\">&lt;/angular_velocity&gt;</span>\n        <span class=\"nt\">&lt;/imu&gt;</span>\n      <span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>\n\n\n<h1 id=\"markdown-header-design\">Design</h1>\n<ul>\n<li>I'm passing dt into the noise Apply method. This is flexible and allows the calling method to keep track of the time since the last call.</li>\n<li>I decided to extend the existing Gaussian noise class while keeping backwards compatibility with existing sdf models.</li>\n<li>For more accurate noise simulation it makes sense to specify noise density instead of std. dev, but for backwards compatibility I allow specifying either one, but not both.  std. dev. = sqrt(noise density / sampling time)</li>\n</ul>\n<h1 id=\"markdown-header-tasks\">Tasks</h1>\n<ul>\n<li>Extend GaussianNoise class to support bias random walk and noise density  (DONE)</li>\n<li>sdformat update for new noise params: <a href=\"https://bitbucket.org/osrf/sdformat/pull-requests/329\" rel=\"nofollow\" class=\"ap-connect-link\">https://bitbucket.org/osrf/sdformat/pull-requests/329</a> (DONE)</li>\n<li>Add an integration test to check the random walk behavior (DONE)</li>\n<li>Unit tests (DONE) (all pass)</li>\n<li>style, total errors found: 0 (DONE)</li>\n</ul>\n<h1 id=\"markdown-header-questions\">Questions</h1>\n<ul>\n<li>branch: I based this on gazebo8. This doesn't break API, just extends sdf. Was this the best choice?</li>\n<li>sdformat version: How do I set the CI server to use the new sdformat?</li>\n</ul>", "type": "rendered"}, "created_on": "2017-04-01T20:33:38.046855+00:00", "user": {"display_name": "James Goppert", "uuid": "{b618f3e0-62ee-44c4-bc34-e54b9f05b140}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bb618f3e0-62ee-44c4-bc34-e54b9f05b140%7D"}, "html": {"href": "https://bitbucket.org/%7Bb618f3e0-62ee-44c4-bc34-e54b9f05b140%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:169ff364-18d4-4ba3-bf5a-4fd0ab88c331/c1565592-9846-41bd-836a-8421cebab1f4/128"}}, "nickname": "jgoppert", "type": "user", "account_id": "557058:169ff364-18d4-4ba3-bf5a-4fd0ab88c331"}, "updated_on": "2017-04-05T16:49:46.463437+00:00", "type": "pullrequest_comment", "id": 34288399}