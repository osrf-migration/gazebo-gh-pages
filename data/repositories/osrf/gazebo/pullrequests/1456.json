{"rendered": {"description": {"raw": "Some sort of `Add*Force` function is needed to be used with the Apply Force GUI.\r\n\r\nThe current `Link::Add*Force` API is [not very clear](#!/osrf/gazebo/issue/354/setforce-settorque-in-class-odelink-point). Talking to @scpeters, we thought of adding 3 new functions as follows, and eventually deprecating the currently existing ones.\r\n\r\n~~~\r\n      /// \\brief Add a force expressed in the world frame.\r\n      /// \\param[in] _force Direction vector expressed in the world frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the world frame. \r\n      /// It defaults to the world origin.\r\n      public: virtual void AddWorldForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the link frame.\r\n      /// \\param[in] _force Direction vector expressed in the link frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the link frame. \r\n      /// It defaults to the link origin.\r\n      public: virtual void AddLinkForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the CoG (inertia) frame.\r\n      /// \\param[in] _force Direction vector expressed in the CoG frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the CoG frame. It defaults \r\n      /// to the = CoG.\r\n      public: virtual void AddCoGForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n~~~\r\n\r\nThis PR implements one of them, `AddLinkForce`, which is the one needed for the Apply Force GUI. You can try out the GUI on branch [apply_force_dialog](#!/osrf/gazebo/branch/apply_force_dialog) if you want to see the function in action.\r\n\r\nThis PR includes integration tests for the new function. ~~Four~~ ~~Five~~ Six situations are tested, each with a combination of frame poses and application points which hopefully cover most of the possibilities without too much overlap. But it's very much likely that these are very bad test cases... \r\n\r\n~~Below you can see how I expect the cases to be working. xyz are the axes of the world frame (W), link frame (L) and inertial frame (I).~~\r\n\r\n~~The first 4~~ All test cases are passing. ~~But I did some weird stuff to make some tests pass. Still working on fixing test 5. More specifically, in lines [377](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT377) and [383/384](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT383). Having that said, I'm sure there's a lot more weird stuff I'm not aware of.~~", "markup": "markdown", "html": "<p>Some sort of <code>Add*Force</code> function is needed to be used with the Apply Force GUI.</p>\n<p>The current <code>Link::Add*Force</code> API is <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/354/setforce-settorque-in-class-odelink-point\" rel=\"nofollow\">not very clear</a>. Talking to @scpeters, we thought of adding 3 new functions as follows, and eventually deprecating the currently existing ones.</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">origin</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddWorldForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">origin</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddLinkForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"o\">(</span><span class=\"nt\">inertia</span><span class=\"o\">)</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> \n      <span class=\"o\">///</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"o\">=</span> <span class=\"nt\">CoG</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddCoGForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n</pre></div>\n\n\n<p>This PR implements one of them, <code>AddLinkForce</code>, which is the one needed for the Apply Force GUI. You can try out the GUI on branch <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/branch/apply_force_dialog\" rel=\"nofollow\">apply_force_dialog</a> if you want to see the function in action.</p>\n<p>This PR includes integration tests for the new function. <del>Four</del> <del>Five</del> Six situations are tested, each with a combination of frame poses and application points which hopefully cover most of the possibilities without too much overlap. But it's very much likely that these are very bad test cases... </p>\n<p><del>Below you can see how I expect the cases to be working. xyz are the axes of the world frame (W), link frame (L) and inertial frame (I).</del></p>\n<p><del>The first 4</del> All test cases are passing. <del>But I did some weird stuff to make some tests pass. Still working on fixing test 5. More specifically, in lines <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT377\" rel=\"nofollow\">377</a> and <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT383\" rel=\"nofollow\">383/384</a>. Having that said, I'm sure there's a lot more weird stuff I'm not aware of.</del></p>", "type": "rendered"}, "title": {"raw": "Implemented AddLinkForce for ODE with integration tests", "markup": "markdown", "html": "<p>Implemented AddLinkForce for ODE with integration tests</p>", "type": "rendered"}}, "type": "pullrequest", "description": "Some sort of `Add*Force` function is needed to be used with the Apply Force GUI.\r\n\r\nThe current `Link::Add*Force` API is [not very clear](#!/osrf/gazebo/issue/354/setforce-settorque-in-class-odelink-point). Talking to @scpeters, we thought of adding 3 new functions as follows, and eventually deprecating the currently existing ones.\r\n\r\n~~~\r\n      /// \\brief Add a force expressed in the world frame.\r\n      /// \\param[in] _force Direction vector expressed in the world frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the world frame. \r\n      /// It defaults to the world origin.\r\n      public: virtual void AddWorldForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the link frame.\r\n      /// \\param[in] _force Direction vector expressed in the link frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the link frame. \r\n      /// It defaults to the link origin.\r\n      public: virtual void AddLinkForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the CoG (inertia) frame.\r\n      /// \\param[in] _force Direction vector expressed in the CoG frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the CoG frame. It defaults \r\n      /// to the = CoG.\r\n      public: virtual void AddCoGForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n~~~\r\n\r\nThis PR implements one of them, `AddLinkForce`, which is the one needed for the Apply Force GUI. You can try out the GUI on branch [apply_force_dialog](#!/osrf/gazebo/branch/apply_force_dialog) if you want to see the function in action.\r\n\r\nThis PR includes integration tests for the new function. ~~Four~~ ~~Five~~ Six situations are tested, each with a combination of frame poses and application points which hopefully cover most of the possibilities without too much overlap. But it's very much likely that these are very bad test cases... \r\n\r\n~~Below you can see how I expect the cases to be working. xyz are the axes of the world frame (W), link frame (L) and inertial frame (I).~~\r\n\r\n~~The first 4~~ All test cases are passing. ~~But I did some weird stuff to make some tests pass. Still working on fixing test 5. More specifically, in lines [377](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT377) and [383/384](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT383). Having that said, I'm sure there's a lot more weird stuff I'm not aware of.~~", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1456/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diffstat/osrf/gazebo:05a8d361e38b%0Dcb9a0a1d0a99?from_pullrequest_id=1456"}, "commits": {"href": "data/repositories/osrf/gazebo/pullrequests/1456/commits.json"}, "self": {"href": "data/repositories/osrf/gazebo/pullrequests/1456.json"}, "comments": {"href": "data/repositories/osrf/gazebo/pullrequests/1456/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1456/merge"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1456"}, "activity": {"href": "data/repositories/osrf/gazebo/pullrequests/1456/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:05a8d361e38b%0Dcb9a0a1d0a99?from_pullrequest_id=1456"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/pullrequests/1456/approve"}, "statuses": {"href": "data/repositories/osrf/gazebo/pullrequests/1456/statuses_page=1.json"}}, "title": "Implemented AddLinkForce for ODE with integration tests", "close_source_branch": true, "reviewers": [{"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, {"display_name": "Silvio Traversaro", "uuid": "{34f404cb-5642-4f27-a032-e04c7143d776}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D"}, "html": {"href": "https://bitbucket.org/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6/578caaa1-056c-45a2-8bf9-bee94c3bebef/128"}}, "nickname": "traversaro", "type": "user", "account_id": "557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6"}], "id": 1456, "destination": {"commit": {"hash": "cb9a0a1d0a99", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/cb9a0a1d0a99.json"}, "html": {"href": "#!/osrf/gazebo/commits/cb9a0a1d0a99"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "default"}}, "created_on": "2015-02-25T20:10:39.517887+00:00", "summary": {"raw": "Some sort of `Add*Force` function is needed to be used with the Apply Force GUI.\r\n\r\nThe current `Link::Add*Force` API is [not very clear](#!/osrf/gazebo/issue/354/setforce-settorque-in-class-odelink-point). Talking to @scpeters, we thought of adding 3 new functions as follows, and eventually deprecating the currently existing ones.\r\n\r\n~~~\r\n      /// \\brief Add a force expressed in the world frame.\r\n      /// \\param[in] _force Direction vector expressed in the world frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the world frame. \r\n      /// It defaults to the world origin.\r\n      public: virtual void AddWorldForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the link frame.\r\n      /// \\param[in] _force Direction vector expressed in the link frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the link frame. \r\n      /// It defaults to the link origin.\r\n      public: virtual void AddLinkForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n\r\n      /// \\brief Add a force expressed in the CoG (inertia) frame.\r\n      /// \\param[in] _force Direction vector expressed in the CoG frame. \r\n      /// Each component corresponds to the force which will be added in that axis.\r\n      /// \\param[in] _offset Offset position expressed in the CoG frame. It defaults \r\n      /// to the = CoG.\r\n      public: virtual void AddCoGForce(const math::Vector3 &_force,\r\n          const math::Vector3 &_offset = math::Vector3::Zero) = 0;\r\n~~~\r\n\r\nThis PR implements one of them, `AddLinkForce`, which is the one needed for the Apply Force GUI. You can try out the GUI on branch [apply_force_dialog](#!/osrf/gazebo/branch/apply_force_dialog) if you want to see the function in action.\r\n\r\nThis PR includes integration tests for the new function. ~~Four~~ ~~Five~~ Six situations are tested, each with a combination of frame poses and application points which hopefully cover most of the possibilities without too much overlap. But it's very much likely that these are very bad test cases... \r\n\r\n~~Below you can see how I expect the cases to be working. xyz are the axes of the world frame (W), link frame (L) and inertial frame (I).~~\r\n\r\n~~The first 4~~ All test cases are passing. ~~But I did some weird stuff to make some tests pass. Still working on fixing test 5. More specifically, in lines [377](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT377) and [383/384](#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT383). Having that said, I'm sure there's a lot more weird stuff I'm not aware of.~~", "markup": "markdown", "html": "<p>Some sort of <code>Add*Force</code> function is needed to be used with the Apply Force GUI.</p>\n<p>The current <code>Link::Add*Force</code> API is <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/issue/354/setforce-settorque-in-class-odelink-point\" rel=\"nofollow\">not very clear</a>. Talking to @scpeters, we thought of adding 3 new functions as follows, and eventually deprecating the currently existing ones.</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">world</span> <span class=\"nt\">origin</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddWorldForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">link</span> <span class=\"nt\">origin</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddLinkForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">brief</span> <span class=\"nt\">Add</span> <span class=\"nt\">a</span> <span class=\"nt\">force</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"o\">(</span><span class=\"nt\">inertia</span><span class=\"o\">)</span> <span class=\"nt\">frame</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_force</span> <span class=\"nt\">Direction</span> <span class=\"nt\">vector</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> \n      <span class=\"o\">///</span> <span class=\"nt\">Each</span> <span class=\"nt\">component</span> <span class=\"nt\">corresponds</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">force</span> <span class=\"nt\">which</span> <span class=\"nt\">will</span> <span class=\"nt\">be</span> <span class=\"nt\">added</span> <span class=\"nt\">in</span> <span class=\"nt\">that</span> <span class=\"nt\">axis</span><span class=\"o\">.</span>\n      <span class=\"o\">///</span> <span class=\"err\">\\</span><span class=\"nt\">param</span><span class=\"cp\">[</span><span class=\"k\">in</span><span class=\"cp\">]</span> <span class=\"nt\">_offset</span> <span class=\"nt\">Offset</span> <span class=\"nt\">position</span> <span class=\"nt\">expressed</span> <span class=\"nt\">in</span> <span class=\"nt\">the</span> <span class=\"nt\">CoG</span> <span class=\"nt\">frame</span><span class=\"o\">.</span> <span class=\"nt\">It</span> <span class=\"nt\">defaults</span> \n      <span class=\"o\">///</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"o\">=</span> <span class=\"nt\">CoG</span><span class=\"o\">.</span>\n      <span class=\"nt\">public</span><span class=\"o\">:</span> <span class=\"nt\">virtual</span> <span class=\"nt\">void</span> <span class=\"nt\">AddCoGForce</span><span class=\"o\">(</span><span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_force</span><span class=\"o\">,</span>\n          <span class=\"nt\">const</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span> <span class=\"o\">&amp;</span><span class=\"nt\">_offset</span> <span class=\"o\">=</span> <span class=\"nt\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3</span><span class=\"p\">::</span><span class=\"nd\">Zero</span><span class=\"o\">)</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"o\">;</span>\n</pre></div>\n\n\n<p>This PR implements one of them, <code>AddLinkForce</code>, which is the one needed for the Apply Force GUI. You can try out the GUI on branch <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/branch/apply_force_dialog\" rel=\"nofollow\">apply_force_dialog</a> if you want to see the function in action.</p>\n<p>This PR includes integration tests for the new function. <del>Four</del> <del>Five</del> Six situations are tested, each with a combination of frame poses and application points which hopefully cover most of the possibilities without too much overlap. But it's very much likely that these are very bad test cases... </p>\n<p><del>Below you can see how I expect the cases to be working. xyz are the axes of the world frame (W), link frame (L) and inertial frame (I).</del></p>\n<p><del>The first 4</del> All test cases are passing. <del>But I did some weird stuff to make some tests pass. Still working on fixing test 5. More specifically, in lines <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT377\" rel=\"nofollow\">377</a> and <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-request/1456/implemented-addlinkforce-for-ode-with/diff#Ltest/integration/physics_link.ccT383\" rel=\"nofollow\">383/384</a>. Having that said, I'm sure there's a lot more weird stuff I'm not aware of.</del></p>", "type": "rendered"}, "source": {"commit": {"hash": "072e0cc030d1", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/072e0cc030d1.json"}, "html": {"href": "#!/osrf/gazebo/commits/072e0cc030d1"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "add_XXX_force"}}, "comment_count": 72, "state": "MERGED", "task_count": 0, "participants": [{"role": "REVIEWER", "participated_on": "2015-03-11T00:17:35.007909+00:00", "type": "participant", "approved": true, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, {"role": "REVIEWER", "participated_on": "2015-03-09T23:34:08.554767+00:00", "type": "participant", "approved": true, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, {"role": "REVIEWER", "participated_on": "2015-02-27T22:40:11.919066+00:00", "type": "participant", "approved": false, "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}}, {"role": "PARTICIPANT", "participated_on": "2015-03-09T22:50:01.685363+00:00", "type": "participant", "approved": false, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, {"role": "REVIEWER", "participated_on": "2015-03-10T00:06:47.176052+00:00", "type": "participant", "approved": false, "user": {"display_name": "Silvio Traversaro", "uuid": "{34f404cb-5642-4f27-a032-e04c7143d776}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D"}, "html": {"href": "https://bitbucket.org/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6/578caaa1-056c-45a2-8bf9-bee94c3bebef/128"}}, "nickname": "traversaro", "type": "user", "account_id": "557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6"}}], "reason": "", "updated_on": "2015-03-11T01:19:15.668575+00:00", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "merge_commit": {"hash": "05a8d361e38b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/05a8d361e38b.json"}, "html": {"href": "#!/osrf/gazebo/commits/05a8d361e38b"}}}, "closed_by": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}