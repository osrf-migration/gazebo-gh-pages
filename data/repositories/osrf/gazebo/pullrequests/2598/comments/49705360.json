{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2598/comments/49705360.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2598/_/diff#comment-49705360"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2598, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2598.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2598"}}, "title": "Fix2111"}, "content": {"raw": "I read through all the comments and try to find a workaround that could take both cases (zero velocity or not) carefully.   \nBased on the existing function name and documentation: `SetPositionMaximal` and `SetPosition` should only set the positions of  \nthe child links of the joint, and leave the velocity as it is, although in some cases the preserved velocity doesn't make sense any more.  \n\nIt should be the users' responsibility to `zero` the velocity, or `set` the velocity to some other values. We could provide such APIs, such as `SetVelocityRelativeToFrame()`   \nIn this case, I would prefer the fix by Peter here [3dd9114](https://bitbucket.org/pchorak/gazebo/commits/3dd9114d6a53a14646b1b1191ac2fc24e74537b9?at=joint_set_position_moving)     \n\nIf we accept the above commit: (1) update the documentation of  `SetPosition` such that users are clear that this set position only and doesn't affect `twist / velocity` at all   \n(2)  `MoveFrame` will be unused in the existing `gazebo` repo.   \nHowever, this fix might break some users' code who depends on the default behavior of `SetPosition` to zero the velocity (although I guess most users probably are not aware that we    \nset the velocity to zero, unless they read the source code and they probably are not depending on this too much, but this is just a guess).  Anyway, It is trivial to zero the velocity after calling a function.  \nTherefore, I tend to vote for this fix.   \n\nAnother approach is proposed by Grey, where we add a new flag `preserve_world_velocity`, this might cause inconsistent behaviors for different physics engines, as covered above.  \nBut this fix would guarantee the legacy behaviors.    \n", "markup": "markdown", "html": "<p>I read through all the comments and try to find a workaround that could take both cases (zero velocity or not) carefully. <br />\nBased on the existing function name and documentation: <code>SetPositionMaximal</code> and <code>SetPosition</code> should only set the positions of<br />\nthe child links of the joint, and leave the velocity as it is, although in some cases the preserved velocity doesn't make sense any more.  </p>\n<p>It should be the users' responsibility to <code>zero</code> the velocity, or <code>set</code> the velocity to some other values. We could provide such APIs, such as <code>SetVelocityRelativeToFrame()</code> <br />\nIn this case, I would prefer the fix by Peter here <a data-is-external-link=\"true\" href=\"https://bitbucket.org/pchorak/gazebo/commits/3dd9114d6a53a14646b1b1191ac2fc24e74537b9?at=joint_set_position_moving\" rel=\"nofollow\">3dd9114</a>     </p>\n<p>If we accept the above commit: (1) update the documentation of  <code>SetPosition</code> such that users are clear that this set position only and doesn't affect <code>twist / velocity</code> at all <br />\n(2)  <code>MoveFrame</code> will be unused in the existing <code>gazebo</code> repo. <br />\nHowever, this fix might break some users' code who depends on the default behavior of <code>SetPosition</code> to zero the velocity (although I guess most users probably are not aware that we  <br />\nset the velocity to zero, unless they read the source code and they probably are not depending on this too much, but this is just a guess).  Anyway, It is trivial to zero the velocity after calling a function.<br />\nTherefore, I tend to vote for this fix.   </p>\n<p>Another approach is proposed by Grey, where we add a new flag <code>preserve_world_velocity</code>, this might cause inconsistent behaviors for different physics engines, as covered above.<br />\nBut this fix would guarantee the legacy behaviors.    </p>", "type": "rendered"}, "created_on": "2017-11-16T01:02:52.587975+00:00", "user": {"display_name": "Ying Lu", "uuid": "{11ec131e-4af6-4228-beaf-167b1c8d1c2c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D"}, "html": {"href": "https://bitbucket.org/%7B11ec131e-4af6-4228-beaf-167b1c8d1c2c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:659bfe31-d941-44f5-aa6d-00058b070ea8/c88d5925-8a09-40c7-8684-c02aeafe0f59/128"}}, "nickname": "rosebudflyaway", "type": "user", "account_id": "557058:659bfe31-d941-44f5-aa6d-00058b070ea8"}, "updated_on": "2017-11-16T01:02:52.590171+00:00", "type": "pullrequest_comment", "id": 49705360}