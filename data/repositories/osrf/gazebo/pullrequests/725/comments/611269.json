{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/725/comments/611269.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/725/_/diff#comment-611269"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 725, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/725.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/725"}}, "title": "Temporary fix for #848 (failing test)"}, "content": {"raw": "Not really critical and mostly for fun, but what about exposing libbullet version to the compiler and use it for the check?\n\n```\n#!diff\ndiff -r 56464db1d9b8 cmake/SearchForStuff.cmake\n--- a/cmake/SearchForStuff.cmake\tThu Sep 19 07:43:56 2013 -0700\n+++ b/cmake/SearchForStuff.cmake\tThu Sep 26 09:29:52 2013 -0700\n@@ -128,6 +128,7 @@\n   pkg_check_modules(BULLET bullet>=2.81)\n   if (BULLET_FOUND)\n     set (HAVE_BULLET TRUE)\n+    add_definitions ( -DLIBBULLET_VERSION=${BULLET_VERSION} )\n   else()\n     set (HAVE_BULLET FALSE)\n   endif()\ndiff -r 56464db1d9b8 test/integration/physics.cc\n--- a/test/integration/physics.cc\tThu Sep 19 07:43:56 2013 -0700\n+++ b/test/integration/physics.cc\tThu Sep 26 09:29:52 2013 -0700\n@@ -278,8 +278,11 @@\n       // Check that model is resting on ground\n       pose1 = model->GetWorldPose();\n       x0 = modelPos[name].x;\n-      EXPECT_NEAR(pose1.pos.x, x0, PHYSICS_TOL);\n-      EXPECT_NEAR(pose1.pos.y, 0, PHYSICS_TOL);\n+      if (! (_physicsEngine == \"bullet\" && LIBBULLET_VERSION < 2.82))\n+      {\n+        EXPECT_NEAR(pose1.pos.x, x0, PHYSICS_TOL);\n+        EXPECT_NEAR(pose1.pos.y, 0, PHYSICS_TOL);\n+      }\n \n       // debug\n       // if (physics->GetType()  == \"bullet\")\n```", "markup": "markdown", "html": "<p>Not really critical and mostly for fun, but what about exposing libbullet version to the compiler and use it for the check?</p>\n<div class=\"codehilite language-diff\"><pre><span></span><span class=\"gh\">diff -r 56464db1d9b8 cmake/SearchForStuff.cmake</span>\n<span class=\"gd\">--- a/cmake/SearchForStuff.cmake    Thu Sep 19 07:43:56 2013 -0700</span>\n<span class=\"gi\">+++ b/cmake/SearchForStuff.cmake    Thu Sep 26 09:29:52 2013 -0700</span>\n<span class=\"gu\">@@ -128,6 +128,7 @@</span>\n   pkg_check_modules(BULLET bullet&gt;=2.81)\n   if (BULLET_FOUND)\n     set (HAVE_BULLET TRUE)\n<span class=\"gi\">+    add_definitions ( -DLIBBULLET_VERSION=${BULLET_VERSION} )</span>\n   else()\n     set (HAVE_BULLET FALSE)\n   endif()\n<span class=\"gh\">diff -r 56464db1d9b8 test/integration/physics.cc</span>\n<span class=\"gd\">--- a/test/integration/physics.cc   Thu Sep 19 07:43:56 2013 -0700</span>\n<span class=\"gi\">+++ b/test/integration/physics.cc   Thu Sep 26 09:29:52 2013 -0700</span>\n<span class=\"gu\">@@ -278,8 +278,11 @@</span>\n       // Check that model is resting on ground\n       pose1 = model-&gt;GetWorldPose();\n       x0 = modelPos[name].x;\n<span class=\"gd\">-      EXPECT_NEAR(pose1.pos.x, x0, PHYSICS_TOL);</span>\n<span class=\"gd\">-      EXPECT_NEAR(pose1.pos.y, 0, PHYSICS_TOL);</span>\n<span class=\"gi\">+      if (! (_physicsEngine == &quot;bullet&quot; &amp;&amp; LIBBULLET_VERSION &lt; 2.82))</span>\n<span class=\"gi\">+      {</span>\n<span class=\"gi\">+        EXPECT_NEAR(pose1.pos.x, x0, PHYSICS_TOL);</span>\n<span class=\"gi\">+        EXPECT_NEAR(pose1.pos.y, 0, PHYSICS_TOL);</span>\n<span class=\"gi\">+      }</span>\n\n       // debug\n       // if (physics-&gt;GetType()  == &quot;bullet&quot;)\n</pre></div>", "type": "rendered"}, "created_on": "2013-09-26T16:45:03.189759+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": "2013-09-26T16:45:03.225255+00:00", "type": "pullrequest_comment", "id": 611269}