{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2805/comments/49591633.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2805/_/diff#comment-49591633"}}, "parent": {"id": 49344188, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2805/comments/49344188.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2805/_/diff#comment-49344188"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2805, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2805.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2805"}}, "title": "Shadow improvements"}, "content": {"raw": "thanks for fixing it. I'm running it in a loop to see if I can reproduce that failure in NameCollision\n\nin the meantime, I am seeing a seg-fault after the end of `UNIT_Console_TEST`\n\n~~~\n[       OK ] Console_TEST.ColorErr (0 ms)\n[----------] 13 tests from Console_TEST (4 ms total)\n\n[----------] Global test environment tear-down\n[==========] 13 tests from 1 test case ran. (4 ms total)\n[  PASSED  ] 13 tests.\n[Thread 0x7fffd7753700 (LWP 5141) exited]\n\nThread 1 \"UNIT_Console_TE\" received signal SIGSEGV, Segmentation fault.\nstd::basic_ofstream<char, std::char_traits<char> >::close (this=0x6a6ee0) at /usr/include/c++/5/fstream:803\n803\t\t  this->setstate(ios_base::failbit);\n(gdb) bt\n#0  std::basic_ofstream<char, std::char_traits<char> >::close (this=0x6a6ee0) at /usr/include/c++/5/fstream:803\n#1  gazebo::common::FileLogger::Buffer::~Buffer (this=0x6a3670, __in_chrg=<optimized out>) at /data_fast/scpeters/ws/gazebo7/src/gazebo/gazebo/common/Console.cc:286\n#2  0x00007ffff7b3fe09 in gazebo::common::FileLogger::Buffer::~Buffer (this=0x6a3670, __in_chrg=<optimized out>) at /data_fast/scpeters/ws/gazebo7/src/gazebo/gazebo/common/Console.cc:292\n#3  0x00007ffff7b3f95f in gazebo::common::FileLogger::~FileLogger (this=0x7ffff7dd5680 <gazebo::common::Console::log>, __in_chrg=<optimized out>, __vtt_parm=<optimized out>) at /data_fast/scpeters/ws/gazebo7/src/gazebo/gazebo/common/Console.cc:156\n#4  0x00007ffff6d8536a in __cxa_finalize (d=0x7ffff7dd4d38) at cxa_finalize.c:56\n#5  0x00007ffff7b0c393 in __do_global_dtors_aux () from /data_fast/scpeters/ws/gazebo7/build/gazebo/gazebo/common/libgazebo_common.so.7\n#6  0x00007fffffffdbf0 in ?? ()\n#7  0x00007ffff7de7de7 in _dl_fini () at dl-fini.c:235\nBacktrace stopped: frame did not save the PC\n~~~", "markup": "markdown", "html": "<p>thanks for fixing it. I'm running it in a loop to see if I can reproduce that failure in NameCollision</p>\n<p>in the meantime, I am seeing a seg-fault after the end of <code>UNIT_Console_TEST</code></p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">[</span>       <span class=\"nx\">OK</span> <span class=\"cp\">]</span> <span class=\"nt\">Console_TEST</span><span class=\"p\">.</span><span class=\"nc\">ColorErr</span> <span class=\"o\">(</span><span class=\"nt\">0</span> <span class=\"nt\">ms</span><span class=\"o\">)</span>\n<span class=\"cp\">[</span><span class=\"o\">----------</span><span class=\"cp\">]</span> <span class=\"nt\">13</span> <span class=\"nt\">tests</span> <span class=\"nt\">from</span> <span class=\"nt\">Console_TEST</span> <span class=\"o\">(</span><span class=\"nt\">4</span> <span class=\"nt\">ms</span> <span class=\"nt\">total</span><span class=\"o\">)</span>\n\n<span class=\"cp\">[</span><span class=\"o\">----------</span><span class=\"cp\">]</span> <span class=\"nt\">Global</span> <span class=\"nt\">test</span> <span class=\"nt\">environment</span> <span class=\"nt\">tear-down</span>\n<span class=\"cp\">[</span><span class=\"o\">==========</span><span class=\"cp\">]</span> <span class=\"nt\">13</span> <span class=\"nt\">tests</span> <span class=\"nt\">from</span> <span class=\"nt\">1</span> <span class=\"nt\">test</span> <span class=\"nt\">case</span> <span class=\"nt\">ran</span><span class=\"o\">.</span> <span class=\"o\">(</span><span class=\"nt\">4</span> <span class=\"nt\">ms</span> <span class=\"nt\">total</span><span class=\"o\">)</span>\n<span class=\"cp\">[</span>  <span class=\"nx\">PASSED</span>  <span class=\"cp\">]</span> <span class=\"nt\">13</span> <span class=\"nt\">tests</span><span class=\"o\">.</span>\n<span class=\"cp\">[</span><span class=\"k\">Thread</span> <span class=\"mh\">0x7fffd7753700</span> <span class=\"p\">(</span><span class=\"nx\">LWP</span> <span class=\"mi\">5141</span><span class=\"p\">)</span> <span class=\"nx\">exited</span><span class=\"cp\">]</span>\n\n<span class=\"nt\">Thread</span> <span class=\"nt\">1</span> <span class=\"s2\">&quot;UNIT_Console_TE&quot;</span> <span class=\"nt\">received</span> <span class=\"nt\">signal</span> <span class=\"nt\">SIGSEGV</span><span class=\"o\">,</span> <span class=\"nt\">Segmentation</span> <span class=\"nt\">fault</span><span class=\"o\">.</span>\n<span class=\"nt\">std</span><span class=\"p\">::</span><span class=\"nd\">basic_ofstream</span><span class=\"o\">&lt;</span><span class=\"nt\">char</span><span class=\"o\">,</span> <span class=\"nt\">std</span><span class=\"p\">::</span><span class=\"nd\">char_traits</span><span class=\"o\">&lt;</span><span class=\"nt\">char</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">close</span> <span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x6a6ee0</span><span class=\"o\">)</span> <span class=\"nt\">at</span> <span class=\"o\">/</span><span class=\"nt\">usr</span><span class=\"o\">/</span><span class=\"nt\">include</span><span class=\"o\">/</span><span class=\"nt\">c</span><span class=\"o\">++/</span><span class=\"nt\">5</span><span class=\"o\">/</span><span class=\"nt\">fstream</span><span class=\"p\">:</span><span class=\"nd\">803</span>\n<span class=\"nt\">803</span>       <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">setstate</span><span class=\"o\">(</span><span class=\"nt\">ios_base</span><span class=\"p\">::</span><span class=\"nd\">failbit</span><span class=\"o\">);</span>\n<span class=\"o\">(</span><span class=\"nt\">gdb</span><span class=\"o\">)</span> <span class=\"nt\">bt</span>\n<span class=\"p\">#</span><span class=\"nn\">0</span>  <span class=\"nt\">std</span><span class=\"p\">::</span><span class=\"nd\">basic_ofstream</span><span class=\"o\">&lt;</span><span class=\"nt\">char</span><span class=\"o\">,</span> <span class=\"nt\">std</span><span class=\"p\">::</span><span class=\"nd\">char_traits</span><span class=\"o\">&lt;</span><span class=\"nt\">char</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">close</span> <span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x6a6ee0</span><span class=\"o\">)</span> <span class=\"nt\">at</span> <span class=\"o\">/</span><span class=\"nt\">usr</span><span class=\"o\">/</span><span class=\"nt\">include</span><span class=\"o\">/</span><span class=\"nt\">c</span><span class=\"o\">++/</span><span class=\"nt\">5</span><span class=\"o\">/</span><span class=\"nt\">fstream</span><span class=\"p\">:</span><span class=\"nd\">803</span>\n<span class=\"p\">#</span><span class=\"nn\">1</span>  <span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">common</span><span class=\"p\">::</span><span class=\"nd\">FileLogger</span><span class=\"p\">::</span><span class=\"nd\">Buffer</span><span class=\"o\">::~</span><span class=\"nt\">Buffer</span> <span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x6a3670</span><span class=\"o\">,</span> <span class=\"nt\">__in_chrg</span><span class=\"o\">=&lt;</span><span class=\"nt\">optimized</span> <span class=\"nt\">out</span><span class=\"o\">&gt;)</span> <span class=\"nt\">at</span> <span class=\"o\">/</span><span class=\"nt\">data_fast</span><span class=\"o\">/</span><span class=\"nt\">scpeters</span><span class=\"o\">/</span><span class=\"nt\">ws</span><span class=\"o\">/</span><span class=\"nt\">gazebo7</span><span class=\"o\">/</span><span class=\"nt\">src</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">common</span><span class=\"o\">/</span><span class=\"nt\">Console</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"p\">:</span><span class=\"nd\">286</span>\n<span class=\"p\">#</span><span class=\"nn\">2</span>  <span class=\"nt\">0x00007ffff7b3fe09</span> <span class=\"nt\">in</span> <span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">common</span><span class=\"p\">::</span><span class=\"nd\">FileLogger</span><span class=\"p\">::</span><span class=\"nd\">Buffer</span><span class=\"o\">::~</span><span class=\"nt\">Buffer</span> <span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x6a3670</span><span class=\"o\">,</span> <span class=\"nt\">__in_chrg</span><span class=\"o\">=&lt;</span><span class=\"nt\">optimized</span> <span class=\"nt\">out</span><span class=\"o\">&gt;)</span> <span class=\"nt\">at</span> <span class=\"o\">/</span><span class=\"nt\">data_fast</span><span class=\"o\">/</span><span class=\"nt\">scpeters</span><span class=\"o\">/</span><span class=\"nt\">ws</span><span class=\"o\">/</span><span class=\"nt\">gazebo7</span><span class=\"o\">/</span><span class=\"nt\">src</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">common</span><span class=\"o\">/</span><span class=\"nt\">Console</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"p\">:</span><span class=\"nd\">292</span>\n<span class=\"p\">#</span><span class=\"nn\">3</span>  <span class=\"nt\">0x00007ffff7b3f95f</span> <span class=\"nt\">in</span> <span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">common</span><span class=\"p\">::</span><span class=\"nd\">FileLogger</span><span class=\"o\">::~</span><span class=\"nt\">FileLogger</span> <span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x7ffff7dd5680</span> <span class=\"o\">&lt;</span><span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">common</span><span class=\"p\">::</span><span class=\"nd\">Console</span><span class=\"p\">::</span><span class=\"nd\">log</span><span class=\"o\">&gt;,</span> <span class=\"nt\">__in_chrg</span><span class=\"o\">=&lt;</span><span class=\"nt\">optimized</span> <span class=\"nt\">out</span><span class=\"o\">&gt;,</span> <span class=\"nt\">__vtt_parm</span><span class=\"o\">=&lt;</span><span class=\"nt\">optimized</span> <span class=\"nt\">out</span><span class=\"o\">&gt;)</span> <span class=\"nt\">at</span> <span class=\"o\">/</span><span class=\"nt\">data_fast</span><span class=\"o\">/</span><span class=\"nt\">scpeters</span><span class=\"o\">/</span><span class=\"nt\">ws</span><span class=\"o\">/</span><span class=\"nt\">gazebo7</span><span class=\"o\">/</span><span class=\"nt\">src</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">common</span><span class=\"o\">/</span><span class=\"nt\">Console</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"p\">:</span><span class=\"nd\">156</span>\n<span class=\"p\">#</span><span class=\"nn\">4</span>  <span class=\"nt\">0x00007ffff6d8536a</span> <span class=\"nt\">in</span> <span class=\"nt\">__cxa_finalize</span> <span class=\"o\">(</span><span class=\"nt\">d</span><span class=\"o\">=</span><span class=\"nt\">0x7ffff7dd4d38</span><span class=\"o\">)</span> <span class=\"nt\">at</span> <span class=\"nt\">cxa_finalize</span><span class=\"p\">.</span><span class=\"nc\">c</span><span class=\"p\">:</span><span class=\"nd\">56</span>\n<span class=\"p\">#</span><span class=\"nn\">5</span>  <span class=\"nt\">0x00007ffff7b0c393</span> <span class=\"nt\">in</span> <span class=\"nt\">__do_global_dtors_aux</span> <span class=\"o\">()</span> <span class=\"nt\">from</span> <span class=\"o\">/</span><span class=\"nt\">data_fast</span><span class=\"o\">/</span><span class=\"nt\">scpeters</span><span class=\"o\">/</span><span class=\"nt\">ws</span><span class=\"o\">/</span><span class=\"nt\">gazebo7</span><span class=\"o\">/</span><span class=\"nt\">build</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">gazebo</span><span class=\"o\">/</span><span class=\"nt\">common</span><span class=\"o\">/</span><span class=\"nt\">libgazebo_common</span><span class=\"p\">.</span><span class=\"nc\">so</span><span class=\"p\">.</span><span class=\"nc\">7</span>\n<span class=\"p\">#</span><span class=\"nn\">6</span>  <span class=\"nt\">0x00007fffffffdbf0</span> <span class=\"nt\">in</span> <span class=\"o\">??</span> <span class=\"o\">()</span>\n<span class=\"p\">#</span><span class=\"nn\">7</span>  <span class=\"nt\">0x00007ffff7de7de7</span> <span class=\"nt\">in</span> <span class=\"nt\">_dl_fini</span> <span class=\"o\">()</span> <span class=\"nt\">at</span> <span class=\"nt\">dl-fini</span><span class=\"p\">.</span><span class=\"nc\">c</span><span class=\"p\">:</span><span class=\"nd\">235</span>\n<span class=\"nt\">Backtrace</span> <span class=\"nt\">stopped</span><span class=\"o\">:</span> <span class=\"nt\">frame</span> <span class=\"nt\">did</span> <span class=\"nt\">not</span> <span class=\"nt\">save</span> <span class=\"nt\">the</span> <span class=\"nt\">PC</span>\n</pre></div>", "type": "rendered"}, "created_on": "2017-11-15T01:15:29.201488+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-11-15T01:15:29.203588+00:00", "type": "pullrequest_comment", "id": 49591633}