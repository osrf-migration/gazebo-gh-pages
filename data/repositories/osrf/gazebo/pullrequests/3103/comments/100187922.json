{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3103/comments/100187922.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3103/_/diff#comment-100187922"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 3103, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/3103.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/3103"}}, "title": "Fix race conditions in Master::ProcessMessage and Publisher::OnPublishComplete"}, "content": {"raw": "One of the jenkins builds now has a different backtrace in `gzTest.Model` that implicates `gazebo::transport::Publisher::OnPublishComplete`:\n\n* https://build.osrfoundation.org/job/gazebo-ci-pr_any-xenial-amd64-gpu-nvidia/834/testReport/junit/(root)/gzTest/Model/\n\n~~~\n327: [ RUN      ] gzTest.Model\n327: [Msg] Waiting for master.\n327: [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n327: [Msg] Publicized address: 172.17.0.2\n327: tools/gz_TEST.cc:439: Failure\n327: Value of: \"Unable to get info on model[my_box_0] in the world[default]\\n\"\n327: Expected: modelInfo\n327: Which is: \"gz: /usr/include/boost/thread/pthread/mutex.hpp:111: boost::mutex::~mutex(): Assertion `!res' failed.\\nUnable to get info on model[my_box_0] in the world[default]\\nAborted (core dumped)\\n\"\n*** Error in `gzserver': double free or corruption (fasttop): 0x00007f9d4c639900 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f9df7ae87e5]\n/lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7f9df7af137a]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f9df7af553c]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport9Publisher17OnPublishCompleteEj+0xb6)[0x7f9df68f8c06]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport10Connection9PostWriteEv+0x46)[0x7f9df68caaa6]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport10Connection7OnWriteERKN5boost6system10error_codeE+0x3c)[0x7f9df68cbe2c]\n~~~\n\nI'm looking into it", "markup": "markdown", "html": "<p>One of the jenkins builds now has a different backtrace in <code>gzTest.Model</code> that implicates <code>gazebo::transport::Publisher::OnPublishComplete</code>:</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any-xenial-amd64-gpu-nvidia/834/testReport/junit/(root)/gzTest/Model/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/gazebo-ci-pr_any-xenial-amd64-gpu-nvidia/834/testReport/junit/(root)/gzTest/Model/</a></li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>327: [ RUN      ] gzTest.Model\n327: [Msg] Waiting for master.\n327: [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n327: [Msg] Publicized address: 172.17.0.2\n327: tools/gz_TEST.cc:439: Failure\n327: Value of: &quot;Unable to get info on model[my_box_0] in the world[default]\\n&quot;\n327: Expected: modelInfo\n327: Which is: &quot;gz: /usr/include/boost/thread/pthread/mutex.hpp:111: boost::mutex::~mutex(): Assertion `!res&#39; failed.\\nUnable to get info on model[my_box_0] in the world[default]\\nAborted (core dumped)\\n&quot;\n*** Error in `gzserver&#39;: double free or corruption (fasttop): 0x00007f9d4c639900 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f9df7ae87e5]\n/lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7f9df7af137a]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f9df7af553c]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport9Publisher17OnPublishCompleteEj+0xb6)[0x7f9df68f8c06]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport10Connection9PostWriteEv+0x46)[0x7f9df68caaa6]\nbuild/gazebo/transport/libgazebo_transport.so.9(_ZN6gazebo9transport10Connection7OnWriteERKN5boost6system10error_codeE+0x3c)[0x7f9df68cbe2c]\n</pre></div>\n\n\n<p>I'm looking into it</p>", "type": "rendered"}, "created_on": "2019-04-26T17:54:25.801918+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-04-26T17:54:25.816088+00:00", "type": "pullrequest_comment", "id": 100187922}