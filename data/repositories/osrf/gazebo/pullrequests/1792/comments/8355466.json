{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1792/comments/8355466.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:e2f8291aa8b6..1105d39b4f78?path=gazebo%2Fsensors%2FAltimeterSensor_TEST.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1792/_/diff#comment-8355466"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1792, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1792.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1792"}}, "title": "Altimeter sensor (Redo of pull request #1751)"}, "content": {"raw": "The test passes and now I get why, sorry for all the noise and confusion regarding the angular velocity.\n\nFor completeness, I'll just make a few comments which came to me while I was reviewing but it might be more noise.\n\n1. As I understood it, the intent of this test was to show the altimeter in action when the parent link has only angular velocity, but the way the test world was setup, the link origin is 5m away from the rotation center so it has linear velocity - which is different from the altimeter's velocity but it isn't zero.\n\n1. The velocity check below is done for only one world step, but the test could be easily extended to loop through a few steps and check that the velocity evolves correctly. Not sure if it's worth the extra test time perhaps...\n\n1. I'm not sure why `avel.Sum()` was taken instead of `avel.X()` - I'm not sure this would work for rotations on non canonical angles.\n\n1. If the altimeter measures the vertical velocity in the world frame, shouldn't we take `GetWorldAngularVel` instead of `GetRelativeAngularVel`?", "markup": "markdown", "html": "<p>The test passes and now I get why, sorry for all the noise and confusion regarding the angular velocity.</p>\n<p>For completeness, I'll just make a few comments which came to me while I was reviewing but it might be more noise.</p>\n<ol>\n<li>\n<p>As I understood it, the intent of this test was to show the altimeter in action when the parent link has only angular velocity, but the way the test world was setup, the link origin is 5m away from the rotation center so it has linear velocity - which is different from the altimeter's velocity but it isn't zero.</p>\n</li>\n<li>\n<p>The velocity check below is done for only one world step, but the test could be easily extended to loop through a few steps and check that the velocity evolves correctly. Not sure if it's worth the extra test time perhaps...</p>\n</li>\n<li>\n<p>I'm not sure why <code>avel.Sum()</code> was taken instead of <code>avel.X()</code> - I'm not sure this would work for rotations on non canonical angles.</p>\n</li>\n<li>\n<p>If the altimeter measures the vertical velocity in the world frame, shouldn't we take <code>GetWorldAngularVel</code> instead of <code>GetRelativeAngularVel</code>?</p>\n</li>\n</ol>", "type": "rendered"}, "created_on": "2015-07-17T22:20:16.164855+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {"to": 149, "from": null, "outdated": false, "path": "gazebo/sensors/AltimeterSensor_TEST.cc"}, "updated_on": "2015-07-17T22:20:16.170082+00:00", "type": "pullrequest_comment", "id": 8355466}