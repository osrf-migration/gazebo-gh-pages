{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2608/comments/30737730.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2608/_/diff#comment-30737730"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2608, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2608.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2608"}}, "title": "Process insertions and deletions on gz log echo - fix issue #2136"}, "content": {"raw": "hi @chapulina I have tried this PR to see if it addresses #!/osrf/gazebo/issues/2136/gz-log-echo-renders-state-log-unplayable.\n\nI can confirm that the robot model is inserted now and the log file plays correctly.\n\nHowever, there is a URDF-related error that appears, because of [the changes to WorldState.cc](#!/osrf/gazebo/commits/ad1cbdef2401#Lgazebo/physics/WorldState.ccT173). [This error](#!/osrf/gazebo/src/ad1cbdef2401f5e56f9746e60ecfbaea4a7fe8a2/gazebo/physics/World.cc?at=issue_2136&fileviewer=file-view-default#World.cc-2100) is raised, with some SDF errors:\n\n```\nError [parser_urdf.cc:3423] Unable to call parseURDF on robot model\nError [parser.cc:340] parse as old deprecated model file failed.\n[Err] [World.cc:2100] Unable to read sdf string[<model name='robot'>\n  <link name='linear_arm_actuator'>\n    <pose frame=''>0.3 0 0.9 0 -0 0</pose>\n    <inertial>\n      <pose frame=''>0 0 0 0 -0 0</pose>\n      <mass>1</mass>\n      <inertia>\n        <ixx>0.1</ixx>\n        <ixy>0</ixy>\n        <ixz>0</ixz>\n        <iyy>0.1</iyy>\n        <iyz>0</iyz>\n        <izz>0.1</izz>\n      </inertia>\n    </inertial>\n    <collision name='linear_arm_actuator_collision'>\n      <pose frame=''>0 0 0 0 -0 0</pose>\n      <geometry>\n        <box>\n          <size>0.2 4.6 0.1</size>\n        </box>\n      </geometry>\n      <surface>\n        <contact>\n          <ode/>\n        </contact>\n        <friction>\n...\n```\n\n\nIf I revert the change to that file, the error goes away.\n\nThe model that I am inserting is being inserted with the `spawn_model` ROS node from `gazebo_ros_pkgs` which I believe uses a factory. This is probably not how you inserted the model for the test case (though I'm not sure where the difference comes into play)\n\nNote that the error does not affect the *playing* of the log file, so if necessary I can just ignore it. But it would be nice to avoid this error if possible.\n\n\nThank you for the work so far, it is already a great improvement thanks!", "markup": "markdown", "html": "<p>hi @chapulina I have tried this PR to see if it addresses <a href=\"#!/osrf/gazebo/issues/2136/gz-log-echo-renders-state-log-unplayable\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/gazebo/issues/2136/gz-log-echo-renders-state-log-unplayable</a>.</p>\n<p>I can confirm that the robot model is inserted now and the log file plays correctly.</p>\n<p>However, there is a URDF-related error that appears, because of <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/commits/ad1cbdef2401#Lgazebo/physics/WorldState.ccT173\" rel=\"nofollow\">the changes to WorldState.cc</a>. <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/ad1cbdef2401f5e56f9746e60ecfbaea4a7fe8a2/gazebo/physics/World.cc?at=issue_2136&amp;fileviewer=file-view-default#World.cc-2100\" rel=\"nofollow\">This error</a> is raised, with some SDF errors:</p>\n<div class=\"codehilite\"><pre><span></span>Error [parser_urdf.cc:3423] Unable to call parseURDF on robot model\nError [parser.cc:340] parse as old deprecated model file failed.\n[Err] [World.cc:2100] Unable to read sdf string[<span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&#39;robot&#39;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&#39;linear_arm_actuator&#39;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;pose</span> <span class=\"na\">frame=</span><span class=\"s\">&#39;&#39;</span><span class=\"nt\">&gt;</span>0.3 0 0.9 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n    <span class=\"nt\">&lt;inertial&gt;</span>\n      <span class=\"nt\">&lt;pose</span> <span class=\"na\">frame=</span><span class=\"s\">&#39;&#39;</span><span class=\"nt\">&gt;</span>0 0 0 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;mass&gt;</span>1<span class=\"nt\">&lt;/mass&gt;</span>\n      <span class=\"nt\">&lt;inertia&gt;</span>\n        <span class=\"nt\">&lt;ixx&gt;</span>0.1<span class=\"nt\">&lt;/ixx&gt;</span>\n        <span class=\"nt\">&lt;ixy&gt;</span>0<span class=\"nt\">&lt;/ixy&gt;</span>\n        <span class=\"nt\">&lt;ixz&gt;</span>0<span class=\"nt\">&lt;/ixz&gt;</span>\n        <span class=\"nt\">&lt;iyy&gt;</span>0.1<span class=\"nt\">&lt;/iyy&gt;</span>\n        <span class=\"nt\">&lt;iyz&gt;</span>0<span class=\"nt\">&lt;/iyz&gt;</span>\n        <span class=\"nt\">&lt;izz&gt;</span>0.1<span class=\"nt\">&lt;/izz&gt;</span>\n      <span class=\"nt\">&lt;/inertia&gt;</span>\n    <span class=\"nt\">&lt;/inertial&gt;</span>\n    <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&#39;linear_arm_actuator_collision&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;pose</span> <span class=\"na\">frame=</span><span class=\"s\">&#39;&#39;</span><span class=\"nt\">&gt;</span>0 0 0 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;geometry&gt;</span>\n        <span class=\"nt\">&lt;box&gt;</span>\n          <span class=\"nt\">&lt;size&gt;</span>0.2 4.6 0.1<span class=\"nt\">&lt;/size&gt;</span>\n        <span class=\"nt\">&lt;/box&gt;</span>\n      <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;surface&gt;</span>\n        <span class=\"nt\">&lt;contact&gt;</span>\n          <span class=\"nt\">&lt;ode/&gt;</span>\n        <span class=\"nt\">&lt;/contact&gt;</span>\n        <span class=\"nt\">&lt;friction&gt;</span>\n...\n</pre></div>\n\n\n<p>If I revert the change to that file, the error goes away.</p>\n<p>The model that I am inserting is being inserted with the <code>spawn_model</code> ROS node from <code>gazebo_ros_pkgs</code> which I believe uses a factory. This is probably not how you inserted the model for the test case (though I'm not sure where the difference comes into play)</p>\n<p>Note that the error does not affect the <em>playing</em> of the log file, so if necessary I can just ignore it. But it would be nice to avoid this error if possible.</p>\n<p>Thank you for the work so far, it is already a great improvement thanks!</p>", "type": "rendered"}, "created_on": "2017-02-02T00:37:08.559539+00:00", "user": {"display_name": "Deanna Hood", "uuid": "{40d490b4-7de9-4c89-ac1c-2219a22057eb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B40d490b4-7de9-4c89-ac1c-2219a22057eb%7D"}, "html": {"href": "https://bitbucket.org/%7B40d490b4-7de9-4c89-ac1c-2219a22057eb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ec666897-79d8-48b4-ae27-4f0e9e56f5b5/f7b56737-eb1f-481f-beb1-50c179565cf4/128"}}, "nickname": "d_hood", "type": "user", "account_id": "557058:ec666897-79d8-48b4-ae27-4f0e9e56f5b5"}, "updated_on": "2017-02-02T00:37:08.566772+00:00", "type": "pullrequest_comment", "id": 30737730}