{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/429/comments/185996.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:119cc5a21097..8e65421ce88f?path=deps%2Fopende%2Fsrc%2Fjoints%2Fcontact.cpp"}, "html": {"href": "#!/osrf/gazebo/pull-requests/429/_/diff#comment-185996"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 429, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/429.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/429"}}, "title": "fixes to treat fdir1 better.  1. rotate into link local frame.  2.  check if parallel to contact normal, if yes, revert to dPlaneSpace."}, "content": {"raw": "This logic won't capture if fdir1 and the normal have opposite signs. I'll propose an alternate logical check:\n\nOn line 215, the variable t2 is computed as the cross product of fdir1 with the normal (since t1 is set to fdir1 just before). If fdir1 and the normal are close to parallel, then the length of t2 will be very small. I think a more robust check would be:\n~~~\nif (_dequal(t2[0], 0) &&\n    _dequal(t2[1], 0) &&\n    _dequal(t2[2], 0))\n~~~", "markup": "markdown", "html": "<p>This logic won't capture if fdir1 and the normal have opposite signs. I'll propose an alternate logical check:</p>\n<p>On line 215, the variable t2 is computed as the cross product of fdir1 with the normal (since t1 is set to fdir1 just before). If fdir1 and the normal are close to parallel, then the length of t2 will be very small. I think a more robust check would be:</p>\n<div class=\"codehilite\"><pre><span></span>if (_dequal(t2[0], 0) &amp;&amp;\n    _dequal(t2[1], 0) &amp;&amp;\n    _dequal(t2[2], 0))\n</pre></div>", "type": "rendered"}, "created_on": "2013-04-05T17:07:19.810679+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {"to": 218, "from": null, "outdated": true, "path": "deps/opende/src/joints/contact.cpp"}, "updated_on": "2013-04-05T17:07:19.820550+00:00", "type": "pullrequest_comment", "id": 185996}