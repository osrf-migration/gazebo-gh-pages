{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/620/comments/387248.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:a5caceb0c064..bd34b42f67d2?path=gazebo%2Ftransport%2FCMakeLists.txt"}, "html": {"href": "#!/osrf/gazebo/pull-requests/620/_/diff#comment-387248"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 620, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/620.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/620"}}, "title": "Add compile-time defaults for env vars (issue #781)"}, "content": {"raw": "```\ndiff -r c2f6c43d5400 gazebo/transport/CMakeLists.txt\n--- a/gazebo/transport/CMakeLists.txt\tTue Jul 16 15:18:50 2013 -0700\n+++ b/gazebo/transport/CMakeLists.txt\tWed Jul 17 01:42:13 2013 +0200\n@@ -40,12 +40,12 @@\n configure_file (${CMAKE_CURRENT_SOURCE_DIR}/transport.hh.in\n                 ${CMAKE_CURRENT_BINARY_DIR}/transport.hh )\n \n-# It should suffice to call set_source_files_properties specifically on\n-# Transport.cc, but that didn't work for me.\n-add_definitions(-DGAZEBO_DEFAULT_MASTER_HOST=\"${GAZEBO_DEFAULT_MASTER_HOST}\")\n-# No quotes around the port because we want the preprocessor symbol to be an\n-# integer.\n-add_definitions(-DGAZEBO_DEFAULT_MASTER_PORT=${GAZEBO_DEFAULT_MASTER_PORT})\n+set_property(\n+  SOURCE Transport.cc\n+  PROPERTY COMPILE_DEFINITIONS\n+  GAZEBO_DEFAULT_MASTER_HOST=\"${GAZEBO_DEFAULT_MASTER_HOST}\"\n+  GAZEBO_DEFAULT_MASTER_PORT=${GAZEBO_DEFAULT_MASTER_PORT}\n+)\n \n gz_add_library(gazebo_transport ${sources})\n target_link_libraries(gazebo_transport\n```\ncould do the trick. \n\nSpecial care with file names while using set_property, cmake will silently ignore an error in the name such as Transport.cpp and won't generate an error.\n", "markup": "markdown", "html": "<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r c2f6c43d5400 gazebo/transport/CMakeLists.txt</span>\n<span class=\"gd\">--- a/gazebo/transport/CMakeLists.txt   Tue Jul 16 15:18:50 2013 -0700</span>\n<span class=\"gi\">+++ b/gazebo/transport/CMakeLists.txt   Wed Jul 17 01:42:13 2013 +0200</span>\n<span class=\"gu\">@@ -40,12 +40,12 @@</span>\n configure_file (${CMAKE_CURRENT_SOURCE_DIR}/transport.hh.in\n                 ${CMAKE_CURRENT_BINARY_DIR}/transport.hh )\n\n<span class=\"gd\">-# It should suffice to call set_source_files_properties specifically on</span>\n<span class=\"gd\">-# Transport.cc, but that didn&#39;t work for me.</span>\n<span class=\"gd\">-add_definitions(-DGAZEBO_DEFAULT_MASTER_HOST=&quot;${GAZEBO_DEFAULT_MASTER_HOST}&quot;)</span>\n<span class=\"gd\">-# No quotes around the port because we want the preprocessor symbol to be an</span>\n<span class=\"gd\">-# integer.</span>\n<span class=\"gd\">-add_definitions(-DGAZEBO_DEFAULT_MASTER_PORT=${GAZEBO_DEFAULT_MASTER_PORT})</span>\n<span class=\"gi\">+set_property(</span>\n<span class=\"gi\">+  SOURCE Transport.cc</span>\n<span class=\"gi\">+  PROPERTY COMPILE_DEFINITIONS</span>\n<span class=\"gi\">+  GAZEBO_DEFAULT_MASTER_HOST=&quot;${GAZEBO_DEFAULT_MASTER_HOST}&quot;</span>\n<span class=\"gi\">+  GAZEBO_DEFAULT_MASTER_PORT=${GAZEBO_DEFAULT_MASTER_PORT}</span>\n<span class=\"gi\">+)</span>\n\n gz_add_library(gazebo_transport ${sources})\n target_link_libraries(gazebo_transport\n</pre></div>\n\n\n<p>could do the trick. </p>\n<p>Special care with file names while using set_property, cmake will silently ignore an error in the name such as Transport.cpp and won't generate an error.</p>", "type": "rendered"}, "created_on": "2013-07-16T23:44:31.209626+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "inline": {"to": 43, "from": null, "outdated": true, "path": "gazebo/transport/CMakeLists.txt"}, "updated_on": "2013-07-16T23:44:31.217323+00:00", "type": "pullrequest_comment", "id": 387248}