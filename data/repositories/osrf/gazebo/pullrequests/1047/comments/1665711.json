{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1047/comments/1665711.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1047/_/diff#comment-1665711"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1047, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1047.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1047"}}, "title": "Adding lcov coverage"}, "content": {"raw": "I got the following error while running `make coverage` in Ubuntu Precise with gcc 4.8:\n\n\n```\n#!c++\n\ncaguero@turtlebot:~/workspace/gazebo_2.0/build$ make coverage\nProcessing code coverage counters and generating report.\nCapturing coverage data from /home/caguero/workspace/gazebo_2.0/build/gazebo\nFound gcov version: 4.8.1\nScanning /home/caguero/workspace/gazebo_2.0/build/gazebo for .gcda files ...\nFound 201 data files in /home/caguero/workspace/gazebo_2.0/build/gazebo\nProcessing math/CMakeFiles/UNIT_Box_TEST.dir/Box_TEST.cc.gcda\ngeninfo: ERROR: /home/caguero/workspace/gazebo_2.0/build/gazebo/math/CMakeFiles/UNIT_Box_TEST.dir/Box_TEST.cc.gcno: reached unexpected end of file\nmake[3]: *** [CMakeFiles/coverage] Error 255\nmake[2]: *** [CMakeFiles/coverage.dir/all] Error 2\nmake[1]: *** [CMakeFiles/coverage.dir/rule] Error 2\nmake: *** [coverage] Error 2\n```\n\nBefore the error, I ran `make test` and got some failures:\n\n```\n#!c++\n\n34% tests passed, 183 tests failed out of 276\n```\n\nAnd I also noticed that I cannot run gazebo from this branch and with `CMAKE_BUILD_TYPE=coverage`. I got this error:\n\n```\n#!c++\n\ncaguero@turtlebot:~/workspace/gazebo_2.0/build$ gazebo\ngazebo: /usr/include/eigen3/Eigen/src/Core/CommaInitializer.h:106: Eigen::CommaInitializer<MatrixType>::~CommaInitializer() [with XprType = Eigen::Matrix<double, 2, 2>]: Assertion `(m_row+m_currentBlockRows) == m_xpr.rows() && m_col == m_xpr.cols() && \"Too few coefficients passed to comma initializer (operator<<)\"' failed.\nAborted (core dumped)\n```\n\nI also tried with `CMAKE_BUILD_TYPE=RelWithDebInfo` and gazebo works without problem.", "markup": "markdown", "html": "<p>I got the following error while running <code>make coverage</code> in Ubuntu Precise with gcc 4.8:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"n\">caguero</span><span class=\"err\">@</span><span class=\"nl\">turtlebot</span><span class=\"p\">:</span><span class=\"o\">~/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"err\">$</span> <span class=\"n\">make</span> <span class=\"n\">coverage</span>\n<span class=\"n\">Processing</span> <span class=\"n\">code</span> <span class=\"n\">coverage</span> <span class=\"n\">counters</span> <span class=\"n\">and</span> <span class=\"n\">generating</span> <span class=\"n\">report</span><span class=\"p\">.</span>\n<span class=\"n\">Capturing</span> <span class=\"n\">coverage</span> <span class=\"n\">data</span> <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">gazebo</span>\n<span class=\"n\">Found</span> <span class=\"n\">gcov</span> <span class=\"nl\">version</span><span class=\"p\">:</span> <span class=\"mf\">4.8.1</span>\n<span class=\"n\">Scanning</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">gazebo</span> <span class=\"k\">for</span> <span class=\"p\">.</span><span class=\"n\">gcda</span> <span class=\"n\">files</span> <span class=\"p\">...</span>\n<span class=\"n\">Found</span> <span class=\"mi\">201</span> <span class=\"n\">data</span> <span class=\"n\">files</span> <span class=\"n\">in</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">gazebo</span>\n<span class=\"n\">Processing</span> <span class=\"n\">math</span><span class=\"o\">/</span><span class=\"n\">CMakeFiles</span><span class=\"o\">/</span><span class=\"n\">UNIT_Box_TEST</span><span class=\"p\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">Box_TEST</span><span class=\"p\">.</span><span class=\"n\">cc</span><span class=\"p\">.</span><span class=\"n\">gcda</span>\n<span class=\"nl\">geninfo</span><span class=\"p\">:</span> <span class=\"nl\">ERROR</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">math</span><span class=\"o\">/</span><span class=\"n\">CMakeFiles</span><span class=\"o\">/</span><span class=\"n\">UNIT_Box_TEST</span><span class=\"p\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">Box_TEST</span><span class=\"p\">.</span><span class=\"n\">cc</span><span class=\"p\">.</span><span class=\"nl\">gcno</span><span class=\"p\">:</span> <span class=\"n\">reached</span> <span class=\"n\">unexpected</span> <span class=\"n\">end</span> <span class=\"n\">of</span> <span class=\"n\">file</span>\n<span class=\"n\">make</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"o\">:</span> <span class=\"o\">***</span> <span class=\"p\">[</span><span class=\"n\">CMakeFiles</span><span class=\"o\">/</span><span class=\"n\">coverage</span><span class=\"p\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">255</span>\n<span class=\"n\">make</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">:</span> <span class=\"o\">***</span> <span class=\"p\">[</span><span class=\"n\">CMakeFiles</span><span class=\"o\">/</span><span class=\"n\">coverage</span><span class=\"p\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">all</span><span class=\"p\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">:</span> <span class=\"o\">***</span> <span class=\"p\">[</span><span class=\"n\">CMakeFiles</span><span class=\"o\">/</span><span class=\"n\">coverage</span><span class=\"p\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">rule</span><span class=\"p\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"nl\">make</span><span class=\"p\">:</span> <span class=\"o\">***</span> <span class=\"p\">[</span><span class=\"n\">coverage</span><span class=\"p\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n</pre></div>\n\n\n<p>Before the error, I ran <code>make test</code> and got some failures:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"mi\">34</span><span class=\"o\">%</span> <span class=\"n\">tests</span> <span class=\"n\">passed</span><span class=\"p\">,</span> <span class=\"mi\">183</span> <span class=\"n\">tests</span> <span class=\"n\">failed</span> <span class=\"n\">out</span> <span class=\"n\">of</span> <span class=\"mi\">276</span>\n</pre></div>\n\n\n<p>And I also noticed that I cannot run gazebo from this branch and with <code>CMAKE_BUILD_TYPE=coverage</code>. I got this error:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"n\">caguero</span><span class=\"err\">@</span><span class=\"nl\">turtlebot</span><span class=\"p\">:</span><span class=\"o\">~/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo_2</span><span class=\"mf\">.0</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"err\">$</span> <span class=\"n\">gazebo</span>\n<span class=\"nl\">gazebo</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">eigen3</span><span class=\"o\">/</span><span class=\"n\">Eigen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Core</span><span class=\"o\">/</span><span class=\"n\">CommaInitializer</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">106</span><span class=\"o\">:</span> <span class=\"n\">Eigen</span><span class=\"o\">::</span><span class=\"n\">CommaInitializer</span><span class=\"o\">&lt;</span><span class=\"n\">MatrixType</span><span class=\"o\">&gt;::~</span><span class=\"n\">CommaInitializer</span><span class=\"p\">()</span> <span class=\"p\">[</span><span class=\"n\">with</span> <span class=\"n\">XprType</span> <span class=\"o\">=</span> <span class=\"n\">Eigen</span><span class=\"o\">::</span><span class=\"n\">Matrix</span><span class=\"o\">&lt;</span><span class=\"kt\">double</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"o\">&gt;</span><span class=\"p\">]</span><span class=\"o\">:</span> <span class=\"n\">Assertion</span> <span class=\"err\">`</span><span class=\"p\">(</span><span class=\"n\">m_row</span><span class=\"o\">+</span><span class=\"n\">m_currentBlockRows</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"n\">m_xpr</span><span class=\"p\">.</span><span class=\"n\">rows</span><span class=\"p\">()</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">m_col</span> <span class=\"o\">==</span> <span class=\"n\">m_xpr</span><span class=\"p\">.</span><span class=\"n\">cols</span><span class=\"p\">()</span> <span class=\"o\">&amp;&amp;</span> <span class=\"s\">&quot;Too few coefficients passed to comma initializer (operator&lt;&lt;)&quot;</span><span class=\"err\">&#39;</span> <span class=\"n\">failed</span><span class=\"p\">.</span>\n<span class=\"n\">Aborted</span> <span class=\"p\">(</span><span class=\"n\">core</span> <span class=\"n\">dumped</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>I also tried with <code>CMAKE_BUILD_TYPE=RelWithDebInfo</code> and gazebo works without problem.</p>", "type": "rendered"}, "created_on": "2014-04-15T17:57:11.950596+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2014-04-15T19:33:57.758634+00:00", "type": "pullrequest_comment", "id": 1665711}