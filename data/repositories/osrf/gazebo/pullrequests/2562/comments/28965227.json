{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2562/comments/28965227.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/JenniferBuehler/gazebo:829f7ec4c516..f1c8c5b396c1?path=gazebo%2Fgui%2FGuiIface.cc"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2562/_/diff#comment-28965227"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2562, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2562.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2562"}}, "title": "Load GUI Plugins with gzclient parameter -g, fixes issue 1311"}, "content": {"raw": "The Load() method of the GuiPlugin is called from within this RenderWidget::AddPlugin(). However this is by definition *not to be done* when a GUI Plugin is loaded from the INI file, and it should probably be the same for plugins loaded via the command line interface. You will notice the difference with the timer plugin, because it its Load() sets the widget to smaller dimensions if called without the specifications in the SDF. When loaded via INI (no Load() call), the plugin is large. When loaded via command line parameter (currently calling Load()), it's pretty small.\n\nHowever we need to call RenderWidget::AddPlugin() here for two reasons:\n\n1. RenderWidget::glWidget is private, and we need it to set the parent of the plugin. \n2. The plugins should be managed in the plugins vector of the RenderWidget along with the ones loaded from the INI file (in the constructor of RenderWidget). This is the best solution to avoid a segfault upon gzclient exit.\n\nHow we could fix this in method ``RenderWidget::AddPlugin()``:\n\n* Suggestion 1: Avoid calling GuiPlugin::Load() if the sdf element is set to NULL, and set it to NULL in this case. Disadvantage is that sometimes maybe we want to call Load() even if the ElementPtr is NULL?\n* Suggestion 2: Add an extra boolean parameter loadPlugin which defaults to true, and call Load() only if it's true.\n\nAny other suggestions? Which solution would be preferable?", "markup": "markdown", "html": "<p>The Load() method of the GuiPlugin is called from within this RenderWidget::AddPlugin(). However this is by definition <em>not to be done</em> when a GUI Plugin is loaded from the INI file, and it should probably be the same for plugins loaded via the command line interface. You will notice the difference with the timer plugin, because it its Load() sets the widget to smaller dimensions if called without the specifications in the SDF. When loaded via INI (no Load() call), the plugin is large. When loaded via command line parameter (currently calling Load()), it's pretty small.</p>\n<p>However we need to call RenderWidget::AddPlugin() here for two reasons:</p>\n<ol>\n<li>RenderWidget::glWidget is private, and we need it to set the parent of the plugin. </li>\n<li>The plugins should be managed in the plugins vector of the RenderWidget along with the ones loaded from the INI file (in the constructor of RenderWidget). This is the best solution to avoid a segfault upon gzclient exit.</li>\n</ol>\n<p>How we could fix this in method <code>RenderWidget::AddPlugin()</code>:</p>\n<ul>\n<li>Suggestion 1: Avoid calling GuiPlugin::Load() if the sdf element is set to NULL, and set it to NULL in this case. Disadvantage is that sometimes maybe we want to call Load() even if the ElementPtr is NULL?</li>\n<li>Suggestion 2: Add an extra boolean parameter loadPlugin which defaults to true, and call Load() only if it's true.</li>\n</ul>\n<p>Any other suggestions? Which solution would be preferable?</p>", "type": "rendered"}, "created_on": "2016-12-30T00:31:07.489912+00:00", "user": {"display_name": "Jennifer Buehler", "uuid": "{5949baad-8c43-4d52-9a82-bb8c3511fed8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D"}, "html": {"href": "https://bitbucket.org/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/b28ae0e95eada6ee16f0860c1fa59fdcd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJB-4.png"}}, "nickname": "JenniferBuehler", "type": "user", "account_id": "557058:96bd489a-ec14-4a06-8d31-7bb6d46d1209"}, "inline": {"to": 361, "from": null, "outdated": true, "path": "gazebo/gui/GuiIface.cc"}, "updated_on": "2016-12-30T00:31:07.579135+00:00", "type": "pullrequest_comment", "id": 28965227}