{"pagelen": 50, "values": [{"update": {"description": "Issue #1981 notes that if the center of gravity (CoG) of a link with joints is moved after the link, joints, etc. have been initialized, it causes the link to jerk suddenly. The problem occurs because Gazebo sets the origin of the ODE body as the link's CoG ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/physics/ode/ODELink.cc?fileviewer=file-view-default#ODELink.cc-252)). Thus, when the CoG is moved the ODE body's origin moves as well. Before the ODE joints are attached this is not a problem. However, once the joints have been initialized, moving the CoG causes joint constraints to be violated, so the model jumps to correct them.\r\n\r\nThe ODE function `dMassSetParameters` allows one to specify an offset for the CoG, so theoretically the changes [here](https://bitbucket.org/pchorak/gazebo/commits/479d04db6f74c12f0ba745abc2dda83f88ac50e4) would solve the issue. However, ODE does not support setting the CoG offset to anything but zero ([see here](http://ode.org/ode-latest-userguide.html#sec_13_0_0)).\r\n\r\nThis pull request allows link CoGs to be moved after initialization by re-attaching the ODE joints  when `ODELink::UpdateMass` is called. The collision meshes must also be updated, but this is already handled in `ODELink::UpdateCollisionOffsets`. This pull request includes the tests from pull request #2341, which now succeeds with the changes.\r\n\r\nNote: there are a few reasons it may be better to not support moving link CoGs after initialization:\r\n\r\n1. Re-attaching the ODE joints resets the joint angles to zero for the model configuration at that time. This behavior shifts/breaks joint limits and makes the joint angles reported inconsistent. [Here](https://bitbucket.org/pchorak/gazebo/commits/b04036e8294c783faa40e42a2a2ac6fc29595eb3) is an example/test illustrating how the joint limits are broken. I made changes [here](https://bitbucket.org/pchorak/gazebo/branch/ode_move_cog_abi?dest=ode_move_cog#diff) which maintain the joint limits and angles. However, the changes break ABI and so would need to be targeted at gazebo9 (default).\r\n\r\n1. Re-attaching joints when a link's CoG moves could be considered unexpected behavior and an invitation for bugs.\r\n\r\n1. Once the CoG visuals are created, their relative position is not updated even if the CoG offset changes ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/rendering/Visual.cc?at=ode_move_cog_abi&fileviewer=file-view-default#Visual.cc-3093)).\r\n\r\n1. If the link origin is moved it causes the model to jerk suddenly. Moving the link is similar to moving the CoG, especially since ODE's internal representation requires the body (link) origin and CoG to be coincident. So, there is a precedent for the flying behavior when a link's CoG is moved.", "title": "Moving the center of gravity of a link with joints in ODE", "destination": {"commit": {"hash": "5f41b719c1fe", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/5f41b719c1fe.json"}, "html": {"href": "#!/osrf/gazebo/commits/5f41b719c1fe"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "See comments.", "source": {"commit": {"hash": "d20d6d0c989a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d20d6d0c989a.json"}, "html": {"href": "#!/osrf/gazebo/commits/d20d6d0c989a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "ode_move_cog_abi"}}, "state": "DECLINED", "author": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "date": "2017-08-14T21:17:14.484440+00:00"}, "pull_request": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765/comments/42789107.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765/_/diff#comment-42789107"}}, "parent": {"id": 42788468, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765/comments/42788468.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765/_/diff#comment-42788468"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}, "content": {"raw": "Thanks Grey. Good points. I already have a solution for (1) and expect we can figure something out for (3). It is good to hear about some potential use cases (4). I will decline this PR and target a new one for default once it has a solution for (3).", "markup": "markdown", "html": "<p>Thanks Grey. Good points. I already have a solution for (1) and expect we can figure something out for (3). It is good to hear about some potential use cases (4). I will decline this PR and target a new one for default once it has a solution for (3).</p>", "type": "rendered"}, "created_on": "2017-08-14T20:48:33.673497+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-08-14T20:48:33.677237+00:00", "type": "pullrequest_comment", "id": 42789107}, "pull_request": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765/comments/42783863.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765/_/diff#comment-42783863"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}, "content": {"raw": "I am not sure if this is necessary", "markup": "markdown", "html": "<p>I am not sure if this is necessary</p>", "type": "rendered"}, "created_on": "2017-08-14T19:34:51.760413+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "inline": {}, "updated_on": "2017-08-14T19:34:51.763142+00:00", "type": "pullrequest_comment", "id": 42783863}, "pull_request": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}}, {"update": {"description": "Issue #1981 notes that if the center of gravity (CoG) of a link with joints is moved after the link, joints, etc. have been initialized, it causes the link to jerk suddenly. The problem occurs because Gazebo sets the origin of the ODE body as the link's CoG ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/physics/ode/ODELink.cc?fileviewer=file-view-default#ODELink.cc-252)). Thus, when the CoG is moved the ODE body's origin moves as well. Before the ODE joints are attached this is not a problem. However, once the joints have been initialized, moving the CoG causes joint constraints to be violated, so the model jumps to correct them.\r\n\r\nThe ODE function `dMassSetParameters` allows one to specify an offset for the CoG, so theoretically the changes [here](https://bitbucket.org/pchorak/gazebo/commits/479d04db6f74c12f0ba745abc2dda83f88ac50e4) would solve the issue. However, ODE does not support setting the CoG offset to anything but zero ([see here](http://ode.org/ode-latest-userguide.html#sec_13_0_0)).\r\n\r\nThis pull request allows link CoGs to be moved after initialization by re-attaching the ODE joints  when `ODELink::UpdateMass` is called. The collision meshes must also be updated, but this is already handled in `ODELink::UpdateCollisionOffsets`. This pull request includes the tests from pull request #2341, which now succeeds with the changes.\r\n\r\nNote: there are a few reasons it may be better to not support moving link CoGs after initialization:\r\n\r\n1. Re-attaching the ODE joints resets the joint angles to zero for the model configuration at that time. This behavior shifts/breaks joint limits and makes the joint angles reported inconsistent. [Here](https://bitbucket.org/pchorak/gazebo/commits/b04036e8294c783faa40e42a2a2ac6fc29595eb3) is an example/test illustrating how the joint limits are broken. I made changes [here](https://bitbucket.org/pchorak/gazebo/branch/ode_move_cog_abi?dest=ode_move_cog#diff) which maintain the joint limits and angles. However, the changes break ABI and so would need to be targeted at gazebo9 (default).\r\n\r\n1. Re-attaching joints when a link's CoG moves could be considered unexpected behavior and an invitation for bugs.\r\n\r\n1. Once the CoG visuals are created, their relative position is not updated even if the CoG offset changes ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/rendering/Visual.cc?at=ode_move_cog_abi&fileviewer=file-view-default#Visual.cc-3093)).\r\n\r\n1. If the link origin is moved it causes the model to jerk suddenly. Moving the link is similar to moving the CoG, especially since ODE's internal representation requires the body (link) origin and CoG to be coincident. So, there is a precedent for the flying behavior when a link's CoG is moved.", "title": "Moving the center of gravity of a link with joints in ODE", "destination": {"commit": {"hash": "5f41b719c1fe", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/5f41b719c1fe.json"}, "html": {"href": "#!/osrf/gazebo/commits/5f41b719c1fe"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "d20d6d0c989a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d20d6d0c989a.json"}, "html": {"href": "#!/osrf/gazebo/commits/d20d6d0c989a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "ode_move_cog_abi"}}, "state": "OPEN", "author": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "date": "2017-08-14T19:34:20.769073+00:00"}, "pull_request": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}}, {"update": {"description": "Issue #1981 notes that if the center of gravity (CoG) of a link with joints is moved after the link, joints, etc. have been initialized, it causes the link to jerk suddenly. The problem occurs because Gazebo sets the origin of the ODE body as the link's CoG ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/physics/ode/ODELink.cc?fileviewer=file-view-default#ODELink.cc-252)). Thus, when the CoG is moved the ODE body's origin moves as well. Before the ODE joints are attached this is not a problem. However, once the joints have been initialized, moving the CoG causes joint constraints to be violated, so the model jumps to correct them.\r\n\r\nThe ODE function `dMassSetParameters` allows one to specify an offset for the CoG, so theoretically the changes [here](https://bitbucket.org/pchorak/gazebo/commits/479d04db6f74c12f0ba745abc2dda83f88ac50e4) would solve the issue. However, ODE does not support setting the CoG offset to anything but zero ([see here](http://ode.org/ode-latest-userguide.html#sec_13_0_0)).\r\n\r\nThis pull request allows link CoGs to be moved after initialization by re-attaching the ODE joints  when `ODELink::UpdateMass` is called. The collision meshes must also be updated, but this is already handled in `ODELink::UpdateCollisionOffsets`. This pull request includes the tests from pull request #2341, which now succeeds with the changes.\r\n\r\nNote: there are a few reasons it may be better to not support moving link CoGs after initialization:\r\n\r\n1. Re-attaching the ODE joints resets the joint angles to zero for the model configuration at that time. This behavior shifts/breaks joint limits and makes the joint angles reported inconsistent. [Here](https://bitbucket.org/pchorak/gazebo/commits/b04036e8294c783faa40e42a2a2ac6fc29595eb3) is an example/test illustrating how the joint limits are broken. I made changes [here](https://bitbucket.org/pchorak/gazebo/branch/ode_move_cog_abi?dest=ode_move_cog#diff) which maintain the joint limits and angles. However, the changes break ABI and so would need to be targeted at gazebo9 (default).\r\n\r\n1. Re-attaching joints when a link's CoG moves could be considered unexpected behavior and an invitation for bugs.\r\n\r\n1. Once the CoG visuals are created, their relative position is not updated even if the CoG offset changes ([see here](#!/osrf/gazebo/src/d20d6d0c989ad10c8912a71c290329892f173f6c/gazebo/rendering/Visual.cc?at=ode_move_cog_abi&fileviewer=file-view-default#Visual.cc-3093)).\r\n\r\n1. If the link origin is moved it causes the model to jerk suddenly. Moving the link is similar to moving the CoG, especially since ODE's internal representation requires the body (link) origin and CoG to be coincident. So, there is a precedent for the flying behavior when a link's CoG is moved.", "title": "Moving the center of gravity of a link with joints in ODE", "destination": {"commit": {"hash": "5f41b719c1fe", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/5f41b719c1fe.json"}, "html": {"href": "#!/osrf/gazebo/commits/5f41b719c1fe"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "d20d6d0c989a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/d20d6d0c989a.json"}, "html": {"href": "#!/osrf/gazebo/commits/d20d6d0c989a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "ode_move_cog_abi"}}, "state": "OPEN", "author": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "date": "2017-08-14T19:34:20.726288+00:00"}, "pull_request": {"type": "pullrequest", "id": 2765, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2765.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2765"}}, "title": "Moving the center of gravity of a link with joints in ODE"}}]}