{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63823346.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63823346"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Hi, Jacob, if I run the INTEGRATION\\_gpu\\_laser test I get:  \n\n    :~/gazebo/build$ ./test/integration/INTEGRATION_gpu_laser \n    [==========] Running 5 tests from 1 test case.\n    [----------] Global test environment set-up.\n    [----------] 5 tests from GPURaySensorTest\n    \n    ....\n    \n    [       OK ] GPURaySensorTest.Heightmap (2084 ms)\n    [ RUN      ] GPURaySensorTest.LaserVertical\n    [Msg] Waiting for master.\n    [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n    [Msg] Publicized address: 172.17.0.2\n    [Dbg] [ServerFixture.cc:207] ServerFixture load in 1.1 seconds, timeout after 600 seconds\n    [Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.079109901099460034, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.43266329169273376,\n    expectedRange evaluates to 0.35355339059327373, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.065850478119853451, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.39836812019348145,\n    expectedRange evaluates to 0.33251764207362799, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.053652972699826496, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.36877107620239258,\n    expectedRange evaluates to 0.31511810350256608, and\n    \n    ....\n    \n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.043081311625098206, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.34375375509262085,\n    expectedRange evaluates to 0.30067244346752264, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.053652764083569726, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.36877086758613586,\n    expectedRange evaluates to 0.31511810350256614, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.065850299305919124, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.39836794137954712,\n    expectedRange evaluates to 0.33251764207362799, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.07910975208784804, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.43266314268112183,\n    expectedRange evaluates to 0.35355339059327379, and\n    1e-3 evaluates to 0.001.\n    [Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n    [  FAILED  ] GPURaySensorTest.LaserVertical (1762 ms)\n    [ RUN      ] GPURaySensorTest.LaserScanResolution\n    [Msg] Waiting for master.\n    [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n    [Msg] Publicized address: 172.17.0.2\n    [Dbg] [ServerFixture.cc:207] ServerFixture load in 1 seconds, timeout after 600 seconds\n    [Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n    [Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n    [       OK ] GPURaySensorTest.LaserScanResolution (1448 ms)\n    [----------] 5 tests from GPURaySensorTest (10228 ms total)\n    \n    [----------] Global test environment tear-down\n    [==========] 5 tests from 1 test case ran. (10228 ms total)\n    [  PASSED  ] 4 tests.\n    [  FAILED  ] 1 test, listed below:\n    [  FAILED  ] GPURaySensorTest.LaserVertical\n\nThis is consistent to what I see in Gazebo using a simple world:  \n  \n![Screenshot from 2018-05-09 16-55-19.png](https://bitbucket.org/repo/jgXqbo/images/1685315280-Screenshot%20from%202018-05-09%2016-55-19.png 'Screenshot from 2018-05-09 16-55-19.png')\n\nWe still have that saw looking border. It is better than we had before, but we still have this issue.  \n  \nDid you have the same results that I had?", "markup": "markdown", "html": "<p>Hi, Jacob, if I run the INTEGRATION_gpu_laser test I get:  </p>\n<div class=\"codehilite\"><pre><span></span>:~/gazebo/build$ ./test/integration/INTEGRATION_gpu_laser \n[==========] Running 5 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 5 tests from GPURaySensorTest\n\n....\n\n[       OK ] GPURaySensorTest.Heightmap (2084 ms)\n[ RUN      ] GPURaySensorTest.LaserVertical\n[Msg] Waiting for master.\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\n[Msg] Publicized address: 172.17.0.2\n[Dbg] [ServerFixture.cc:207] ServerFixture load in 1.1 seconds, timeout after 600 seconds\n[Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.079109901099460034, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.43266329169273376,\nexpectedRange evaluates to 0.35355339059327373, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.065850478119853451, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.39836812019348145,\nexpectedRange evaluates to 0.33251764207362799, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.053652972699826496, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.36877107620239258,\nexpectedRange evaluates to 0.31511810350256608, and\n\n....\n\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.043081311625098206, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.34375375509262085,\nexpectedRange evaluates to 0.30067244346752264, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.053652764083569726, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.36877086758613586,\nexpectedRange evaluates to 0.31511810350256614, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.065850299305919124, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.39836794137954712,\nexpectedRange evaluates to 0.33251764207362799, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.07910975208784804, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.43266314268112183,\nexpectedRange evaluates to 0.35355339059327379, and\n1e-3 evaluates to 0.001.\n[Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n[  FAILED  ] GPURaySensorTest.LaserVertical (1762 ms)\n[ RUN      ] GPURaySensorTest.LaserScanResolution\n[Msg] Waiting for master.\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\n[Msg] Publicized address: 172.17.0.2\n[Dbg] [ServerFixture.cc:207] ServerFixture load in 1 seconds, timeout after 600 seconds\n[Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n[Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n[       OK ] GPURaySensorTest.LaserScanResolution (1448 ms)\n[----------] 5 tests from GPURaySensorTest (10228 ms total)\n\n[----------] Global test environment tear-down\n[==========] 5 tests from 1 test case ran. (10228 ms total)\n[  PASSED  ] 4 tests.\n[  FAILED  ] 1 test, listed below:\n[  FAILED  ] GPURaySensorTest.LaserVertical\n</pre></div>\n\n\n<p>This is consistent to what I see in Gazebo using a simple world:  </p>\n<p><img alt=\"Screenshot from 2018-05-09 16-55-19.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/1685315280-Screenshot_from_2018-05-09_16-55-19.png\" title=\"Screenshot from 2018-05-09 16-55-19.png\" /></p>\n<p>We still have that saw looking border. It is better than we had before, but we still have this issue.  </p>\n<p>Did you have the same results that I had?</p>", "type": "rendered"}, "created_on": "2018-05-09T20:59:01.041462+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-09T20:59:01.065477+00:00", "type": "pullrequest_comment", "id": 63823346}