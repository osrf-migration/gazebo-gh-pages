{"pagelen": 50, "values": [{"update": {"description": "Fixes GpuRaySensor with more than one vertical ray (see issue [#946](#!/osrf/gazebo/issues/946/gpu-ray-sensor-vertical-ranges)).\r\n\r\nThe configuration is identical to the CPU RaySensor.", "title": "Fix GpuRaySensor vertical rays", "destination": {"commit": {"hash": "b859fe2ecd54", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b859fe2ecd54.json"}, "html": {"href": "#!/osrf/gazebo/commits/b859fe2ecd54"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "57e30c9db01e", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo/commit/57e30c9db01e"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo/commits/57e30c9db01e"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b32c6fe9-b52d-4834-ad2d-4094858afa6e}ts=c_plus_plus"}}, "type": "repository", "name": "gazebo", "full_name": "enwaytech/gazebo", "uuid": "{b32c6fe9-b52d-4834-ad2d-4094858afa6e}"}, "branch": {"name": "gpu_vertical_jacob"}}, "state": "OPEN", "author": {"display_name": "Jacob Seibert", "uuid": "{1b2f445c-78b0-4f05-a62c-681c2ccf481c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D"}, "html": {"href": "https://bitbucket.org/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JS-5.png"}}, "nickname": "jacob", "type": "user", "account_id": "5acdbbdcb783d22b5dadd70b"}, "date": "2018-05-14T08:15:30.799372+00:00"}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64037016.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64037016"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Well, another option is to use a fixed resolution value on one axis and change the other to keep the aspect ratio. This way we can guarantee compatibility. Or we can set this max resolution and that way guarantee that the result from the multiplier is safe.", "markup": "markdown", "html": "<p>Well, another option is to use a fixed resolution value on one axis and change the other to keep the aspect ratio. This way we can guarantee compatibility. Or we can set this max resolution and that way guarantee that the result from the multiplier is safe.</p>", "type": "rendered"}, "created_on": "2018-05-11T18:14:53.358647+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-11T19:36:52.694132+00:00", "type": "pullrequest_comment", "id": 64037016}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64042468.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64042468"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Is it possible to merge with the latest `gazebo7` branch? There are some fixes for our homebrew build there that aren't yet in your branch:\n\n* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=gazebo-ci-pr_any-homebrew-amd64&build=1503)](https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1503/) https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1503/\n\nthanks", "markup": "markdown", "html": "<p>Is it possible to merge with the latest <code>gazebo7</code> branch? There are some fixes for our homebrew build there that aren't yet in your branch:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1503/\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=gazebo-ci-pr_any-homebrew-amd64&amp;build=1503\" /></a> <a href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1503/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/gazebo-ci-pr_any-homebrew-amd64/1503/</a></li>\n</ul>\n<p>thanks</p>", "type": "rendered"}, "created_on": "2018-05-11T19:30:32.249365+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2018-05-11T19:30:32.258345+00:00", "type": "pullrequest_comment", "id": 64042468}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64034510.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64034510"}}, "parent": {"id": 64032241, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64032241.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64032241"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "just need to be careful about the multiplier. We should set an upper limit since different graphics cards have different max texture size support, used to be 2048 or 4096. High-end cards these days have large max size", "markup": "markdown", "html": "<p>just need to be careful about the multiplier. We should set an upper limit since different graphics cards have different max texture size support, used to be 2048 or 4096. High-end cards these days have large max size</p>", "type": "rendered"}, "created_on": "2018-05-11T17:43:21.240061+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2018-05-11T17:43:49.103216+00:00", "type": "pullrequest_comment", "id": 64034510}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64032241.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64032241"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "![Screenshot from 2018-05-11 14-10-30.png](https://bitbucket.org/repo/jgXqbo/images/2991618337-Screenshot%20from%202018-05-11%2014-10-30.png 'Screenshot from 2018-05-11 14-10-30.png')\n\n\u200c\n\nOk, I tested it myself.  It looks much better, you can see the result above. I just multiplied by 10 the resolution for the first image [here](#!/osrf/gazebo/pull-requests/2955/fix-gpuraysensor-vertical-rays/diff#Lgazebo/rendering/GpuLaser.ccF163T161). We can add a parameter and have it harcoded. I haven\u2019t tested how this impact in the performance, but I can see that the FPS drop to 50, and I am using a desktop GTX 1070.\n\n\u200c\n\n\u200c\n\n\u200c", "markup": "markdown", "html": "<p><img alt=\"Screenshot from 2018-05-11 14-10-30.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/2991618337-Screenshot_from_2018-05-11_14-10-30.png\" title=\"Screenshot from 2018-05-11 14-10-30.png\" /></p>\n<p>\u200c</p>\n<p>Ok, I tested it myself.  It looks much better, you can see the result above. I just multiplied by 10 the resolution for the first image <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/pull-requests/2955/fix-gpuraysensor-vertical-rays/diff#Lgazebo/rendering/GpuLaser.ccF163T161\" rel=\"nofollow\">here</a>. We can add a parameter and have it harcoded. I haven\u2019t tested how this impact in the performance, but I can see that the FPS drop to 50, and I am using a desktop GTX 1070.</p>\n<p>\u200c</p>\n<p>\u200c</p>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2018-05-11T17:16:40.729630+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-11T17:16:40.737691+00:00", "type": "pullrequest_comment", "id": 64032241}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64029095.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64029095"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "I suggest we make a multiplier that ensures that the first pass has a minimum resolution of x pixels per degree of the respective field of view angle. x being a hardcoded constant. Then we can see if that is satisfying.\n\nBTW: I also did some profiling today and observed that the GpuRaySensor spent a big amount of time getting parameters out of the SDF inside of loops. I modified the code to improve this and I can push it when I tested it.", "markup": "markdown", "html": "<p>I suggest we make a multiplier that ensures that the first pass has a minimum resolution of x pixels per degree of the respective field of view angle. x being a hardcoded constant. Then we can see if that is satisfying.</p>\n<p>BTW: I also did some profiling today and observed that the GpuRaySensor spent a big amount of time getting parameters out of the SDF inside of loops. I modified the code to improve this and I can push it when I tested it.</p>", "type": "rendered"}, "created_on": "2018-05-11T16:37:18.084080+00:00", "user": {"display_name": "Jacob Seibert", "uuid": "{1b2f445c-78b0-4f05-a62c-681c2ccf481c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D"}, "html": {"href": "https://bitbucket.org/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JS-5.png"}}, "nickname": "jacob", "type": "user", "account_id": "5acdbbdcb783d22b5dadd70b"}, "updated_on": "2018-05-11T16:42:31.573565+00:00", "type": "pullrequest_comment", "id": 64029095}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64029363.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64029363"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Yes, I think that can be a valid approach. Have you tested it?", "markup": "markdown", "html": "<p>Yes, I think that can be a valid approach. Have you tested it?</p>", "type": "rendered"}, "created_on": "2018-05-11T16:40:53.186570+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-11T16:40:53.197571+00:00", "type": "pullrequest_comment", "id": 64029363}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/64018314.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-64018314"}}, "parent": {"id": 63949690, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63949690.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63949690"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "True, I recompiled everything from scratch and I don\u2019t get it anymore.", "markup": "markdown", "html": "<p>True, I recompiled everything from scratch and I don\u2019t get it anymore.</p>", "type": "rendered"}, "created_on": "2018-05-11T14:57:28.758922+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-11T14:57:28.764453+00:00", "type": "pullrequest_comment", "id": 64018314}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63949690.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63949690"}}, "parent": {"id": 63897224, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63897224.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63897224"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "mm weird, I don\u2019t get the test failures too. Does it happen every time for you?", "markup": "markdown", "html": "<p>mm weird, I don\u2019t get the test failures too. Does it happen every time for you?</p>", "type": "rendered"}, "created_on": "2018-05-11T01:13:06.978599+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2018-05-11T01:13:06.984755+00:00", "type": "pullrequest_comment", "id": 63949690}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63897224.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63897224"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Check that you are running INTEGRATION\\_gpu\\_laser. For that you need to enable graphics tests, check the display capabilities in the cmake output. You can force compiling those tests with  \\`-DFORCE\\_GRAPHIC\\_TESTS\\_COMPILATION=True\\` .\n\nMaybe an option is to increase the resolution for the first pass with a constant multiplier in height and width for the resolution.  At least that way we can be sure if that is the issue. After confirm that is the issue we can think in leaving it there. It is not ideal, but we keep consistency with the CPU laser.\n\n\u200c", "markup": "markdown", "html": "<p>Check that you are running INTEGRATION_gpu_laser. For that you need to enable graphics tests, check the display capabilities in the cmake output. You can force compiling those tests with  `-DFORCE_GRAPHIC_TESTS_COMPILATION=True` .</p>\n<p>Maybe an option is to increase the resolution for the first pass with a constant multiplier in height and width for the resolution.  At least that way we can be sure if that is the issue. After confirm that is the issue we can think in leaving it there. It is not ideal, but we keep consistency with the CPU laser.</p>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2018-05-10T14:16:38.752263+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-10T14:16:38.767431+00:00", "type": "pullrequest_comment", "id": 63897224}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63859165.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63859165"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "That's strange because the tests passed yesterday on my machine. I will check it again tomorrow.\n\nYes, the borders look similar for me but this also depends on the resolution. My guess about the saw looking border: I think it is due to the (vertical) resolution of the depth image. At large incident angles (near 90 degrees) there are big depth steps between neighbouring pixels. You can increase the resolution to reduce that effect but I think just because of the way the depth image is computed we can never completely avoid it. \n\n![laser_saw_shape.JPG](data/bitbucket.org/repo/jgXqbo/images/816016077-laser_saw_shape.JPG)\n\nIdeally we would have a parameter to increase the internal resolution of the first pass depth image without changing the resulting scan size. Unfortunately we can't use the \"resolution\" parameter for that without breaking consistency with the CPU laser.\n\nAlternatively one could try to apply smoothing (anti-aliasing?) to the textures mapped for the second pass. But I'm not sure if that is really a good idea. It could also mess up the ranges.", "markup": "markdown", "html": "<p>That's strange because the tests passed yesterday on my machine. I will check it again tomorrow.</p>\n<p>Yes, the borders look similar for me but this also depends on the resolution. My guess about the saw looking border: I think it is due to the (vertical) resolution of the depth image. At large incident angles (near 90 degrees) there are big depth steps between neighbouring pixels. You can increase the resolution to reduce that effect but I think just because of the way the depth image is computed we can never completely avoid it. </p>\n<p><img alt=\"laser_saw_shape.JPG\" src=\"data/bitbucket.org/repo/jgXqbo/images/816016077-laser_saw_shape.JPG\" /></p>\n<p>Ideally we would have a parameter to increase the internal resolution of the first pass depth image without changing the resulting scan size. Unfortunately we can't use the \"resolution\" parameter for that without breaking consistency with the CPU laser.</p>\n<p>Alternatively one could try to apply smoothing (anti-aliasing?) to the textures mapped for the second pass. But I'm not sure if that is really a good idea. It could also mess up the ranges.</p>", "type": "rendered"}, "created_on": "2018-05-10T08:21:01.355457+00:00", "user": {"display_name": "Jacob Seibert", "uuid": "{1b2f445c-78b0-4f05-a62c-681c2ccf481c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D"}, "html": {"href": "https://bitbucket.org/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JS-5.png"}}, "nickname": "jacob", "type": "user", "account_id": "5acdbbdcb783d22b5dadd70b"}, "updated_on": "2018-05-10T08:36:20.378153+00:00", "type": "pullrequest_comment", "id": 63859165}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955/comments/63823346.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955/_/diff#comment-63823346"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}, "content": {"raw": "Hi, Jacob, if I run the INTEGRATION\\_gpu\\_laser test I get:  \n\n    :~/gazebo/build$ ./test/integration/INTEGRATION_gpu_laser \n    [==========] Running 5 tests from 1 test case.\n    [----------] Global test environment set-up.\n    [----------] 5 tests from GPURaySensorTest\n    \n    ....\n    \n    [       OK ] GPURaySensorTest.Heightmap (2084 ms)\n    [ RUN      ] GPURaySensorTest.LaserVertical\n    [Msg] Waiting for master.\n    [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n    [Msg] Publicized address: 172.17.0.2\n    [Dbg] [ServerFixture.cc:207] ServerFixture load in 1.1 seconds, timeout after 600 seconds\n    [Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.079109901099460034, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.43266329169273376,\n    expectedRange evaluates to 0.35355339059327373, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.065850478119853451, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.39836812019348145,\n    expectedRange evaluates to 0.33251764207362799, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.053652972699826496, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.36877107620239258,\n    expectedRange evaluates to 0.31511810350256608, and\n    \n    ....\n    \n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.043081311625098206, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.34375375509262085,\n    expectedRange evaluates to 0.30067244346752264, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.053652764083569726, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.36877086758613586,\n    expectedRange evaluates to 0.31511810350256614, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.065850299305919124, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.39836794137954712,\n    expectedRange evaluates to 0.33251764207362799, and\n    1e-3 evaluates to 0.001.\n    /home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\n    The difference between raySensor->Range(i*samples + mid) and expectedRange is 0.07910975208784804, which exceeds 1e-3, where\n    raySensor->Range(i*samples + mid) evaluates to 0.43266314268112183,\n    expectedRange evaluates to 0.35355339059327379, and\n    1e-3 evaluates to 0.001.\n    [Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n    [  FAILED  ] GPURaySensorTest.LaserVertical (1762 ms)\n    [ RUN      ] GPURaySensorTest.LaserScanResolution\n    [Msg] Waiting for master.\n    [Msg] Connected to gazebo master @ http://127.0.0.1:11345\n    [Msg] Publicized address: 172.17.0.2\n    [Dbg] [ServerFixture.cc:207] ServerFixture load in 1 seconds, timeout after 600 seconds\n    [Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n    [Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n    [       OK ] GPURaySensorTest.LaserScanResolution (1448 ms)\n    [----------] 5 tests from GPURaySensorTest (10228 ms total)\n    \n    [----------] Global test environment tear-down\n    [==========] 5 tests from 1 test case ran. (10228 ms total)\n    [  PASSED  ] 4 tests.\n    [  FAILED  ] 1 test, listed below:\n    [  FAILED  ] GPURaySensorTest.LaserVertical\n\nThis is consistent to what I see in Gazebo using a simple world:  \n  \n![Screenshot from 2018-05-09 16-55-19.png](https://bitbucket.org/repo/jgXqbo/images/1685315280-Screenshot%20from%202018-05-09%2016-55-19.png 'Screenshot from 2018-05-09 16-55-19.png')\n\nWe still have that saw looking border. It is better than we had before, but we still have this issue.  \n  \nDid you have the same results that I had?", "markup": "markdown", "html": "<p>Hi, Jacob, if I run the INTEGRATION_gpu_laser test I get:  </p>\n<div class=\"codehilite\"><pre><span></span>:~/gazebo/build$ ./test/integration/INTEGRATION_gpu_laser \n[==========] Running 5 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 5 tests from GPURaySensorTest\n\n....\n\n[       OK ] GPURaySensorTest.Heightmap (2084 ms)\n[ RUN      ] GPURaySensorTest.LaserVertical\n[Msg] Waiting for master.\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\n[Msg] Publicized address: 172.17.0.2\n[Dbg] [ServerFixture.cc:207] ServerFixture load in 1.1 seconds, timeout after 600 seconds\n[Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.079109901099460034, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.43266329169273376,\nexpectedRange evaluates to 0.35355339059327373, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.065850478119853451, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.39836812019348145,\nexpectedRange evaluates to 0.33251764207362799, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.053652972699826496, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.36877107620239258,\nexpectedRange evaluates to 0.31511810350256608, and\n\n....\n\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.043081311625098206, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.34375375509262085,\nexpectedRange evaluates to 0.30067244346752264, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.053652764083569726, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.36877086758613586,\nexpectedRange evaluates to 0.31511810350256614, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.065850299305919124, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.39836794137954712,\nexpectedRange evaluates to 0.33251764207362799, and\n1e-3 evaluates to 0.001.\n/home/docker/gazebo/test/integration/gpu_laser.cc:465: Failure\nThe difference between raySensor-&gt;Range(i*samples + mid) and expectedRange is 0.07910975208784804, which exceeds 1e-3, where\nraySensor-&gt;Range(i*samples + mid) evaluates to 0.43266314268112183,\nexpectedRange evaluates to 0.35355339059327379, and\n1e-3 evaluates to 0.001.\n[Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n[  FAILED  ] GPURaySensorTest.LaserVertical (1762 ms)\n[ RUN      ] GPURaySensorTest.LaserScanResolution\n[Msg] Waiting for master.\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\n[Msg] Publicized address: 172.17.0.2\n[Dbg] [ServerFixture.cc:207] ServerFixture load in 1 seconds, timeout after 600 seconds\n[Wrn] [msgs.cc:1808] Conversion of sensor type[gpu_ray] not suppported.\n[Dbg] [ServerFixture.cc:133] ServerFixture::Unload\n[       OK ] GPURaySensorTest.LaserScanResolution (1448 ms)\n[----------] 5 tests from GPURaySensorTest (10228 ms total)\n\n[----------] Global test environment tear-down\n[==========] 5 tests from 1 test case ran. (10228 ms total)\n[  PASSED  ] 4 tests.\n[  FAILED  ] 1 test, listed below:\n[  FAILED  ] GPURaySensorTest.LaserVertical\n</pre></div>\n\n\n<p>This is consistent to what I see in Gazebo using a simple world:  </p>\n<p><img alt=\"Screenshot from 2018-05-09 16-55-19.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/1685315280-Screenshot_from_2018-05-09_16-55-19.png\" title=\"Screenshot from 2018-05-09 16-55-19.png\" /></p>\n<p>We still have that saw looking border. It is better than we had before, but we still have this issue.  </p>\n<p>Did you have the same results that I had?</p>", "type": "rendered"}, "created_on": "2018-05-09T20:59:01.041462+00:00", "user": {"display_name": "Javier Iv\u00e1n Choclin", "uuid": "{745acb37-6a3b-4169-8ba9-2c142a7408fb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D"}, "html": {"href": "https://bitbucket.org/%7B745acb37-6a3b-4169-8ba9-2c142a7408fb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2279399d-3c75-4e1e-b818-4fb8339b2939/26f5815d-5477-4106-ba9b-ac56ee23e175/128"}}, "nickname": "Javier Choclin", "type": "user", "account_id": "557058:2279399d-3c75-4e1e-b818-4fb8339b2939"}, "updated_on": "2018-05-09T20:59:01.065477+00:00", "type": "pullrequest_comment", "id": 63823346}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"update": {"description": "Fixes GpuRaySensor with more than one vertical ray (see issue [#946](#!/osrf/gazebo/issues/946/gpu-ray-sensor-vertical-ranges)).\r\n\r\nThe configuration is identical to the CPU RaySensor.", "title": "Fix GpuRaySensor vertical rays", "destination": {"commit": {"hash": "b859fe2ecd54", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b859fe2ecd54.json"}, "html": {"href": "#!/osrf/gazebo/commits/b859fe2ecd54"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "b3defd821a84", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo/commit/b3defd821a84"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo/commits/b3defd821a84"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b32c6fe9-b52d-4834-ad2d-4094858afa6e}ts=c_plus_plus"}}, "type": "repository", "name": "gazebo", "full_name": "enwaytech/gazebo", "uuid": "{b32c6fe9-b52d-4834-ad2d-4094858afa6e}"}, "branch": {"name": "gpu_vertical_jacob"}}, "state": "OPEN", "author": {"display_name": "Jacob Seibert", "uuid": "{1b2f445c-78b0-4f05-a62c-681c2ccf481c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D"}, "html": {"href": "https://bitbucket.org/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JS-5.png"}}, "nickname": "jacob", "type": "user", "account_id": "5acdbbdcb783d22b5dadd70b"}, "date": "2018-05-09T12:19:47.304894+00:00"}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}, {"update": {"description": "Fixes GpuRaySensor with more than one vertical ray (see issue [#946](#!/osrf/gazebo/issues/946/gpu-ray-sensor-vertical-ranges)).\r\n\r\nThe configuration is identical to the CPU RaySensor.", "title": "Fix GpuRaySensor vertical rays", "destination": {"commit": {"hash": "b859fe2ecd54", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/gazebo/commit/b859fe2ecd54.json"}, "html": {"href": "#!/osrf/gazebo/commits/b859fe2ecd54"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "branch": {"name": "gazebo7"}}, "reason": "", "source": {"commit": {"hash": "b3defd821a84", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo/commit/b3defd821a84"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo/commits/b3defd821a84"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/enwaytech/gazebo"}, "html": {"href": "https://bitbucket.org/enwaytech/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b32c6fe9-b52d-4834-ad2d-4094858afa6e}ts=c_plus_plus"}}, "type": "repository", "name": "gazebo", "full_name": "enwaytech/gazebo", "uuid": "{b32c6fe9-b52d-4834-ad2d-4094858afa6e}"}, "branch": {"name": "gpu_vertical_jacob"}}, "state": "OPEN", "author": {"display_name": "Jacob Seibert", "uuid": "{1b2f445c-78b0-4f05-a62c-681c2ccf481c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D"}, "html": {"href": "https://bitbucket.org/%7B1b2f445c-78b0-4f05-a62c-681c2ccf481c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JS-5.png"}}, "nickname": "jacob", "type": "user", "account_id": "5acdbbdcb783d22b5dadd70b"}, "date": "2018-05-09T12:19:47.238213+00:00"}, "pull_request": {"type": "pullrequest", "id": 2955, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2955.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2955"}}, "title": "Fix GpuRaySensor vertical rays"}}]}