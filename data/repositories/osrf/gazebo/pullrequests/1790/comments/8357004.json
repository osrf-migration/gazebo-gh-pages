{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1790/comments/8357004.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1790/_/diff#comment-8357004"}}, "parent": {"id": 8354482, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1790/comments/8354482.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1790/_/diff#comment-8354482"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 1790, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/1790.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/1790"}}, "title": "Fix event segfault"}, "content": {"raw": "on OS X, gzclient seg-faults ([full backtrace here](https://gist.github.com/scpeters/3013a670e28cfd0027dc)):\n\n~~~\n* thread #1: tid = 0xaf4ce, 0x000000010160ce58 libgazebo_rendering.6.dylib`gazebo::rendering::Visual::Update(this=0x0000000121eb7b80) + 24 at Visual.cc:487, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x80)\n    frame #0: 0x000000010160ce58 libgazebo_rendering.6.dylib`gazebo::rendering::Visual::Update(this=0x0000000121eb7b80) + 24 at Visual.cc:487\n   484 \t//////////////////////////////////////////////////\n   485 \tvoid Visual::Update()\n   486 \t{\n-> 487 \t  if (!this->dataPtr->visible)\n   488 \t    return;\n   489 \t\n   490 \t  std::list<DynamicLines*>::iterator iter;\n(lldb) bt\n* thread #1: tid = 0xaf4ce, 0x000000010160ce58 libgazebo_rendering.6.dylib`gazebo::rendering::Visual::Update(this=0x0000000121eb7b80) + 24 at Visual.cc:487, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x80)\n  * frame #0: 0x000000010160ce58 libgazebo_rendering.6.dylib`gazebo::rendering::Visual::Update(this=0x0000000121eb7b80) + 24 at Visual.cc:487\n    frame #1: 0x00000001000720df libgazebo_gui.6.dylib`gazebo::event::EventT<void ()>::Signal() [inlined] boost::function0<void>::operator()() const + 95 at function_template.hpp:772\n    frame #2: 0x00000001000720c5 libgazebo_gui.6.dylib`gazebo::event::EventT<void ()>::Signal(this=<unavailable>) + 69 at Event.hh:341\n    frame #3: 0x0000000100069a98 libgazebo_gui.6.dylib`gazebo::gui::GLWidget::paintEvent(QPaintEvent*) [inlined] gazebo::event::EventT<void ()>::operator(this=<unavailable>)() + 56 at Event.hh:187\n    frame #4: 0x0000000100069a8c libgazebo_gui.6.dylib`gazebo::gui::GLWidget::paintEvent(this=0x00000001068b3000, _e=0x00007fff5fbf94b0) + 44 at GLWidget.cc:272\n\n~~~", "markup": "markdown", "html": "<p>on OS X, gzclient seg-faults (<a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/3013a670e28cfd0027dc\" rel=\"nofollow\">full backtrace here</a>):</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"o\">*</span> <span class=\"nt\">thread</span> <span class=\"p\">#</span><span class=\"nn\">1</span><span class=\"o\">:</span> <span class=\"nt\">tid</span> <span class=\"o\">=</span> <span class=\"nt\">0xaf4ce</span><span class=\"o\">,</span> <span class=\"nt\">0x000000010160ce58</span> <span class=\"nt\">libgazebo_rendering</span><span class=\"p\">.</span><span class=\"nc\">6</span><span class=\"p\">.</span><span class=\"nc\">dylib</span><span class=\"err\">`</span><span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">rendering</span><span class=\"p\">::</span><span class=\"nd\">Visual</span><span class=\"p\">::</span><span class=\"nd\">Update</span><span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x0000000121eb7b80</span><span class=\"o\">)</span> <span class=\"o\">+</span> <span class=\"nt\">24</span> <span class=\"nt\">at</span> <span class=\"nt\">Visual</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"p\">:</span><span class=\"nd\">487</span><span class=\"o\">,</span> <span class=\"nt\">queue</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;com.apple.main-thread&#39;</span><span class=\"o\">,</span> <span class=\"nt\">stop</span> <span class=\"nt\">reason</span> <span class=\"o\">=</span> <span class=\"nt\">EXC_BAD_ACCESS</span> <span class=\"o\">(</span><span class=\"nt\">code</span><span class=\"o\">=</span><span class=\"nt\">1</span><span class=\"o\">,</span> <span class=\"nt\">address</span><span class=\"o\">=</span><span class=\"nt\">0x80</span><span class=\"o\">)</span>\n    <span class=\"nt\">frame</span> <span class=\"p\">#</span><span class=\"nn\">0</span><span class=\"o\">:</span> <span class=\"nt\">0x000000010160ce58</span> <span class=\"nt\">libgazebo_rendering</span><span class=\"p\">.</span><span class=\"nc\">6</span><span class=\"p\">.</span><span class=\"nc\">dylib</span><span class=\"err\">`</span><span class=\"nt\">gazebo</span><span class=\"p\">::</span><span class=\"nd\">rendering</span><span class=\"p\">::</span><span class=\"nd\">Visual</span><span class=\"p\">::</span><span class=\"nd\">Update</span><span class=\"o\">(</span><span class=\"nt\">this</span><span class=\"o\">=</span><span class=\"nt\">0x0000000121eb7b80</span><span class=\"o\">)</span> <span class=\"o\">+</span> <span class=\"nt\">24</span> <span class=\"nt\">at</span> <span class=\"nt\">Visual</span><span class=\"p\">.</span><span class=\"nc\">cc</span><span class=\"p\">:</span><span class=\"nd\">487</span>\n   <span class=\"nt\">484</span>  <span class=\"o\">//////////////////////////////////////////////////</span>\n   <span class=\"nt\">485</span>  <span class=\"nt\">void</span> <span class=\"nt\">Visual</span><span class=\"p\">::</span><span class=\"nd\">Update</span><span class=\"o\">()</span>\n   <span class=\"nt\">486</span>  <span class=\"p\">{</span>\n<span class=\"err\">-&gt;</span> <span class=\"err\">487</span>    <span class=\"err\">if</span> <span class=\"err\">(!this-&gt;dataPtr-&gt;visible)</span>\n   <span class=\"err\">488</span>      <span class=\"err\">return</span><span class=\"p\">;</span>\n   <span class=\"err\">489</span>  \n   <span class=\"err\">490</span>    <span class=\"n\">std</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">list</span><span class=\"o\">&lt;</span><span class=\"n\">DynamicLines</span><span class=\"o\">*&gt;::</span><span class=\"n\">iterator</span> <span class=\"n\">iter</span><span class=\"p\">;</span>\n<span class=\"err\">(lldb)</span> <span class=\"err\">bt</span>\n<span class=\"err\">*</span> <span class=\"err\">thread</span> <span class=\"err\">#1:</span> <span class=\"err\">tid</span> <span class=\"err\">=</span> <span class=\"err\">0xaf4ce,</span> <span class=\"err\">0x000000010160ce58</span> <span class=\"err\">libgazebo_rendering.6.dylib`</span><span class=\"n\">gazebo</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">rendering</span><span class=\"o\">::</span><span class=\"n\">Visual</span><span class=\"o\">::</span><span class=\"nf\">Update</span><span class=\"p\">(</span><span class=\"n\">this</span><span class=\"err\">=</span><span class=\"mi\">0</span><span class=\"n\">x0000000121eb7b80</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">24</span> <span class=\"n\">at</span> <span class=\"n\">Visual</span><span class=\"o\">.</span><span class=\"n\">cc</span><span class=\"o\">:</span><span class=\"mi\">487</span><span class=\"p\">,</span> <span class=\"n\">queue</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;com.apple.main-thread&#39;</span><span class=\"p\">,</span> <span class=\"n\">stop</span> <span class=\"n\">reason</span> <span class=\"o\">=</span> <span class=\"n\">EXC_BAD_ACCESS</span> <span class=\"p\">(</span><span class=\"n\">code</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">address</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"n\">x80</span><span class=\"p\">)</span>\n  <span class=\"o\">*</span> <span class=\"n\">frame</span> <span class=\"mh\">#0</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">x000000010160ce58</span> <span class=\"n\">libgazebo_rendering</span><span class=\"mf\">.6</span><span class=\"o\">.</span><span class=\"n\">dylib</span><span class=\"err\">`</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">rendering</span><span class=\"o\">::</span><span class=\"n\">Visual</span><span class=\"o\">::</span><span class=\"nf\">Update</span><span class=\"p\">(</span><span class=\"n\">this</span><span class=\"err\">=</span><span class=\"mi\">0</span><span class=\"n\">x0000000121eb7b80</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">24</span> <span class=\"n\">at</span> <span class=\"n\">Visual</span><span class=\"o\">.</span><span class=\"n\">cc</span><span class=\"o\">:</span><span class=\"mi\">487</span>\n    <span class=\"n\">frame</span> <span class=\"mh\">#1</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">x00000001000720df</span> <span class=\"n\">libgazebo_gui</span><span class=\"mf\">.6</span><span class=\"o\">.</span><span class=\"n\">dylib</span><span class=\"err\">`</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">event</span><span class=\"o\">::</span><span class=\"n\">EventT</span><span class=\"o\">&lt;</span><span class=\"n\">void</span> <span class=\"p\">()</span><span class=\"o\">&gt;::</span><span class=\"nf\">Signal</span><span class=\"p\">()</span> <span class=\"cp\">[</span><span class=\"nx\">inlined</span><span class=\"cp\">]</span> <span class=\"n\">boost</span><span class=\"o\">::</span><span class=\"n\">function0</span><span class=\"o\">&lt;</span><span class=\"n\">void</span><span class=\"o\">&gt;::</span><span class=\"nf\">operator</span><span class=\"p\">()()</span> <span class=\"n\">const</span> <span class=\"o\">+</span> <span class=\"mi\">95</span> <span class=\"n\">at</span> <span class=\"n\">function_template</span><span class=\"o\">.</span><span class=\"n\">hpp</span><span class=\"o\">:</span><span class=\"mi\">772</span>\n    <span class=\"n\">frame</span> <span class=\"mh\">#2</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">x00000001000720c5</span> <span class=\"n\">libgazebo_gui</span><span class=\"mf\">.6</span><span class=\"o\">.</span><span class=\"n\">dylib</span><span class=\"err\">`</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">event</span><span class=\"o\">::</span><span class=\"n\">EventT</span><span class=\"o\">&lt;</span><span class=\"n\">void</span> <span class=\"p\">()</span><span class=\"o\">&gt;::</span><span class=\"nf\">Signal</span><span class=\"p\">(</span><span class=\"n\">this</span><span class=\"err\">=&lt;</span><span class=\"n\">unavailable</span><span class=\"err\">&gt;</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">69</span> <span class=\"n\">at</span> <span class=\"n\">Event</span><span class=\"o\">.</span><span class=\"n\">hh</span><span class=\"o\">:</span><span class=\"mi\">341</span>\n    <span class=\"n\">frame</span> <span class=\"mh\">#3</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">x0000000100069a98</span> <span class=\"n\">libgazebo_gui</span><span class=\"mf\">.6</span><span class=\"o\">.</span><span class=\"n\">dylib</span><span class=\"err\">`</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">gui</span><span class=\"o\">::</span><span class=\"n\">GLWidget</span><span class=\"o\">::</span><span class=\"nf\">paintEvent</span><span class=\"p\">(</span><span class=\"n\">QPaintEvent</span><span class=\"o\">*</span><span class=\"p\">)</span> <span class=\"cp\">[</span><span class=\"nx\">inlined</span><span class=\"cp\">]</span> <span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">event</span><span class=\"o\">::</span><span class=\"n\">EventT</span><span class=\"o\">&lt;</span><span class=\"n\">void</span> <span class=\"p\">()</span><span class=\"o\">&gt;::</span><span class=\"nf\">operator</span><span class=\"p\">(</span><span class=\"n\">this</span><span class=\"err\">=&lt;</span><span class=\"n\">unavailable</span><span class=\"err\">&gt;</span><span class=\"p\">)()</span> <span class=\"o\">+</span> <span class=\"mi\">56</span> <span class=\"n\">at</span> <span class=\"n\">Event</span><span class=\"o\">.</span><span class=\"n\">hh</span><span class=\"o\">:</span><span class=\"mi\">187</span>\n    <span class=\"n\">frame</span> <span class=\"mh\">#4</span><span class=\"o\">:</span> <span class=\"mi\">0</span><span class=\"n\">x0000000100069a8c</span> <span class=\"n\">libgazebo_gui</span><span class=\"mf\">.6</span><span class=\"o\">.</span><span class=\"n\">dylib</span><span class=\"err\">`</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">gui</span><span class=\"o\">::</span><span class=\"n\">GLWidget</span><span class=\"o\">::</span><span class=\"nf\">paintEvent</span><span class=\"p\">(</span><span class=\"n\">this</span><span class=\"err\">=</span><span class=\"mi\">0</span><span class=\"n\">x00000001068b3000</span><span class=\"p\">,</span> <span class=\"n\">_e</span><span class=\"err\">=</span><span class=\"mi\">0</span><span class=\"n\">x00007fff5fbf94b0</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">44</span> <span class=\"n\">at</span> <span class=\"n\">GLWidget</span><span class=\"o\">.</span><span class=\"n\">cc</span><span class=\"o\">:</span><span class=\"mi\">272</span>\n</pre></div>", "type": "rendered"}, "created_on": "2015-07-18T04:21:42.647054+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-07-18T04:21:42.659192+00:00", "type": "pullrequest_comment", "id": 8357004}