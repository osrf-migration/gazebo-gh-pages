{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2118/comments/14755795.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/diff/osrf/gazebo:None..None?path=gazebo%2Fmsgs%2Fgps_sensor.proto"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2118/_/diff#comment-14755795"}}, "parent": {"id": 14723733, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2118/comments/14723733.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2118/_/diff#comment-14723733"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 2118, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/2118.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/2118"}}, "title": "Added more sensor messages"}, "content": {"raw": "Protobuf messages and XML have different purposes and different syntax. Nesting in XML is useful for readability, but nesting in a message doesn't buy us much. We'd have an extra layer of messages that would have to be transmitted over the wire, and any code would also become more complex.\n\nExample:\n\n```\nmessage GPSSensor\n{ \n  message PositionSensing\n  {\n    message Horizontal\n    {\n      optional SensorNoise noise = 1;\n    }\n    optional Horizontal horizontal = 1;\n  }\n\n  optional PositionSensing position = 1;\n}\n\n```\n\nTo use this, we'd have to write (note that every level of nesting is now reflected in the code that uses the message):\n\n```\nif (msg.has_position())\n{\n  msgs::GPSensor::PositionSensing &pos = msg.position();\n  if (pos.has_horizontal())\n  {\n    msgs::GPSensor::PositionSensing::Horizontal &horz = pos.horizontal();\n    if (horz.has_noise())\n    {\n      msgs::GPSensor::PositionSensing::SensorNoise *noise = horz.noise();\n    }\n  }\n}\n```\n\nWe could make the change, but it feels like extra complexity for marginal benefit.", "markup": "markdown", "html": "<p>Protobuf messages and XML have different purposes and different syntax. Nesting in XML is useful for readability, but nesting in a message doesn't buy us much. We'd have an extra layer of messages that would have to be transmitted over the wire, and any code would also become more complex.</p>\n<p>Example:</p>\n<div class=\"codehilite\"><pre><span></span>message GPSSensor\n{ \n  message PositionSensing\n  {\n    message Horizontal\n    {\n      optional SensorNoise noise = 1;\n    }\n    optional Horizontal horizontal = 1;\n  }\n\n  optional PositionSensing position = 1;\n}\n</pre></div>\n\n\n<p>To use this, we'd have to write (note that every level of nesting is now reflected in the code that uses the message):</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">if</span> <span class=\"o\">(</span><span class=\"nt\">msg</span><span class=\"p\">.</span><span class=\"nc\">has_position</span><span class=\"o\">())</span>\n<span class=\"p\">{</span>\n  <span class=\"n\">msgs</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">GPSensor</span><span class=\"o\">::</span><span class=\"n\">PositionSensing</span> <span class=\"o\">&amp;</span><span class=\"n\">pos</span> <span class=\"o\">=</span> <span class=\"n\">msg</span><span class=\"o\">.</span><span class=\"nf\">position</span><span class=\"p\">();</span>\n  <span class=\"err\">if</span> <span class=\"err\">(pos.has_horizontal())</span>\n  <span class=\"err\">{</span>\n    <span class=\"n\">msgs</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">GPSensor</span><span class=\"o\">::</span><span class=\"n\">PositionSensing</span><span class=\"o\">::</span><span class=\"n\">Horizontal</span> <span class=\"o\">&amp;</span><span class=\"n\">horz</span> <span class=\"o\">=</span> <span class=\"n\">pos</span><span class=\"o\">.</span><span class=\"nf\">horizontal</span><span class=\"p\">();</span>\n    <span class=\"err\">if</span> <span class=\"err\">(horz.has_noise())</span>\n    <span class=\"err\">{</span>\n      <span class=\"n\">msgs</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">GPSensor</span><span class=\"o\">::</span><span class=\"n\">PositionSensing</span><span class=\"o\">::</span><span class=\"n\">SensorNoise</span> <span class=\"o\">*</span><span class=\"n\">noise</span> <span class=\"o\">=</span> <span class=\"n\">horz</span><span class=\"o\">.</span><span class=\"nf\">noise</span><span class=\"p\">();</span>\n    <span class=\"p\">}</span>\n  <span class=\"err\">}</span>\n<span class=\"err\">}</span>\n</pre></div>\n\n\n<p>We could make the change, but it feels like extra complexity for marginal benefit.</p>", "type": "rendered"}, "created_on": "2016-02-18T16:02:43.530360+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {"to": null, "from": null, "outdated": false, "path": "gazebo/msgs/gps_sensor.proto"}, "updated_on": "2016-02-18T16:02:43.534099+00:00", "type": "pullrequest_comment", "id": 14755795}