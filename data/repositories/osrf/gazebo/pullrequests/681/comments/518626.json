{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/681/comments/518626.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/681/_/diff#comment-518626"}}, "parent": {"id": 518526, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/681/comments/518526.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/681/_/diff#comment-518526"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 681, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/681.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/681"}}, "title": "GNUInstalldir support - Fix to cmake/pkgconfig"}, "content": {"raw": "The answer is the different support in GNUInstallDirs for precise/quantal. See the difference (no multiarch support in precise):\n\n```\n#!diff\n--- GNUInstallDirs.cmake\t2012-08-09 20:15:19.000000000 +0200\n+++ /srv/chroot/precise/usr/share/cmake-2.8/Modules/GNUInstallDirs.cmake\t2011-12-30 17:49:56.000000000 +0100\n@@ -11,7 +11,7 @@\n #  SYSCONFDIR       - read-only single-machine data (etc)\n #  SHAREDSTATEDIR   - modifiable architecture-independent data (com)\n #  LOCALSTATEDIR    - modifiable single-machine data (var)\n-#  LIBDIR           - object code libraries (lib or lib64 or lib/<multiarch-tuple> on Debian)\n+#  LIBDIR           - object code libraries (lib or lib64)\n #  INCLUDEDIR       - C header files (include)\n #  OLDINCLUDEDIR    - C header files for non-gcc (/usr/include)\n #  DATAROOTDIR      - read-only architecture-independent data root (share)\n@@ -75,24 +75,18 @@\n   #  - we are NOT on debian\n   #  - we are on a 64 bits system\n   # reason is: amd64 ABI: http://www.x86-64.org/documentation/abi.pdf\n-  # For Debian with multiarch, use 'lib/${CMAKE_LIBRARY_ARCHITECTURE}' if\n-  # CMAKE_LIBRARY_ARCHITECTURE is set (which contains e.g. \"i386-linux-gnu\"\n-  # See http://wiki.debian.org/Multiarch\n+  # Note that the future of multi-arch handling may be even\n+  # more complicated than that: http://wiki.debian.org/Multiarch\n   if(CMAKE_SYSTEM_NAME MATCHES \"Linux\"\n-      AND NOT CMAKE_CROSSCOMPILING)\n-    if (EXISTS \"/etc/debian_version\") # is this a debian system ?\n-       if(CMAKE_LIBRARY_ARCHITECTURE)\n-         set(_LIBDIR_DEFAULT \"lib/${CMAKE_LIBRARY_ARCHITECTURE}\")\n-       endif()\n-    else() # not debian, rely on CMAKE_SIZEOF_VOID_P:\n-      if(NOT DEFINED CMAKE_SIZEOF_VOID_P)\n-        message(AUTHOR_WARNING\n-          \"Unable to determine default CMAKE_INSTALL_LIBDIR directory because no target architecture is known. \"\n-          \"Please enable at least one language before including GNUInstallDirs.\")\n-      else()\n-        if(\"${CMAKE_SIZEOF_VOID_P}\" EQUAL \"8\")\n-          set(_LIBDIR_DEFAULT \"lib64\")\n-        endif()\n+      AND NOT CMAKE_CROSSCOMPILING\n+      AND NOT EXISTS \"/etc/debian_version\")\n+    if(NOT DEFINED CMAKE_SIZEOF_VOID_P)\n+      message(AUTHOR_WARNING\n+        \"Unable to determine default CMAKE_INSTALL_LIBDIR directory because no target architecture is known. \"\n+        \"Please enable at least one language before including GNUInstallDirs.\")\n+    else()\n+      if(\"${CMAKE_SIZEOF_VOID_P}\" EQUAL \"8\")\n+        set(_LIBDIR_DEFAULT \"lib64\")\n       endif()\n     endif()\n   endif()\n```", "markup": "markdown", "html": "<p>The answer is the different support in GNUInstallDirs for precise/quantal. See the difference (no multiarch support in precise):</p>\n<div class=\"codehilite language-diff\"><pre><span></span><span class=\"gd\">--- GNUInstallDirs.cmake    2012-08-09 20:15:19.000000000 +0200</span>\n<span class=\"gi\">+++ /srv/chroot/precise/usr/share/cmake-2.8/Modules/GNUInstallDirs.cmake    2011-12-30 17:49:56.000000000 +0100</span>\n<span class=\"gu\">@@ -11,7 +11,7 @@</span>\n #  SYSCONFDIR       - read-only single-machine data (etc)\n #  SHAREDSTATEDIR   - modifiable architecture-independent data (com)\n #  LOCALSTATEDIR    - modifiable single-machine data (var)\n<span class=\"gd\">-#  LIBDIR           - object code libraries (lib or lib64 or lib/&lt;multiarch-tuple&gt; on Debian)</span>\n<span class=\"gi\">+#  LIBDIR           - object code libraries (lib or lib64)</span>\n #  INCLUDEDIR       - C header files (include)\n #  OLDINCLUDEDIR    - C header files for non-gcc (/usr/include)\n #  DATAROOTDIR      - read-only architecture-independent data root (share)\n<span class=\"gu\">@@ -75,24 +75,18 @@</span>\n   #  - we are NOT on debian\n   #  - we are on a 64 bits system\n   # reason is: amd64 ABI: http://www.x86-64.org/documentation/abi.pdf\n<span class=\"gd\">-  # For Debian with multiarch, use &#39;lib/${CMAKE_LIBRARY_ARCHITECTURE}&#39; if</span>\n<span class=\"gd\">-  # CMAKE_LIBRARY_ARCHITECTURE is set (which contains e.g. &quot;i386-linux-gnu&quot;</span>\n<span class=\"gd\">-  # See http://wiki.debian.org/Multiarch</span>\n<span class=\"gi\">+  # Note that the future of multi-arch handling may be even</span>\n<span class=\"gi\">+  # more complicated than that: http://wiki.debian.org/Multiarch</span>\n   if(CMAKE_SYSTEM_NAME MATCHES &quot;Linux&quot;\n<span class=\"gd\">-      AND NOT CMAKE_CROSSCOMPILING)</span>\n<span class=\"gd\">-    if (EXISTS &quot;/etc/debian_version&quot;) # is this a debian system ?</span>\n<span class=\"gd\">-       if(CMAKE_LIBRARY_ARCHITECTURE)</span>\n<span class=\"gd\">-         set(_LIBDIR_DEFAULT &quot;lib/${CMAKE_LIBRARY_ARCHITECTURE}&quot;)</span>\n<span class=\"gd\">-       endif()</span>\n<span class=\"gd\">-    else() # not debian, rely on CMAKE_SIZEOF_VOID_P:</span>\n<span class=\"gd\">-      if(NOT DEFINED CMAKE_SIZEOF_VOID_P)</span>\n<span class=\"gd\">-        message(AUTHOR_WARNING</span>\n<span class=\"gd\">-          &quot;Unable to determine default CMAKE_INSTALL_LIBDIR directory because no target architecture is known. &quot;</span>\n<span class=\"gd\">-          &quot;Please enable at least one language before including GNUInstallDirs.&quot;)</span>\n<span class=\"gd\">-      else()</span>\n<span class=\"gd\">-        if(&quot;${CMAKE_SIZEOF_VOID_P}&quot; EQUAL &quot;8&quot;)</span>\n<span class=\"gd\">-          set(_LIBDIR_DEFAULT &quot;lib64&quot;)</span>\n<span class=\"gd\">-        endif()</span>\n<span class=\"gi\">+      AND NOT CMAKE_CROSSCOMPILING</span>\n<span class=\"gi\">+      AND NOT EXISTS &quot;/etc/debian_version&quot;)</span>\n<span class=\"gi\">+    if(NOT DEFINED CMAKE_SIZEOF_VOID_P)</span>\n<span class=\"gi\">+      message(AUTHOR_WARNING</span>\n<span class=\"gi\">+        &quot;Unable to determine default CMAKE_INSTALL_LIBDIR directory because no target architecture is known. &quot;</span>\n<span class=\"gi\">+        &quot;Please enable at least one language before including GNUInstallDirs.&quot;)</span>\n<span class=\"gi\">+    else()</span>\n<span class=\"gi\">+      if(&quot;${CMAKE_SIZEOF_VOID_P}&quot; EQUAL &quot;8&quot;)</span>\n<span class=\"gi\">+        set(_LIBDIR_DEFAULT &quot;lib64&quot;)</span>\n       endif()\n     endif()\n   endif()\n</pre></div>", "type": "rendered"}, "created_on": "2013-08-30T17:55:07.607423+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": "2013-08-30T17:55:07.616678+00:00", "type": "pullrequest_comment", "id": 518626}