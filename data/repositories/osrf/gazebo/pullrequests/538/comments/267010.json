{"links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/538/comments/267010.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/538/_/diff#comment-267010"}}, "parent": {"id": 266897, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/538/comments/266897.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/538/_/diff#comment-266897"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 538, "links": {"self": {"href": "data/repositories/osrf/gazebo/pullrequests/538.json"}, "html": {"href": "#!/osrf/gazebo/pull-requests/538"}}, "title": "reverting some of the performance changes to fix DropStuff test (lambda_erp will be computed everytime)."}, "content": {"raw": "I think the problem there is that interpenetration correction is feeding back into system force solutions.  This should fix it:\n\n~~~\ndiff -r e53015d879c9 test/regression/contact_sensor.cc\n--- a/test/regression/contact_sensor.cc\tWed May 22 12:46:08 2013 -0700\n+++ b/test/regression/contact_sensor.cc\tWed May 22 17:12:30 2013 -0700\n@@ -320,6 +320,10 @@\n \n   msgs::Contacts contacts;\n \n+  physics::PhysicsEnginePtr physicsEngine = world->GetPhysicsEngine();\n+  EXPECT_TRUE(physicsEngine);\n+  physicsEngine->SetContactMaxCorrectingVel(0);\n+\n   world->StepWorld(1);\n \n   // run simulation until contacts occur\n~~~\n\ndo you want me to incorporate this fix?", "markup": "markdown", "html": "<p>I think the problem there is that interpenetration correction is feeding back into system force solutions.  This should fix it:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r e53015d879c9 test/regression/contact_sensor.cc</span>\n<span class=\"gd\">--- a/test/regression/contact_sensor.cc Wed May 22 12:46:08 2013 -0700</span>\n<span class=\"gi\">+++ b/test/regression/contact_sensor.cc Wed May 22 17:12:30 2013 -0700</span>\n<span class=\"gu\">@@ -320,6 +320,10 @@</span>\n\n   msgs::Contacts contacts;\n\n<span class=\"gi\">+  physics::PhysicsEnginePtr physicsEngine = world-&gt;GetPhysicsEngine();</span>\n<span class=\"gi\">+  EXPECT_TRUE(physicsEngine);</span>\n<span class=\"gi\">+  physicsEngine-&gt;SetContactMaxCorrectingVel(0);</span>\n<span class=\"gi\">+</span>\n   world-&gt;StepWorld(1);\n\n   // run simulation until contacts occur\n</pre></div>\n\n\n<p>do you want me to incorporate this fix?</p>", "type": "rendered"}, "created_on": "2013-05-23T00:12:12.401577+00:00", "user": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "updated_on": "2013-05-23T00:13:48.423451+00:00", "type": "pullrequest_comment", "id": 267010}