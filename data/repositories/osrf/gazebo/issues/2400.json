{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2400/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2400.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2400/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2400/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2400/contact-problem-between-a-pushrod-and"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2400/vote"}}, "reporter": {"display_name": "Mohit Mehndiratta", "uuid": "{61b3aa2f-6e8f-4b08-95be-f569ef6c0e4e}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B61b3aa2f-6e8f-4b08-95be-f569ef6c0e4e%7D"}, "html": {"href": "https://bitbucket.org/%7B61b3aa2f-6e8f-4b08-95be-f569ef6c0e4e%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/83d06ffed308ca8d4981e279d0544b35d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMM-1.png"}}, "nickname": "mohit005", "type": "user", "account_id": "5a5b8f2463086069b1d529e3"}, "title": "Contact problem between a pushrod and suspended weight.", "component": {"name": "physics::ODEPhysics", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/122883.json"}}}, "votes": 1, "watches": 2, "content": {"raw": "Dear Gazebo Community,\r\n\r\nI am in the process of developing a gazebo model of a UAV that incorporates a mechanism to drop certain weight blocks. All the weight blocks are designed with hooks which are positioned within slots enclosed at the bottom of the UAV base.  The linear motion of the pushrod (controlled via gazebo plugin) opens the interlocking for the blocks (as visualized from Fig.).\r\nWhile running the simulation, the problem that I am encountering is the wobbly/bouncy motion of the weight block when it is suspended from the pushrod. Even the pushrod oscillates back and forth, which eventually opens the interlocking for the hook and it gets dropped even without commanding. I suspect the problem lies within the contact definition between the weight block and the pushrod. Whenever a contact is detected, a significant reaction force is applied to the hook of the weight block that results in its bouncy motion. I tried increasing damping for the contact by changing  <kp> and <kd>  parameters within the <contact> tag of the sdf file, but with no success. Another thing that I noticed, when I make the pushrod joint to be 'fixed' (by specifying zero values for <upper> and <lower> limits), the weight block although oscillates, but does not get dropped. To me it implied that there might be something wrong with the controller of the pushrod. So, I tried playing with the PID parameters but still it didn't solve the problem. After few moments of hover flight, the block drops due to rapid wobbling. Below is the snippet of my sdf code for the pushrod and weight block definitions:\r\n\r\n**Pushrod SDF**\r\n<link name='push_rod_link'>\r\n      <pose frame=''>0.06807 0 -0.04150 0 0 0</pose>\r\n      <inertial>\r\n        <pose frame=''>-0.08 0 0 0 0 0</pose>\r\n        <mass>0.130</mass>\r\n        <inertia>\r\n          <ixx>3.741E-06</ixx>\r\n          <ixy>0</ixy>\r\n          <ixz>0</ixz>\r\n          <iyy>7.658E-04</iyy>\r\n          <iyz>0</iyz>\r\n          <izz>7.658E-04</izz>\r\n        </inertia>\r\n      </inertial>\r\n      <collision name='push_rod_link_collision'>\r\n        <pose frame=''>0 0 0 0 0 0</pose>\r\n        <geometry>\r\n          <mesh>\r\n\t    <scale>1 1 1</scale>\r\n            <uri>model://tricopter_weightdrop/meshes/Push_Rod.STL</uri>\r\n\t  </mesh>\r\n        </geometry>\r\n        <surface>\r\n          <contact>\r\n            <ode/>\r\n          </contact>\r\n          <friction>\r\n            <ode>\r\n\t      <mu>1</mu>\r\n\t      <mu2>1</mu2>\r\n\t    </ode>\r\n          </friction>\r\n        </surface>\r\n      </collision>\r\n      <visual name='push_rod_link_visual'>\r\n        <pose frame=''>0 0 0 0 0 0</pose>\r\n        <geometry>\r\n          <mesh>\r\n            <scale>1 1 1</scale>\r\n            <uri>model://tricopter_weightdrop/meshes/Push_Rod.STL</uri>\r\n          </mesh>\r\n        </geometry>\r\n        <material>\r\n          <script>\r\n            <name>Gazebo/White</name>\r\n            <uri>file://media/materials/scripts/gazebo.material</uri>\r\n          </script>\r\n        </material>\r\n      </visual>\r\n      <gravity>1</gravity>\r\n      <velocity_decay/>\r\n      <self_collide>0</self_collide>\r\n    </link>\r\n    <joint name='push_rod_joint' type='prismatic'>\r\n      <pose frame=''>0 0 0 0 0 0</pose>\r\n      <child>push_rod_link</child>\r\n      <parent>base_frame_link</parent>\r\n      <axis>\r\n        <xyz>1 0 0</xyz>\r\n        <limit>\r\n\t  <lower>-0.052</lower>\r\n          <upper>0.0</upper>\r\n\t  <effort>1000</effort>\r\n\t  <velocity>10</velocity>\r\n        </limit>\r\n        <dynamics>\r\n          <spring_reference>0</spring_reference>\r\n          <spring_stiffness>0</spring_stiffness>\r\n\t  <damping>0.007</damping>\r\n        </dynamics>\r\n        <use_parent_model_frame>1</use_parent_model_frame>\r\n      </axis>\r\n    </joint>\r\n\r\n**Weight block SDF**\r\n<link name='weight_block_1_link'>\r\n      <pose frame=''>0.05126 0 -0.04130 0 0 0</pose>\r\n      <inertial>\r\n        <pose frame=''>0 0 -0.013 0 0 0</pose>\r\n        <mass>0.055</mass>\r\n        <inertia>\r\n          <ixx>3.613E-05</ixx>\r\n          <ixy>0</ixy>\r\n          <ixz>0</ixz>\r\n          <iyy>4.9E-06</iyy>\r\n          <iyz>0</iyz>\r\n          <izz>3.190E-05</izz>\r\n        </inertia>\r\n      </inertial>\r\n      <collision name='weight_block_1_link_collision'>\r\n\t<max_contacts>1</max_contacts>\r\n        <pose frame=''>0 0 0 0 0 0</pose>\r\n        <geometry>\r\n          <mesh>\r\n\t    <scale>1 1 1</scale>\r\n            <uri>model://weight_blocks/meshes/weight_block_small_0.STL</uri>\r\n\t  </mesh>\r\n        </geometry>\r\n        <surface>\r\n          <contact>\r\n            <ode>\r\n\t      <kp>100000000</kp>\r\n\t      <kd>1000</kd>\r\n\t      <max_vel>0</max_vel>\r\n\t      <min_depth>0.0001</min_depth>\r\n            </ode>\r\n            <bullet>\r\n\t      <split_impulse>0</split_impulse>\r\n            </bullet>\r\n          </contact>\r\n          <friction>\r\n            <ode>\r\n\t      <mu>2</mu>\r\n\t      <mu2>2</mu2>\r\n\t    </ode>\r\n          </friction>\r\n \t  <soft_contact>\r\n            <dart>\r\n\t      <damping>100</damping>\r\n            </dart>\r\n          </soft_contact>\r\n        </surface>\r\n      </collision>\r\n      <visual name='weight_block_1_link_visual'>\r\n        <pose frame=''>0 0 0 0 0 0</pose>\r\n        <geometry>\r\n          <mesh>\r\n            <scale>1 1 1</scale>\r\n            <uri>model://weight_blocks/meshes/weight_block_small_0.STL</uri>\r\n          </mesh>\r\n        </geometry>\r\n        <material>\r\n          <script>\r\n            <name>Gazebo/White</name>\r\n            <uri>file://media/materials/scripts/gazebo.material</uri>\r\n          </script>\r\n        </material>\r\n      </visual>\r\n      <gravity>1</gravity>\r\n      <velocity_decay/>\r\n      <self_collide>0</self_collide>\r\n    </link>\r\n\r\nAlso, I have defined the physics in the world file as:\r\n\r\n**World file**\r\n<physics name='default_physics' default='0' type='ode'>\r\n      <gravity>0 0 -9.8066</gravity>\r\n      <ode>\r\n        <solver>\r\n          <type>quick</type>\r\n          <iters>100</iters>\r\n          <sor>1.3</sor>\r\n          <use_dynamic_moi_rescaling>0</use_dynamic_moi_rescaling>\r\n        </solver>\r\n        <constraints>\r\n          <cfm>0</cfm>\r\n          <erp>0.5</erp>\r\n          <contact_max_correcting_vel>100</contact_max_correcting_vel>\r\n          <contact_surface_layer>0.001</contact_surface_layer>\r\n        </constraints>\r\n      </ode>\r\n      <max_step_size>0.002</max_step_size>\r\n      <real_time_factor>1</real_time_factor>\r\n      <real_time_update_rate>500</real_time_update_rate>\r\n      <magnetic_field>6e-06 2.3e-05 -4.2e-05</magnetic_field>\r\n</physics>\r\n\r\nMy PID controller definition for the pushrod is:\r\n  <p>0.9</p>\r\n  <i>0.05</i>\r\n  <d>0.4</d>\r\n  <iMax>0.1</iMax>\r\n  <iMin>-0.1</iMin>\r\n  <cmdMax>2.7</cmdMax>\r\n  <cmdMin>-2.7</cmdMin>\r\n\r\nI have spent some time in finding a similar issue, however, couldn't find one. Any of your help is highly appreciated.\r\n\r\nMohit\r\nP.S. I am not sure whether is it a bug, so please pardon me if I made a wrong classification.", "markup": "markdown", "html": "<p>Dear Gazebo Community,</p>\n<p>I am in the process of developing a gazebo model of a UAV that incorporates a mechanism to drop certain weight blocks. All the weight blocks are designed with hooks which are positioned within slots enclosed at the bottom of the UAV base.  The linear motion of the pushrod (controlled via gazebo plugin) opens the interlocking for the blocks (as visualized from Fig.).\nWhile running the simulation, the problem that I am encountering is the wobbly/bouncy motion of the weight block when it is suspended from the pushrod. Even the pushrod oscillates back and forth, which eventually opens the interlocking for the hook and it gets dropped even without commanding. I suspect the problem lies within the contact definition between the weight block and the pushrod. Whenever a contact is detected, a significant reaction force is applied to the hook of the weight block that results in its bouncy motion. I tried increasing damping for the contact by changing  &lt;kp&gt; and &lt;kd&gt;  parameters within the &lt;contact&gt; tag of the sdf file, but with no success. Another thing that I noticed, when I make the pushrod joint to be 'fixed' (by specifying zero values for &lt;upper&gt; and &lt;lower&gt; limits), the weight block although oscillates, but does not get dropped. To me it implied that there might be something wrong with the controller of the pushrod. So, I tried playing with the PID parameters but still it didn't solve the problem. After few moments of hover flight, the block drops due to rapid wobbling. Below is the snippet of my sdf code for the pushrod and weight block definitions:</p>\n<p><strong>Pushrod SDF</strong>\n&lt;link name='push_rod_link'&gt;\n      &lt;pose frame=''&gt;0.06807 0 -0.04150 0 0 0&lt;/pose&gt;\n      &lt;inertial&gt;\n        &lt;pose frame=''&gt;-0.08 0 0 0 0 0&lt;/pose&gt;\n        &lt;mass&gt;0.130&lt;/mass&gt;\n        &lt;inertia&gt;\n          &lt;ixx&gt;3.741E-06&lt;/ixx&gt;\n          &lt;ixy&gt;0&lt;/ixy&gt;\n          &lt;ixz&gt;0&lt;/ixz&gt;\n          &lt;iyy&gt;7.658E-04&lt;/iyy&gt;\n          &lt;iyz&gt;0&lt;/iyz&gt;\n          &lt;izz&gt;7.658E-04&lt;/izz&gt;\n        &lt;/inertia&gt;\n      &lt;/inertial&gt;\n      &lt;collision name='push_rod_link_collision'&gt;\n        &lt;pose frame=''&gt;0 0 0 0 0 0&lt;/pose&gt;\n        &lt;geometry&gt;\n          &lt;mesh&gt;\n        &lt;scale&gt;1 1 1&lt;/scale&gt;\n            &lt;uri&gt;model://tricopter_weightdrop/meshes/Push_Rod.STL&lt;/uri&gt;\n      &lt;/mesh&gt;\n        &lt;/geometry&gt;\n        &lt;surface&gt;\n          &lt;contact&gt;\n            &lt;ode/&gt;\n          &lt;/contact&gt;\n          &lt;friction&gt;\n            &lt;ode&gt;\n          &lt;mu&gt;1&lt;/mu&gt;\n          &lt;mu2&gt;1&lt;/mu2&gt;\n        &lt;/ode&gt;\n          &lt;/friction&gt;\n        &lt;/surface&gt;\n      &lt;/collision&gt;\n      &lt;visual name='push_rod_link_visual'&gt;\n        &lt;pose frame=''&gt;0 0 0 0 0 0&lt;/pose&gt;\n        &lt;geometry&gt;\n          &lt;mesh&gt;\n            &lt;scale&gt;1 1 1&lt;/scale&gt;\n            &lt;uri&gt;model://tricopter_weightdrop/meshes/Push_Rod.STL&lt;/uri&gt;\n          &lt;/mesh&gt;\n        &lt;/geometry&gt;\n        &lt;material&gt;\n          &lt;script&gt;\n            &lt;name&gt;Gazebo/White&lt;/name&gt;\n            &lt;uri&gt;file://media/materials/scripts/gazebo.material&lt;/uri&gt;\n          &lt;/script&gt;\n        &lt;/material&gt;\n      &lt;/visual&gt;\n      &lt;gravity&gt;1&lt;/gravity&gt;\n      &lt;velocity_decay/&gt;\n      &lt;self_collide&gt;0&lt;/self_collide&gt;\n    &lt;/link&gt;\n    &lt;joint name='push_rod_joint' type='prismatic'&gt;\n      &lt;pose frame=''&gt;0 0 0 0 0 0&lt;/pose&gt;\n      &lt;child&gt;push_rod_link&lt;/child&gt;\n      &lt;parent&gt;base_frame_link&lt;/parent&gt;\n      &lt;axis&gt;\n        &lt;xyz&gt;1 0 0&lt;/xyz&gt;\n        &lt;limit&gt;\n      &lt;lower&gt;-0.052&lt;/lower&gt;\n          &lt;upper&gt;0.0&lt;/upper&gt;\n      &lt;effort&gt;1000&lt;/effort&gt;\n      &lt;velocity&gt;10&lt;/velocity&gt;\n        &lt;/limit&gt;\n        &lt;dynamics&gt;\n          &lt;spring_reference&gt;0&lt;/spring_reference&gt;\n          &lt;spring_stiffness&gt;0&lt;/spring_stiffness&gt;\n      &lt;damping&gt;0.007&lt;/damping&gt;\n        &lt;/dynamics&gt;\n        &lt;use_parent_model_frame&gt;1&lt;/use_parent_model_frame&gt;\n      &lt;/axis&gt;\n    &lt;/joint&gt;</p>\n<p><strong>Weight block SDF</strong>\n&lt;link name='weight_block_1_link'&gt;\n      &lt;pose frame=''&gt;0.05126 0 -0.04130 0 0 0&lt;/pose&gt;\n      &lt;inertial&gt;\n        &lt;pose frame=''&gt;0 0 -0.013 0 0 0&lt;/pose&gt;\n        &lt;mass&gt;0.055&lt;/mass&gt;\n        &lt;inertia&gt;\n          &lt;ixx&gt;3.613E-05&lt;/ixx&gt;\n          &lt;ixy&gt;0&lt;/ixy&gt;\n          &lt;ixz&gt;0&lt;/ixz&gt;\n          &lt;iyy&gt;4.9E-06&lt;/iyy&gt;\n          &lt;iyz&gt;0&lt;/iyz&gt;\n          &lt;izz&gt;3.190E-05&lt;/izz&gt;\n        &lt;/inertia&gt;\n      &lt;/inertial&gt;\n      &lt;collision name='weight_block_1_link_collision'&gt;\n    &lt;max_contacts&gt;1&lt;/max_contacts&gt;\n        &lt;pose frame=''&gt;0 0 0 0 0 0&lt;/pose&gt;\n        &lt;geometry&gt;\n          &lt;mesh&gt;\n        &lt;scale&gt;1 1 1&lt;/scale&gt;\n            &lt;uri&gt;model://weight_blocks/meshes/weight_block_small_0.STL&lt;/uri&gt;\n      &lt;/mesh&gt;\n        &lt;/geometry&gt;\n        &lt;surface&gt;\n          &lt;contact&gt;\n            &lt;ode&gt;\n          &lt;kp&gt;<a href=\"#!/osrf/gazebo/commits/100000000\" rel=\"nofollow\" class=\"ap-connect-link\">100000000</a>&lt;/kp&gt;\n          &lt;kd&gt;1000&lt;/kd&gt;\n          &lt;max_vel&gt;0&lt;/max_vel&gt;\n          &lt;min_depth&gt;0.0001&lt;/min_depth&gt;\n            &lt;/ode&gt;\n            &lt;bullet&gt;\n          &lt;split_impulse&gt;0&lt;/split_impulse&gt;\n            &lt;/bullet&gt;\n          &lt;/contact&gt;\n          &lt;friction&gt;\n            &lt;ode&gt;\n          &lt;mu&gt;2&lt;/mu&gt;\n          &lt;mu2&gt;2&lt;/mu2&gt;\n        &lt;/ode&gt;\n          &lt;/friction&gt;\n      &lt;soft_contact&gt;\n            &lt;dart&gt;\n          &lt;damping&gt;100&lt;/damping&gt;\n            &lt;/dart&gt;\n          &lt;/soft_contact&gt;\n        &lt;/surface&gt;\n      &lt;/collision&gt;\n      &lt;visual name='weight_block_1_link_visual'&gt;\n        &lt;pose frame=''&gt;0 0 0 0 0 0&lt;/pose&gt;\n        &lt;geometry&gt;\n          &lt;mesh&gt;\n            &lt;scale&gt;1 1 1&lt;/scale&gt;\n            &lt;uri&gt;model://weight_blocks/meshes/weight_block_small_0.STL&lt;/uri&gt;\n          &lt;/mesh&gt;\n        &lt;/geometry&gt;\n        &lt;material&gt;\n          &lt;script&gt;\n            &lt;name&gt;Gazebo/White&lt;/name&gt;\n            &lt;uri&gt;file://media/materials/scripts/gazebo.material&lt;/uri&gt;\n          &lt;/script&gt;\n        &lt;/material&gt;\n      &lt;/visual&gt;\n      &lt;gravity&gt;1&lt;/gravity&gt;\n      &lt;velocity_decay/&gt;\n      &lt;self_collide&gt;0&lt;/self_collide&gt;\n    &lt;/link&gt;</p>\n<p>Also, I have defined the physics in the world file as:</p>\n<p><strong>World file</strong>\n&lt;physics name='default_physics' default='0' type='ode'&gt;\n      &lt;gravity&gt;0 0 -9.8066&lt;/gravity&gt;\n      &lt;ode&gt;\n        &lt;solver&gt;\n          &lt;type&gt;quick&lt;/type&gt;\n          &lt;iters&gt;100&lt;/iters&gt;\n          &lt;sor&gt;1.3&lt;/sor&gt;\n          &lt;use_dynamic_moi_rescaling&gt;0&lt;/use_dynamic_moi_rescaling&gt;\n        &lt;/solver&gt;\n        &lt;constraints&gt;\n          &lt;cfm&gt;0&lt;/cfm&gt;\n          &lt;erp&gt;0.5&lt;/erp&gt;\n          &lt;contact_max_correcting_vel&gt;100&lt;/contact_max_correcting_vel&gt;\n          &lt;contact_surface_layer&gt;0.001&lt;/contact_surface_layer&gt;\n        &lt;/constraints&gt;\n      &lt;/ode&gt;\n      &lt;max_step_size&gt;0.002&lt;/max_step_size&gt;\n      &lt;real_time_factor&gt;1&lt;/real_time_factor&gt;\n      &lt;real_time_update_rate&gt;500&lt;/real_time_update_rate&gt;\n      &lt;magnetic_field&gt;6e-06 2.3e-05 -4.2e-05&lt;/magnetic_field&gt;\n&lt;/physics&gt;</p>\n<p>My PID controller definition for the pushrod is:\n  &lt;p&gt;0.9&lt;/p&gt;\n  &lt;i&gt;0.05&lt;/i&gt;\n  &lt;d&gt;0.4&lt;/d&gt;\n  &lt;iMax&gt;0.1&lt;/iMax&gt;\n  &lt;iMin&gt;-0.1&lt;/iMin&gt;\n  &lt;cmdMax&gt;2.7&lt;/cmdMax&gt;\n  &lt;cmdMin&gt;-2.7&lt;/cmdMin&gt;</p>\n<p>I have spent some time in finding a similar issue, however, couldn't find one. Any of your help is highly appreciated.</p>\n<p>Mohit\nP.S. I am not sure whether is it a bug, so please pardon me if I made a wrong classification.</p>", "type": "rendered"}, "assignee": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "state": "new", "version": {"name": "8.1", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/243455.json"}}}, "edited_on": null, "created_on": "2018-01-14T18:25:00.058220+00:00", "milestone": null, "updated_on": "2018-01-14T18:41:19.740132+00:00", "type": "issue", "id": 2400}