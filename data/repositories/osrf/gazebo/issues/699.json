{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/699/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/699.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/699/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/699/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/699/camera-deletion-race-condition"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/699/vote"}}, "reporter": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "title": "Camera deletion race condition", "component": null, "votes": 0, "watches": 2, "content": {"raw": "Error case:\r\n\r\n1) Delete a model that has a camera. \r\n\r\n2) Link.cc:Fini() is called, which tells the SensorManager to remove the camera and also the RenderEngine to remove all the visuals.\r\n\r\n3) When the RenderEngine processes the visual deletion, it will also remove the Ogre Camera.\r\n\r\n4) It's then possible for the SensorManager to update, and in turn try to render a now deleted camera.\r\n\r\nThis caused a segfault in `SkyX.cpp:notifyCameraRender(Ogre::Camera *c)`. \r\nThe short-term solution was to modify the first `if` statement in `notifyCameraRender` to include `|| !c`.\r\n\r\nThis may be a bug in Ogre. We should look at the Ogre code.", "markup": "markdown", "html": "<p>Error case:</p>\n<p>1) Delete a model that has a camera. </p>\n<p>2) Link.cc:Fini() is called, which tells the SensorManager to remove the camera and also the RenderEngine to remove all the visuals.</p>\n<p>3) When the RenderEngine processes the visual deletion, it will also remove the Ogre Camera.</p>\n<p>4) It's then possible for the SensorManager to update, and in turn try to render a now deleted camera.</p>\n<p>This caused a segfault in <code>SkyX.cpp:notifyCameraRender(Ogre::Camera *c)</code>. \nThe short-term solution was to modify the first <code>if</code> statement in <code>notifyCameraRender</code> to include <code>|| !c</code>.</p>\n<p>This may be a bug in Ogre. We should look at the Ogre code.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2013-05-28T23:50:33.918093+00:00", "milestone": null, "updated_on": "2016-09-14T19:41:43.132278+00:00", "type": "issue", "id": 699}