{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1523/comments/16615888.json"}, "html": {"href": "#!/osrf/gazebo/issues/1523#comment-16615888"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1523.json"}}, "type": "issue", "id": 1523, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "gzclient crashes when a light is selected on another client"}, "content": {"raw": "I'm not sure exactly how OGRE HardwareBuffers work, but... It seems to me that when two gzclients try to render the selection wirebox, the Ogre HardwareVertexBuffers for each gzclient are colliding in memory.\n\nA possible workaround for this bug is to change the logic in `GLWidget` such that a gzclient doesn't act on selection messages if they originated from a different gzclient. Right now, because of the `~/selection` topic, both gzclients will attempt to render the selection wirebox if a selection message is fired.\n\nCurrently GLWidget sets up publishers and subscribers to the same topic (lines 128-134):\n\n```\n  // Subscribes to selection messages.\n  this->selectionSub = this->node->Subscribe(\"~/selection\",\n      &GLWidget::OnSelectionMsg, this);\n\n  // Publishes information about user selections.\n  this->selectionPub =\n    this->node->Advertise<msgs::Selection>(\"~/selection\");\n```\n\n@nkoenig, what do you think about renaming the topic that `GLWidget` subscribes to `~/selection/server`? ", "markup": "markdown", "html": "<p>I'm not sure exactly how OGRE HardwareBuffers work, but... It seems to me that when two gzclients try to render the selection wirebox, the Ogre HardwareVertexBuffers for each gzclient are colliding in memory.</p>\n<p>A possible workaround for this bug is to change the logic in <code>GLWidget</code> such that a gzclient doesn't act on selection messages if they originated from a different gzclient. Right now, because of the <code>~/selection</code> topic, both gzclients will attempt to render the selection wirebox if a selection message is fired.</p>\n<p>Currently GLWidget sets up publishers and subscribers to the same topic (lines 128-134):</p>\n<div class=\"codehilite\"><pre><span></span>  <span class=\"o\">//</span> <span class=\"nt\">Subscribes</span> <span class=\"nt\">to</span> <span class=\"nt\">selection</span> <span class=\"nt\">messages</span><span class=\"o\">.</span>\n  <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">selectionSub</span> <span class=\"o\">=</span> <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Subscribe</span><span class=\"o\">(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">,</span>\n      <span class=\"o\">&amp;</span><span class=\"nt\">GLWidget</span><span class=\"p\">::</span><span class=\"nd\">OnSelectionMsg</span><span class=\"o\">,</span> <span class=\"nt\">this</span><span class=\"o\">);</span>\n\n  <span class=\"o\">//</span> <span class=\"nt\">Publishes</span> <span class=\"nt\">information</span> <span class=\"nt\">about</span> <span class=\"nt\">user</span> <span class=\"nt\">selections</span><span class=\"o\">.</span>\n  <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">selectionPub</span> <span class=\"o\">=</span>\n    <span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">node-</span><span class=\"o\">&gt;</span><span class=\"nt\">Advertise</span><span class=\"o\">&lt;</span><span class=\"nt\">msgs</span><span class=\"p\">::</span><span class=\"nd\">Selection</span><span class=\"o\">&gt;(</span><span class=\"s2\">&quot;~/selection&quot;</span><span class=\"o\">);</span>\n</pre></div>\n\n\n<p>@nkoenig, what do you think about renaming the topic that <code>GLWidget</code> subscribes to <code>~/selection/server</code>? </p>", "type": "rendered"}, "created_on": "2015-03-19T17:54:14.853374+00:00", "user": {"display_name": "Jackie K", "uuid": "{e3d60b62-b7c7-4863-b9b9-cdae9f123cec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D"}, "html": {"href": "https://bitbucket.org/%7Be3d60b62-b7c7-4863-b9b9-cdae9f123cec%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/ea011fa2919d4bd4568b32b440eda779d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-0.png"}}, "nickname": "jacquelinekay", "type": "user", "account_id": "557058:f56c822f-f75c-4665-80f9-6e7764893b9c"}, "updated_on": "2015-03-19T18:13:22.600267+00:00", "type": "issue_comment", "id": 16615888}