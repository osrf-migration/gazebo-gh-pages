{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/20/comments/2894064.json"}, "html": {"href": "#!/osrf/gazebo/issues/20#comment-2894064"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/20.json"}}, "type": "issue", "id": 20, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Laser scan (ray sensor) updates erratic and slower than desired"}, "content": {"raw": "Ok, to get more reproducibility:\nI'm on a Ubuntu 12.04 AMD64 machine, Core I5 (i5-2430M CPU @ 2.40GHz, Nvidia GeForce GT 540M). ROS Fuerte/Gazebo/drcsim installed from (their respective) .debs.\n\nHow I tested:\n\nStarted Atlas:\n\n\n```\n#!\n\nroslaunch atlas_utils atlas.launch\n```\n\nNew terminal, start a subscriber for scans (so recording via bagfile doesn't incur recording start overhead/delay when no scans have been subscribed before):\n\n\n```\n#!\n\nrostopic hz scan\n```\n\nRecord a bagfile of 1000 scans:\n\n\n```\n#!\n\nrosbag record --l 1000 scan\n```\n\nOptionally in new terminal, to increase load and also start up image publishers:\n\n\n```\n#!\n\nrostopic hz /multisense_sl/points2\n```\n\nThen, again record bag file:\n\n```\n#!\n\nrosbag record --l 1000 scan\n```\n\nOn my machine I then get the following using the 'info --freq' bagfile option:\n\nOnly scan subscribed:\n\n\n```\n#!\n\nkohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_only.bag \npath:        atlas_scan_only.bag\nversion:     2.0\nduration:    28.6s\nstart:       Jan 01 1970 01:05:49.36 (349.36)\nend:         Jan 01 1970 01:06:17.00 (378.00)\nsize:        5.6 MB\nmessages:    1000\ncompression: none [8/8 chunks]\ntypes:       sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      scan   1000 msgs @ 38.5 Hz : sensor_msgs/LaserScan\n```\n\n\nAlso subscribing to pointcloud data:\n\n\n```\n#!\n\nkohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_pc2_subscribed.bag \npath:        atlas_scan_pc2_subscribed.bag\nversion:     2.0\nduration:    35.4s\nstart:       Jan 01 1970 01:07:34.03 (454.03)\nend:         Jan 01 1970 01:08:09.41 (489.41)\nsize:        5.6 MB\nmessages:    1000\ncompression: none [8/8 chunks]\ntypes:       sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      scan   1000 msgs @ 30.3 Hz : sensor_msgs/LaserScan\n```\n\nI also recorded versions of both tests with both /scan and /clock. Interestingly, the frequency numbers exactly match those of the same test without clock data, suggesting that jitter doesn't play an important role.\n\n\n```\n#!\n\nkohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_clock_only.bag \npath:        atlas_scan_clock_only.bag\nversion:     2.0\nduration:    28.8s\nstart:       Jan 01 1970 01:06:37.09 (397.09)\nend:         Jan 01 1970 01:07:05.92 (425.92)\nsize:        5.7 MB\nmessages:    2000\ncompression: none [8/8 chunks]\ntypes:       rosgraph_msgs/Clock   [a9c97c1d230cfc112e270351a944ee47]\n             sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      clock   1000 msgs @ 1.0 kHz : rosgraph_msgs/Clock  \n             scan    1000 msgs @ 38.5 Hz : sensor_msgs/LaserScan\n```\n\n```\n#!\n\nkohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_clock_pc2_subscribed.bag \npath:        atlas_scan_clock_pc2_subscribed.bag\nversion:     2.0\nduration:    35.1s\nstart:       Jan 01 1970 01:08:17.34 (497.34)\nend:         Jan 01 1970 01:08:52.48 (532.48)\nsize:        5.7 MB\nmessages:    2000\ncompression: none [8/8 chunks]\ntypes:       rosgraph_msgs/Clock   [a9c97c1d230cfc112e270351a944ee47]\n             sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      clock   1000 msgs @ 1.0 kHz : rosgraph_msgs/Clock  \n             scan    1000 msgs @ 30.3 Hz : sensor_msgs/LaserScan\n```\n/edit: Ok, recording only 1000 clock messages is probably making only limited sense ;) Still serves to show that the frequency is reproducible.\n", "markup": "markdown", "html": "<p>Ok, to get more reproducibility:\nI'm on a Ubuntu 12.04 AMD64 machine, Core I5 (i5-2430M CPU @ 2.40GHz, Nvidia GeForce GT 540M). ROS Fuerte/Gazebo/drcsim installed from (their respective) .debs.</p>\n<p>How I tested:</p>\n<p>Started Atlas:</p>\n<div class=\"codehilite\"><pre><span></span>roslaunch atlas_utils atlas.launch\n</pre></div>\n\n\n<p>New terminal, start a subscriber for scans (so recording via bagfile doesn't incur recording start overhead/delay when no scans have been subscribed before):</p>\n<div class=\"codehilite\"><pre><span></span>rostopic hz scan\n</pre></div>\n\n\n<p>Record a bagfile of 1000 scans:</p>\n<div class=\"codehilite\"><pre><span></span>rosbag record --l 1000 scan\n</pre></div>\n\n\n<p>Optionally in new terminal, to increase load and also start up image publishers:</p>\n<div class=\"codehilite\"><pre><span></span>rostopic hz /multisense_sl/points2\n</pre></div>\n\n\n<p>Then, again record bag file:</p>\n<div class=\"codehilite\"><pre><span></span>rosbag record --l 1000 scan\n</pre></div>\n\n\n<p>On my machine I then get the following using the 'info --freq' bagfile option:</p>\n<p>Only scan subscribed:</p>\n<div class=\"codehilite\"><pre><span></span>kohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_only.bag \npath:        atlas_scan_only.bag\nversion:     2.0\nduration:    28.6s\nstart:       Jan 01 1970 01:05:49.36 (349.36)\nend:         Jan 01 1970 01:06:17.00 (378.00)\nsize:        5.6 MB\nmessages:    1000\ncompression: none [8/8 chunks]\ntypes:       sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      scan   1000 msgs @ 38.5 Hz : sensor_msgs/LaserScan\n</pre></div>\n\n\n<p>Also subscribing to pointcloud data:</p>\n<div class=\"codehilite\"><pre><span></span>kohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_pc2_subscribed.bag \npath:        atlas_scan_pc2_subscribed.bag\nversion:     2.0\nduration:    35.4s\nstart:       Jan 01 1970 01:07:34.03 (454.03)\nend:         Jan 01 1970 01:08:09.41 (489.41)\nsize:        5.6 MB\nmessages:    1000\ncompression: none [8/8 chunks]\ntypes:       sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      scan   1000 msgs @ 30.3 Hz : sensor_msgs/LaserScan\n</pre></div>\n\n\n<p>I also recorded versions of both tests with both /scan and /clock. Interestingly, the frequency numbers exactly match those of the same test without clock data, suggesting that jitter doesn't play an important role.</p>\n<div class=\"codehilite\"><pre><span></span>kohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_clock_only.bag \npath:        atlas_scan_clock_only.bag\nversion:     2.0\nduration:    28.8s\nstart:       Jan 01 1970 01:06:37.09 (397.09)\nend:         Jan 01 1970 01:07:05.92 (425.92)\nsize:        5.7 MB\nmessages:    2000\ncompression: none [8/8 chunks]\ntypes:       rosgraph_msgs/Clock   [a9c97c1d230cfc112e270351a944ee47]\n             sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      clock   1000 msgs @ 1.0 kHz : rosgraph_msgs/Clock  \n             scan    1000 msgs @ 38.5 Hz : sensor_msgs/LaserScan\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>kohlbrecher@opstation:~/tmp$ rosbag info --freq atlas_scan_clock_pc2_subscribed.bag \npath:        atlas_scan_clock_pc2_subscribed.bag\nversion:     2.0\nduration:    35.1s\nstart:       Jan 01 1970 01:08:17.34 (497.34)\nend:         Jan 01 1970 01:08:52.48 (532.48)\nsize:        5.7 MB\nmessages:    2000\ncompression: none [8/8 chunks]\ntypes:       rosgraph_msgs/Clock   [a9c97c1d230cfc112e270351a944ee47]\n             sensor_msgs/LaserScan [90c7ef2dc6895d81024acba2ac42f369]\ntopics:      clock   1000 msgs @ 1.0 kHz : rosgraph_msgs/Clock  \n             scan    1000 msgs @ 30.3 Hz : sensor_msgs/LaserScan\n</pre></div>\n\n\n<p>/edit: Ok, recording only 1000 clock messages is probably making only limited sense ;) Still serves to show that the frequency is reproducible.</p>", "type": "rendered"}, "created_on": "2013-01-21T08:53:43.970779+00:00", "user": {"display_name": "Stefan Kohlbrecher", "uuid": "{db06b03e-7b31-4483-9018-534df5bd723f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bdb06b03e-7b31-4483-9018-534df5bd723f%7D"}, "html": {"href": "https://bitbucket.org/%7Bdb06b03e-7b31-4483-9018-534df5bd723f%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/414f1c364e6406dde31a6ef70fbd3d21d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSK-6.png"}}, "nickname": "Stefan_Kohlbrecher", "type": "user", "account_id": "557058:e39b6a62-9eb0-45ca-b27e-4f6445009d3f"}, "updated_on": "2013-01-21T09:05:01.444004+00:00", "type": "issue_comment", "id": 2894064}