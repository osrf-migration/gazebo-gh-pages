{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1636/comments/18890423.json"}, "html": {"href": "#!/osrf/gazebo/issues/1636#comment-18890423"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1636.json"}}, "type": "issue", "id": 1636, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "ODE threaded islands sometimes slower on Ubuntu"}, "content": {"raw": "To reproduce the error, run the `INTEGRATION_speed_thread_islands` test on the [thread_islands_ode](#!/osrf/gazebo/branches/compare/thread_islands_ode%0Ddefault) branch. It passes on homebrew but often fails on Ubuntu.\n\nTo debug the problem, I recommend building against sdformat branch `island_threads` and gazebo branch `diagnostics_scpeters`. You can also consider building gazebo with `-DENABLE_DIAGNOSTICS=1` if you want diagnostic timing data. Then use the following procedure:\n\nLaunch the `revolute_joint_test.world`\n~~~\ngzserver --verbose test/worlds/revolute_joint_test.world\n~~~\n\nIn a separate terminal, open `gz stats` to watch the real-time factor:\n~~~\ngz stats\n~~~\n\nIn a separate terminal, use `gz physics` to change the physics parameters:\n~~~\ngz physics -o unthrottled0 # unthrottled, no threading, should be fastest\ngz physics -o unthrottled2 # unthrottled, with 2 island threads, should be faster, but strangely slows down\n~~~\n\nwith the `unthrottled2` profile, opening a gzclient or echoing high-bandwidth topics seems to speed it up\n~~~\ngzclient\ngz topic -e /gazebo/default/pose/local/info\ngz topic -e /gazebo/default/pose/info\ngz topic -e /gazebo/default/physics/contacts\n~~~\n", "markup": "markdown", "html": "<p>To reproduce the error, run the <code>INTEGRATION_speed_thread_islands</code> test on the <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/branches/compare/thread_islands_ode%0Ddefault\" rel=\"nofollow\">thread_islands_ode</a> branch. It passes on homebrew but often fails on Ubuntu.</p>\n<p>To debug the problem, I recommend building against sdformat branch <code>island_threads</code> and gazebo branch <code>diagnostics_scpeters</code>. You can also consider building gazebo with <code>-DENABLE_DIAGNOSTICS=1</code> if you want diagnostic timing data. Then use the following procedure:</p>\n<p>Launch the <code>revolute_joint_test.world</code></p>\n<div class=\"codehilite\"><pre><span></span>gzserver --verbose test/worlds/revolute_joint_test.world\n</pre></div>\n\n\n<p>In a separate terminal, open <code>gz stats</code> to watch the real-time factor:</p>\n<div class=\"codehilite\"><pre><span></span>gz stats\n</pre></div>\n\n\n<p>In a separate terminal, use <code>gz physics</code> to change the physics parameters:</p>\n<div class=\"codehilite\"><pre><span></span>gz physics -o unthrottled0 # unthrottled, no threading, should be fastest\ngz physics -o unthrottled2 # unthrottled, with 2 island threads, should be faster, but strangely slows down\n</pre></div>\n\n\n<p>with the <code>unthrottled2</code> profile, opening a gzclient or echoing high-bandwidth topics seems to speed it up</p>\n<div class=\"codehilite\"><pre><span></span>gzclient\ngz topic -e /gazebo/default/pose/local/info\ngz topic -e /gazebo/default/pose/info\ngz topic -e /gazebo/default/physics/contacts\n</pre></div>", "type": "rendered"}, "created_on": "2015-06-17T18:23:57.571839+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 18890423}