{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1629/comments/18715548.json"}, "html": {"href": "#!/osrf/gazebo/issues/1629#comment-18715548"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1629.json"}}, "type": "issue", "id": 1629, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Removing model from plugin crashes with null pointer"}, "content": {"raw": "Ok, the repository can be found [here](https://bitbucket.org/ElteHupkes/gazebo-remove-errors). The easiest way to run, from the repo root:\n\n```\nmkdir build\ncd build\ncmake ../src\nmake\ncd ../tools\n./run\n```\n\nThis starts a gdb session with the correct model / plugin paths loaded into environment variables. To run, do `r testworld.sdf`.\n\nThe repo has two branches:\n\n- `master`, which is pretty much the example above, only it loads the model from file and not from SDF directly (doesn't make a difference for the error)\n- `clear`, which calls `World::Clear()` instead of `World::RemoveModel()`. Like I mentioned before, this works fine with the initial model, so I'm using a different model here which has an IMU-sensor, I suspect the sensor's what's causing the problem. This actually segfaults, so it may take a few inserts / removes before invalid memory is accessed. For me, the gdb output of this second example is:\n\n```\nPlugin loaded.\nAdded model #0\nModels in world: 1\nWorld cleared, adding new...\nAdded model #0\nModels in world: 1\nWorld cleared, adding new...\nAdded model #0\n*** Error in `/usr/bin/gzserver': free(): invalid next size (fast): 0x00007fff7829ef00 ***\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7fff99bf8700 (LWP 13213)]\n0x00007ffff5e4b119 in ?? () from /usr/lib/x86_64-linux-gnu/libsdformat.so.2\n```\n\nThat may or me not be an entirely different issue - if you want, I'll create another issue for it.", "markup": "markdown", "html": "<p>Ok, the repository can be found <a data-is-external-link=\"true\" href=\"https://bitbucket.org/ElteHupkes/gazebo-remove-errors\" rel=\"nofollow\">here</a>. The easiest way to run, from the repo root:</p>\n<div class=\"codehilite\"><pre><span></span>mkdir build\ncd build\ncmake ../src\nmake\ncd ../tools\n./run\n</pre></div>\n\n\n<p>This starts a gdb session with the correct model / plugin paths loaded into environment variables. To run, do <code>r testworld.sdf</code>.</p>\n<p>The repo has two branches:</p>\n<ul>\n<li><code>master</code>, which is pretty much the example above, only it loads the model from file and not from SDF directly (doesn't make a difference for the error)</li>\n<li><code>clear</code>, which calls <code>World::Clear()</code> instead of <code>World::RemoveModel()</code>. Like I mentioned before, this works fine with the initial model, so I'm using a different model here which has an IMU-sensor, I suspect the sensor's what's causing the problem. This actually segfaults, so it may take a few inserts / removes before invalid memory is accessed. For me, the gdb output of this second example is:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>Plugin loaded.\nAdded model #0\nModels in world: 1\nWorld cleared, adding new...\nAdded model #0\nModels in world: 1\nWorld cleared, adding new...\nAdded model #0\n*** Error in `/usr/bin/gzserver&#39;: free(): invalid next size (fast): 0x00007fff7829ef00 ***\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7fff99bf8700 (LWP 13213)]\n0x00007ffff5e4b119 in ?? () from /usr/lib/x86_64-linux-gnu/libsdformat.so.2\n</pre></div>\n\n\n<p>That may or me not be an entirely different issue - if you want, I'll create another issue for it.</p>", "type": "rendered"}, "created_on": "2015-06-10T07:27:54.119115+00:00", "user": {"display_name": "Elte Hupkes", "uuid": "{f23aa1a9-ae57-493f-8169-fbb59b3eae43}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D"}, "html": {"href": "https://bitbucket.org/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/8560ee94d50ba277c411499a45b3d732d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEH-5.png"}}, "nickname": "ElteHupkes", "type": "user", "account_id": "557058:b758f523-bdaa-4718-964c-03b825bdea8d"}, "updated_on": "2015-06-10T07:28:41.918372+00:00", "type": "issue_comment", "id": 18715548}