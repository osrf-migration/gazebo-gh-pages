{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1702/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1702.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1702/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1702/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1702/removing-models-leaves-behind-some-visuals"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1702/vote"}}, "reporter": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "title": "removing models leaves behind some visuals", "component": {"name": "rendering::ogre_gazebo", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/153568.json"}}}, "votes": 1, "watches": 6, "content": {"raw": "This can be reproduced by deleting a model, then re-spawning the same model with the same name, an error appears complaining about existing visual nodes in ogre. For example, while running [the haptix world sim api tutorial](http://gazebosim.org/tutorials?tut=haptix_sim_api&cat=haptix#hxs_add_modelandhxs_remove_model), by calling the following functions in sequence:\r\n~~~\r\n% Define a new model.  Here, we're taking the cricket_ball model from:\r\n%  #!/osrf/gazebo_models/src/default/cricket_ball/model.sdf\r\n% and tweaking it slightly (just changing the color from Red to Green).\r\nsdf = '<sdf version=\"1.5\"> <model name=\"cricket_ball\"> <link name=\"link\"> <pose>0 0 0.0375 0 0 0</pose> <inertial> <mass>0.1467</mass> <inertia> <ixx>8.251875e-05</ixx> <ixy>0</ixy> <ixz>0</ixz> <iyy>8.251875e-05</iyy> <iyz>0</iyz> <izz>8.251875e-05</izz> </inertia> </inertial> <collision name=\"collision\"> <geometry> <sphere> <radius>0.0375</radius> </sphere> </geometry> </collision> <visual name=\"visual\"> <geometry> <sphere> <radius>0.0375</radius> </sphere> </geometry> <material> <script> <uri>file://media/materials/scripts/gazebo.material</uri> <name>Gazebo/Green</name> </script> </material> </visual> </link> </model> </sdf>';\r\n% Add the new model to the world, at the world origin, 5m off the ground, with\r\n% gravity enabled.  Then it will drop onto the table.\r\nhxs_add_model(sdf, 'green_cricket_ball', [0; 0; 5], [0; 0; 0], 1);\r\npause(2);\r\n% Remove the model\r\nhxs_remove_model('green_cricket_ball');\r\npause(2);\r\n% Add back the same model\r\nhxs_add_model(sdf, 'green_cricket_ball', [0; 0; 5], [0; 0; 0], 1);\r\n\r\n~~~\r\n\r\n~~~\r\nterminate called after throwing an instance of 'Ogre::ItemIdentityException'\r\n\r\n  what():  OGRE EXCEPTION(4:ItemIdentityException): An object of type 'Entity' with name 'green_cricket_ball::link_COM_VISUAL____SPHERE__' already exists. in SceneManager::createMovableObject at /tmp/buildd/ogre3d-1.9-1.9.0~osrf2/OgreMain/src/OgreSceneManager.cpp (line 6853)\r\n~~~", "markup": "markdown", "html": "<p>This can be reproduced by deleting a model, then re-spawning the same model with the same name, an error appears complaining about existing visual nodes in ogre. For example, while running <a data-is-external-link=\"true\" href=\"http://gazebosim.org/tutorials?tut=haptix_sim_api&amp;cat=haptix#hxs_add_modelandhxs_remove_model\" rel=\"nofollow\">the haptix world sim api tutorial</a>, by calling the following functions in sequence:</p>\n<div class=\"codehilite\"><pre><span></span>% Define a new model.  Here, we&#39;re taking the cricket_ball model from:\n%  #!/osrf/gazebo_models/src/default/cricket_ball/model.sdf\n% and tweaking it slightly (just changing the color from Red to Green).\nsdf = &#39;<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.5&quot;</span><span class=\"nt\">&gt;</span> <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;cricket_ball&quot;</span><span class=\"nt\">&gt;</span> <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span> <span class=\"nt\">&lt;pose&gt;</span>0 0 0.0375 0 0 0<span class=\"nt\">&lt;/pose&gt;</span> <span class=\"nt\">&lt;inertial&gt;</span> <span class=\"nt\">&lt;mass&gt;</span>0.1467<span class=\"nt\">&lt;/mass&gt;</span> <span class=\"nt\">&lt;inertia&gt;</span> <span class=\"nt\">&lt;ixx&gt;</span>8.251875e-05<span class=\"nt\">&lt;/ixx&gt;</span> <span class=\"nt\">&lt;ixy&gt;</span>0<span class=\"nt\">&lt;/ixy&gt;</span> <span class=\"nt\">&lt;ixz&gt;</span>0<span class=\"nt\">&lt;/ixz&gt;</span> <span class=\"nt\">&lt;iyy&gt;</span>8.251875e-05<span class=\"nt\">&lt;/iyy&gt;</span> <span class=\"nt\">&lt;iyz&gt;</span>0<span class=\"nt\">&lt;/iyz&gt;</span> <span class=\"nt\">&lt;izz&gt;</span>8.251875e-05<span class=\"nt\">&lt;/izz&gt;</span> <span class=\"nt\">&lt;/inertia&gt;</span> <span class=\"nt\">&lt;/inertial&gt;</span> <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span> <span class=\"nt\">&lt;geometry&gt;</span> <span class=\"nt\">&lt;sphere&gt;</span> <span class=\"nt\">&lt;radius&gt;</span>0.0375<span class=\"nt\">&lt;/radius&gt;</span> <span class=\"nt\">&lt;/sphere&gt;</span> <span class=\"nt\">&lt;/geometry&gt;</span> <span class=\"nt\">&lt;/collision&gt;</span> <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span> <span class=\"nt\">&lt;geometry&gt;</span> <span class=\"nt\">&lt;sphere&gt;</span> <span class=\"nt\">&lt;radius&gt;</span>0.0375<span class=\"nt\">&lt;/radius&gt;</span> <span class=\"nt\">&lt;/sphere&gt;</span> <span class=\"nt\">&lt;/geometry&gt;</span> <span class=\"nt\">&lt;material&gt;</span> <span class=\"nt\">&lt;script&gt;</span> <span class=\"nt\">&lt;uri&gt;</span>file://media/materials/scripts/gazebo.material<span class=\"nt\">&lt;/uri&gt;</span> <span class=\"nt\">&lt;name&gt;</span>Gazebo/Green<span class=\"nt\">&lt;/name&gt;</span> <span class=\"nt\">&lt;/script&gt;</span> <span class=\"nt\">&lt;/material&gt;</span> <span class=\"nt\">&lt;/visual&gt;</span> <span class=\"nt\">&lt;/link&gt;</span> <span class=\"nt\">&lt;/model&gt;</span> <span class=\"nt\">&lt;/sdf&gt;</span>&#39;;\n% Add the new model to the world, at the world origin, 5m off the ground, with\n% gravity enabled.  Then it will drop onto the table.\nhxs_add_model(sdf, &#39;green_cricket_ball&#39;, [0; 0; 5], [0; 0; 0], 1);\npause(2);\n% Remove the model\nhxs_remove_model(&#39;green_cricket_ball&#39;);\npause(2);\n% Add back the same model\nhxs_add_model(sdf, &#39;green_cricket_ball&#39;, [0; 0; 5], [0; 0; 0], 1);\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>terminate called after throwing an instance of &#39;Ogre::ItemIdentityException&#39;\n\n  what():  OGRE EXCEPTION(4:ItemIdentityException): An object of type &#39;Entity&#39; with name &#39;green_cricket_ball::link_COM_VISUAL____SPHERE__&#39; already exists. in SceneManager::createMovableObject at /tmp/buildd/ogre3d-1.9-1.9.0~osrf2/OgreMain/src/OgreSceneManager.cpp (line 6853)\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2015-08-11T22:42:02.737276+00:00", "milestone": null, "updated_on": "2016-09-14T19:43:41.487196+00:00", "type": "issue", "id": 1702}