{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2530/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2530.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2530/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2530/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2530/links-moving-rotating-at-startup-when-they"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2530/vote"}}, "reporter": {"display_name": "Guilherme Carvalho", "uuid": "{ec55cf04-2f67-4985-8de6-ee193173387e}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bec55cf04-2f67-4985-8de6-ee193173387e%7D"}, "html": {"href": "https://bitbucket.org/%7Bec55cf04-2f67-4985-8de6-ee193173387e%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/839048b73a69b668617e1247d8d2c389d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsGC-0.png"}}, "nickname": "guilhermepscarvalho", "type": "user", "account_id": "5b3cc264e06ca62dc8ad964c"}, "title": "Links moving/rotating at startup when they are in a chain of fixed joints using bullet physics", "component": {"name": "physics::BulletPhysics", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/122884.json"}}}, "votes": 0, "watches": 2, "content": {"raw": "When there are two or more links attached to a base link through fixed type joints AND the orientation of one of those child links is near [pi 0 0] or [0 0 pi], as declared in the <pose> of the sdf, they move in the first iterations. This happens only when using bullet as the physics type.\r\n\r\ntest.world :\r\n\r\n```\r\n#!xml\r\n<?xml version='1.0'?>\r\n<sdf version='1.6'>\r\n  <world name='bug_world'>\r\n    <physics type='bullet'>\r\n    </physics>\r\n\r\n    <gravity>0 0 0</gravity>\r\n\r\n    <model name=\"model\">\r\n        <include>\r\n            <name>test</name>\r\n            <uri>model://test</uri>\r\n        </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n\r\n```\r\n\r\nmodel.sdf :\r\n\r\n```\r\n#!xml\r\n\r\n<?xml version='1.0'?>\r\n<sdf version='1.6'>\r\n  <model name='test'>\r\n\r\n    <link name='base'>\r\n      <gravity>0</gravity>\r\n    </link>\r\n    \r\n    <link name='ins1_frame'>\r\n      <gravity>0</gravity>\r\n      <pose>0 0.1 0 0 0 0</pose>\r\n      <visual name='ins1_visual'>\r\n        <geometry>\r\n          <mesh>\r\n              <uri>model://test/meshes/sensors/ins.dae</uri>\r\n          </mesh>\r\n        </geometry>\r\n      </visual>\r\n    </link>\r\n\r\n    <link name='ins2_frame'>\r\n      <gravity>0</gravity>\r\n      <pose>0 -0.1 0 3.14159 0 0</pose>\r\n      <visual name='ins2_visual'>\r\n        <geometry>\r\n          <mesh>\r\n              <uri>model://test/meshes/sensors/ins.dae</uri>\r\n          </mesh>\r\n        </geometry>\r\n      </visual>\r\n    </link>\r\n\r\n    <joint name='ins1_joint' type='fixed'>\r\n      <parent>base</parent>\r\n      <child>ins1_frame</child>\r\n    </joint>\r\n\r\n    <joint name='ins2_joint' type='fixed'>\r\n      <parent>base</parent>\r\n      <child>ins2_frame</child>\r\n    </joint>\r\n    \r\n  </model>\r\n</sdf>\r\n```\r\n\r\nResult:\r\n![bug.gif](data/bitbucket.org/repo/jgXqbo/images/1553944858-bug.gif)\r\n\r\nWhen the pose is not <pose>X Y Z 3.14159 0 0</pose> but <pose>X Y Z 3.14 0 0</pose>, for example, things work normally. I'm running Gazebo 8.6.0, didn't test the bug in Gazebo 9.", "markup": "markdown", "html": "<p>When there are two or more links attached to a base link through fixed type joints AND the orientation of one of those child links is near [pi 0 0] or [0 0 pi], as declared in the &lt;pose&gt; of the sdf, they move in the first iterations. This happens only when using bullet as the physics type.</p>\n<p>test.world :</p>\n<div class=\"codehilite language-xml\"><pre><span></span><span class=\"cp\">&lt;?xml version=&#39;1.0&#39;?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&#39;1.6&#39;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;world</span> <span class=\"na\">name=</span><span class=\"s\">&#39;bug_world&#39;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;physics</span> <span class=\"na\">type=</span><span class=\"s\">&#39;bullet&#39;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;/physics&gt;</span>\n\n    <span class=\"nt\">&lt;gravity&gt;</span>0 0 0<span class=\"nt\">&lt;/gravity&gt;</span>\n\n    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;model&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;include&gt;</span>\n            <span class=\"nt\">&lt;name&gt;</span>test<span class=\"nt\">&lt;/name&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>model://test<span class=\"nt\">&lt;/uri&gt;</span>\n        <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n  <span class=\"nt\">&lt;/world&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>model.sdf :</p>\n<div class=\"codehilite language-xml\"><pre><span></span><span class=\"cp\">&lt;?xml version=&#39;1.0&#39;?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&#39;1.6&#39;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&#39;test&#39;</span><span class=\"nt\">&gt;</span>\n\n    <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&#39;base&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;gravity&gt;</span>0<span class=\"nt\">&lt;/gravity&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n\n    <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins1_frame&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;gravity&gt;</span>0<span class=\"nt\">&lt;/gravity&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0.1 0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins1_visual&#39;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;mesh&gt;</span>\n              <span class=\"nt\">&lt;uri&gt;</span>model://test/meshes/sensors/ins.dae<span class=\"nt\">&lt;/uri&gt;</span>\n          <span class=\"nt\">&lt;/mesh&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;/visual&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n\n    <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins2_frame&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;gravity&gt;</span>0<span class=\"nt\">&lt;/gravity&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 -0.1 0 3.14159 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins2_visual&#39;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;mesh&gt;</span>\n              <span class=\"nt\">&lt;uri&gt;</span>model://test/meshes/sensors/ins.dae<span class=\"nt\">&lt;/uri&gt;</span>\n          <span class=\"nt\">&lt;/mesh&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;/visual&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n\n    <span class=\"nt\">&lt;joint</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins1_joint&#39;</span> <span class=\"na\">type=</span><span class=\"s\">&#39;fixed&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;parent&gt;</span>base<span class=\"nt\">&lt;/parent&gt;</span>\n      <span class=\"nt\">&lt;child&gt;</span>ins1_frame<span class=\"nt\">&lt;/child&gt;</span>\n    <span class=\"nt\">&lt;/joint&gt;</span>\n\n    <span class=\"nt\">&lt;joint</span> <span class=\"na\">name=</span><span class=\"s\">&#39;ins2_joint&#39;</span> <span class=\"na\">type=</span><span class=\"s\">&#39;fixed&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;parent&gt;</span>base<span class=\"nt\">&lt;/parent&gt;</span>\n      <span class=\"nt\">&lt;child&gt;</span>ins2_frame<span class=\"nt\">&lt;/child&gt;</span>\n    <span class=\"nt\">&lt;/joint&gt;</span>\n\n  <span class=\"nt\">&lt;/model&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>Result:\n<img alt=\"bug.gif\" src=\"data/bitbucket.org/repo/jgXqbo/images/1553944858-bug.gif\" /></p>\n<p>When the pose is not &lt;pose&gt;X Y Z 3.14159 0 0&lt;/pose&gt; but &lt;pose&gt;X Y Z 3.14 0 0&lt;/pose&gt;, for example, things work normally. I'm running Gazebo 8.6.0, didn't test the bug in Gazebo 9.</p>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2018-09-24T23:35:42.644172+00:00", "milestone": null, "updated_on": "2018-10-04T00:15:26.789759+00:00", "type": "issue", "id": 2530}