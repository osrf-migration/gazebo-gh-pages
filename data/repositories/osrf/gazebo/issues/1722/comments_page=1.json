{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/22561465.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-22561465"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "Thanks for the report. I assume this is the change you are proposing?\r\n~~~\r\ndiff -r 574b668cfac0 gazebo/physics/Entity.cc\r\n--- a/gazebo/physics/Entity.cc\tFri Oct 16 12:54:21 2015 -0700\r\n+++ b/gazebo/physics/Entity.cc\tFri Oct 16 16:47:22 2015 -0700\r\n@@ -595,7 +595,6 @@\r\n   Base::Fini();\r\n \r\n   this->connections.clear();\r\n-  this->node->Fini();\r\n }\r\n \r\n //////////////////////////////////////////////////\r\n~~~", "markup": "markdown", "html": "<p>Thanks for the report. I assume this is the change you are proposing?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 574b668cfac0 gazebo/physics/Entity.cc</span>\n<span class=\"gd\">--- a/gazebo/physics/Entity.cc  Fri Oct 16 12:54:21 2015 -0700</span>\n<span class=\"gi\">+++ b/gazebo/physics/Entity.cc  Fri Oct 16 16:47:22 2015 -0700</span>\n<span class=\"gu\">@@ -595,7 +595,6 @@</span>\n   Base::Fini();\n\n   this-&gt;connections.clear();\n<span class=\"gd\">-  this-&gt;node-&gt;Fini();</span>\n }\n\n //////////////////////////////////////////////////\n</pre></div>", "type": "rendered"}, "created_on": "2015-10-16T23:47:47.345671+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 22561465}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/22850441.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-22850441"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "I've committed that patch in 4aca9aa88aab (branched off of `gazebo6`) and queued a jenkins job. I had already done some testing on my local machine and observed some new test failures. I'm running the jenkins job to confirm.", "markup": "markdown", "html": "<p>I've committed that patch in <a href=\"#!/osrf/gazebo/commits/4aca9aa88aab\" rel=\"nofollow\" class=\"ap-connect-link\">4aca9aa88aab</a> (branched off of <code>gazebo6</code>) and queued a jenkins job. I had already done some testing on my local machine and observed some new test failures. I'm running the jenkins job to confirm.</p>", "type": "rendered"}, "created_on": "2015-10-26T21:10:25.495934+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 22850441}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/22866980.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-22866980"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "I think that was my proposed change, but I'm away from home without a PC for a few weeks (oh the blissful silence ;]) so I'm not 100% certain. I'll have a look when I get back next week.", "markup": "markdown", "html": "<p>I think that was my proposed change, but I'm away from home without a PC for a few weeks (oh the blissful silence ;]) so I'm not 100% certain. I'll have a look when I get back next week.</p>", "type": "rendered"}, "created_on": "2015-10-27T12:30:48.408814+00:00", "user": {"display_name": "Elte Hupkes", "uuid": "{f23aa1a9-ae57-493f-8169-fbb59b3eae43}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D"}, "html": {"href": "https://bitbucket.org/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/8560ee94d50ba277c411499a45b3d732d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEH-5.png"}}, "nickname": "ElteHupkes", "type": "user", "account_id": "557058:b758f523-bdaa-4718-964c-03b825bdea8d"}, "updated_on": null, "type": "issue_comment", "id": 22866980}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/22881439.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-22881439"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "I'm seeing a seg-fault in the [REGRESSION_1702_remove_model_scene_nodes](http://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-any-devel-trusty-amd64-gpu-nvidia/581/testReport/junit/(root)/REGRESSION_1702_remove_model_scene_nodes/test_ran/) test.\n\n~~~\n35/40 Test #395: REGRESSION_1702_remove_model_scene_nodes ...........***Exception: SegFault 22.78 sec\n~~~", "markup": "markdown", "html": "<p>I'm seeing a seg-fault in the <a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/view/main/view/gazebo/job/gazebo-any-devel-trusty-amd64-gpu-nvidia/581/testReport/junit/(root)/REGRESSION_1702_remove_model_scene_nodes/test_ran/\" rel=\"nofollow\">REGRESSION_1702_remove_model_scene_nodes</a> test.</p>\n<div class=\"codehilite\"><pre><span></span>35/40 Test #395: REGRESSION_1702_remove_model_scene_nodes ...........***Exception: SegFault 22.78 sec\n</pre></div>", "type": "rendered"}, "created_on": "2015-10-27T20:52:16.433666+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 22881439}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/23548462.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-23548462"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "Ah ok there's actually a big issue with this fix because `Node` registers / deregisters itself with the `TopicManager` in `Node::Fini()`, meaning the use counter of the node shared pointer will never actually go to zero unless `Node::Fini()` is called. This obviously will not happen if `Node::Fini()` is only called by `Node::~Node()` so with this solution nodes are actually never deleted :#.\n\nRight now I'm experimenting with calling `this->node->Fini()` in `Entity::~Entity()` rather than in `Entity::Fini()`.", "markup": "markdown", "html": "<p>Ah ok there's actually a big issue with this fix because <code>Node</code> registers / deregisters itself with the <code>TopicManager</code> in <code>Node::Fini()</code>, meaning the use counter of the node shared pointer will never actually go to zero unless <code>Node::Fini()</code> is called. This obviously will not happen if <code>Node::Fini()</code> is only called by <code>Node::~Node()</code> so with this solution nodes are actually never deleted :#.</p>\n<p>Right now I'm experimenting with calling <code>this-&gt;node-&gt;Fini()</code> in <code>Entity::~Entity()</code> rather than in <code>Entity::Fini()</code>.</p>", "type": "rendered"}, "created_on": "2015-11-24T13:31:57.837738+00:00", "user": {"display_name": "Elte Hupkes", "uuid": "{f23aa1a9-ae57-493f-8169-fbb59b3eae43}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D"}, "html": {"href": "https://bitbucket.org/%7Bf23aa1a9-ae57-493f-8169-fbb59b3eae43%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/8560ee94d50ba277c411499a45b3d732d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEH-5.png"}}, "nickname": "ElteHupkes", "type": "user", "account_id": "557058:b758f523-bdaa-4718-964c-03b825bdea8d"}, "updated_on": null, "type": "issue_comment", "id": 23548462}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722/comments/27303021.json"}, "html": {"href": "#!/osrf/gazebo/issues/1722#comment-27303021"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1722.json"}}, "type": "issue", "id": 1722, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Empty message types caused by `Entity::Fini()` calling `Node::Fini()`"}, "content": {"raw": "I just saw this issue. Some changes were made in pull request #2263:\n\n1. `Entity::~Entity` calls `Entity::Fini` and nothing else.\n\n1. `Entity::Fini` resets publishers and subscribers, and then calls `Node::Fini`, only if the node hasn't been reset yet. (Fini can be called multiple times)\n\nThese were based on [this](#!/osrf/gazebo_design/pull-requests/30/smart-pointers-in-gazebo-physics-world/diff) design document (which is under development). This is an attempt to clean up smart pointers in the least intrusive way for now while we work on a more elegant solution which would probably break API.\n\nLet me know what you think and whether this solves your issue.", "markup": "markdown", "html": "<p>I just saw this issue. Some changes were made in <a href=\"#!/osrf/gazebo/pull-requests/2263/clean-up-entities\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #2263</a>:</p>\n<ol>\n<li>\n<p><code>Entity::~Entity</code> calls <code>Entity::Fini</code> and nothing else.</p>\n</li>\n<li>\n<p><code>Entity::Fini</code> resets publishers and subscribers, and then calls <code>Node::Fini</code>, only if the node hasn't been reset yet. (Fini can be called multiple times)</p>\n</li>\n</ol>\n<p>These were based on <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo_design/pull-requests/30/smart-pointers-in-gazebo-physics-world/diff\" rel=\"nofollow\">this</a> design document (which is under development). This is an attempt to clean up smart pointers in the least intrusive way for now while we work on a more elegant solution which would probably break API.</p>\n<p>Let me know what you think and whether this solves your issue.</p>", "type": "rendered"}, "created_on": "2016-04-26T21:33:20.968984+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": null, "type": "issue_comment", "id": 27303021}], "page": 1, "size": 6}