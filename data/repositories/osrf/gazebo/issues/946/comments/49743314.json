{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/946/comments/49743314.json"}, "html": {"href": "#!/osrf/gazebo/issues/946#comment-49743314"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/946.json"}}, "type": "issue", "id": 946, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "gpu ray sensor vertical ranges"}, "content": {"raw": "I still have the same problem \u2013 the resolution for vertical scans is very rough. The problem is especially bad for low-lying lidars with a small vertical angular resolution and high working range, like, MRS1104C-111011. \nI have it on both gazebo 9.6 and 7.14. \n\nI tested it on:\n\n1. Ubuntu 16.04 + GTX 1050 + gazebo 9.6/gazebo 7.14 + nvidia 384/nvidia 415 \n\n2. Ubuntu 16.04 + GTX 1080/GTX 780 + gazebo 9.6 + nvidia 384\n\nHere is my world (sdf) files and images of how they work in my case.  \n\nray_cpu.world\n```\n#!xml\n<?xml version=\"1.0\" ?>\n<sdf version=\"1.5\">\n  <world name=\"default\">\n    <!-- A global light source -->\n    <include>\n      <uri>model://sun</uri>\n    </include>\n    <!-- A ground plane -->\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n    <model name=\"velodyne\">\n      <static>true</static>\n      <pose>0 0 0.1 0 0 0</pose>\n      <link name=\"link\">\n        <inertial>\n          <mass>0.1</mass>\n        </inertial>\n        <collision name=\"collision\">\n          <geometry>\n            <box>\n              <size>0.2 0.2 0.2</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name=\"visual\">\n          <geometry>\n            <box>\n              <size>0.2 0.2 0.2</size>\n            </box>\n          </geometry>\n        </visual>\n        <sensor name=\"laser\" type=\"ray\">\n          <pose>1.0 0 0.5 0 -0 0</pose>\n          <ray>\n            <scan>\n              <horizontal>\n                <samples>1100</samples>\n                <resolution>1</resolution>\n                <min_angle>-2.39</min_angle>\n                <max_angle>2.39</max_angle>\n              </horizontal>\n              <vertical>\n                <samples>2</samples>\n                <resolution>1</resolution>\n                <min_angle>-0.09</min_angle>\n                <max_angle>-0.045</max_angle>\n              </vertical>\n            </scan>\n            <range>\n              <min>0.3</min>\n              <max>64</max>\n              <resolution>0.001</resolution>\n            </range>\n          </ray>\n          <always_on>1</always_on>\n          <update_rate>30</update_rate>\n          <visualize>true</visualize>\n        </sensor>\n      </link>\n    </model>\n  </world>\n</sdf>\n\n\n```\nray_gpu.world\n\n```\n#!xml\n<?xml version=\"1.0\" ?>\n<sdf version=\"1.5\">\n  <world name=\"default\">\n    <!-- A global light source -->\n    <include>\n      <uri>model://sun</uri>\n    </include>\n    <!-- A ground plane -->\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n    <model name=\"velodyne\">\n      <static>true</static>\n      <pose>0 0 0.1 0 0 0</pose>\n      <link name=\"link\">\n        <inertial>\n          <mass>0.1</mass>\n        </inertial>\n        <collision name=\"collision\">\n          <geometry>\n            <box>\n              <size>0.2 0.2 0.2</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name=\"visual\">\n          <geometry>\n            <box>\n              <size>0.2 0.2 0.2</size>\n            </box>\n          </geometry>\n        </visual>\n        <sensor name=\"laser\" type=\"gpu_ray\">\n          <pose>1.0 0 0.5 0 -0 0</pose>\n          <ray>\n            <scan>\n              <horizontal>\n                <samples>1100</samples>\n                <resolution>1</resolution>\n                <min_angle>-2.39</min_angle>\n                <max_angle>2.39</max_angle>\n              </horizontal>\n              <vertical>\n                <samples>2</samples>\n                <resolution>1</resolution>\n                <min_angle>-0.09</min_angle>\n                <max_angle>-0.045</max_angle>\n              </vertical>\n            </scan>\n            <range>\n              <min>0.3</min>\n              <max>64</max>\n              <resolution>0.001</resolution>\n            </range>\n          </ray>\n          <always_on>1</always_on>\n          <update_rate>30</update_rate>\n          <visualize>true</visualize>\n        </sensor>\n      </link>\n    </model>\n  </world>\n</sdf>\n\n\n```\ngazebo 7.14 - cpu ray\n![7-cpu.png](data/bitbucket.org/repo/jgXqbo/images/621299507-7-cpu.png)\ngazebo 7.14 - gpu ray\n![7-gpu.png](data/bitbucket.org/repo/jgXqbo/images/1914566622-7-gpu.png)\ngazebo 9.6 - cpu ray\n![9-cpu.png](data/bitbucket.org/repo/jgXqbo/images/792769661-9-cpu.png)\ngazebo 9.6 - gpu ray\n![9-gpu.png](data/bitbucket.org/repo/jgXqbo/images/3164326772-9-gpu.png)", "markup": "markdown", "html": "<p>I still have the same problem \u2013 the resolution for vertical scans is very rough. The problem is especially bad for low-lying lidars with a small vertical angular resolution and high working range, like, MRS1104C-111011. \nI have it on both gazebo 9.6 and 7.14. </p>\n<p>I tested it on:</p>\n<ol>\n<li>\n<p>Ubuntu 16.04 + GTX 1050 + gazebo 9.6/gazebo 7.14 + nvidia 384/nvidia 415 </p>\n</li>\n<li>\n<p>Ubuntu 16.04 + GTX 1080/GTX 780 + gazebo 9.6 + nvidia 384</p>\n</li>\n</ol>\n<p>Here is my world (sdf) files and images of how they work in my case.  </p>\n<p>ray_cpu.world</p>\n<div class=\"codehilite language-xml\"><pre><span></span><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.5&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;world</span> <span class=\"na\">name=</span><span class=\"s\">&quot;default&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"c\">&lt;!-- A global light source --&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://sun<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"c\">&lt;!-- A ground plane --&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://ground_plane<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;velodyne&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;static&gt;</span>true<span class=\"nt\">&lt;/static&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0 0.1 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;inertial&gt;</span>\n          <span class=\"nt\">&lt;mass&gt;</span>0.1<span class=\"nt\">&lt;/mass&gt;</span>\n        <span class=\"nt\">&lt;/inertial&gt;</span>\n        <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>0.2 0.2 0.2<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/collision&gt;</span>\n        <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>0.2 0.2 0.2<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/visual&gt;</span>\n        <span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;laser&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;ray&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;pose&gt;</span>1.0 0 0.5 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n          <span class=\"nt\">&lt;ray&gt;</span>\n            <span class=\"nt\">&lt;scan&gt;</span>\n              <span class=\"nt\">&lt;horizontal&gt;</span>\n                <span class=\"nt\">&lt;samples&gt;</span>1100<span class=\"nt\">&lt;/samples&gt;</span>\n                <span class=\"nt\">&lt;resolution&gt;</span>1<span class=\"nt\">&lt;/resolution&gt;</span>\n                <span class=\"nt\">&lt;min_angle&gt;</span>-2.39<span class=\"nt\">&lt;/min_angle&gt;</span>\n                <span class=\"nt\">&lt;max_angle&gt;</span>2.39<span class=\"nt\">&lt;/max_angle&gt;</span>\n              <span class=\"nt\">&lt;/horizontal&gt;</span>\n              <span class=\"nt\">&lt;vertical&gt;</span>\n                <span class=\"nt\">&lt;samples&gt;</span>2<span class=\"nt\">&lt;/samples&gt;</span>\n                <span class=\"nt\">&lt;resolution&gt;</span>1<span class=\"nt\">&lt;/resolution&gt;</span>\n                <span class=\"nt\">&lt;min_angle&gt;</span>-0.09<span class=\"nt\">&lt;/min_angle&gt;</span>\n                <span class=\"nt\">&lt;max_angle&gt;</span>-0.045<span class=\"nt\">&lt;/max_angle&gt;</span>\n              <span class=\"nt\">&lt;/vertical&gt;</span>\n            <span class=\"nt\">&lt;/scan&gt;</span>\n            <span class=\"nt\">&lt;range&gt;</span>\n              <span class=\"nt\">&lt;min&gt;</span>0.3<span class=\"nt\">&lt;/min&gt;</span>\n              <span class=\"nt\">&lt;max&gt;</span>64<span class=\"nt\">&lt;/max&gt;</span>\n              <span class=\"nt\">&lt;resolution&gt;</span>0.001<span class=\"nt\">&lt;/resolution&gt;</span>\n            <span class=\"nt\">&lt;/range&gt;</span>\n          <span class=\"nt\">&lt;/ray&gt;</span>\n          <span class=\"nt\">&lt;always_on&gt;</span>1<span class=\"nt\">&lt;/always_on&gt;</span>\n          <span class=\"nt\">&lt;update_rate&gt;</span>30<span class=\"nt\">&lt;/update_rate&gt;</span>\n          <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n        <span class=\"nt\">&lt;/sensor&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n  <span class=\"nt\">&lt;/world&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>ray_gpu.world</p>\n<div class=\"codehilite language-xml\"><pre><span></span><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.5&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;world</span> <span class=\"na\">name=</span><span class=\"s\">&quot;default&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"c\">&lt;!-- A global light source --&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://sun<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"c\">&lt;!-- A ground plane --&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://ground_plane<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;velodyne&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;static&gt;</span>true<span class=\"nt\">&lt;/static&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0 0.1 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;inertial&gt;</span>\n          <span class=\"nt\">&lt;mass&gt;</span>0.1<span class=\"nt\">&lt;/mass&gt;</span>\n        <span class=\"nt\">&lt;/inertial&gt;</span>\n        <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>0.2 0.2 0.2<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/collision&gt;</span>\n        <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>0.2 0.2 0.2<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/visual&gt;</span>\n        <span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;laser&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;gpu_ray&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;pose&gt;</span>1.0 0 0.5 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n          <span class=\"nt\">&lt;ray&gt;</span>\n            <span class=\"nt\">&lt;scan&gt;</span>\n              <span class=\"nt\">&lt;horizontal&gt;</span>\n                <span class=\"nt\">&lt;samples&gt;</span>1100<span class=\"nt\">&lt;/samples&gt;</span>\n                <span class=\"nt\">&lt;resolution&gt;</span>1<span class=\"nt\">&lt;/resolution&gt;</span>\n                <span class=\"nt\">&lt;min_angle&gt;</span>-2.39<span class=\"nt\">&lt;/min_angle&gt;</span>\n                <span class=\"nt\">&lt;max_angle&gt;</span>2.39<span class=\"nt\">&lt;/max_angle&gt;</span>\n              <span class=\"nt\">&lt;/horizontal&gt;</span>\n              <span class=\"nt\">&lt;vertical&gt;</span>\n                <span class=\"nt\">&lt;samples&gt;</span>2<span class=\"nt\">&lt;/samples&gt;</span>\n                <span class=\"nt\">&lt;resolution&gt;</span>1<span class=\"nt\">&lt;/resolution&gt;</span>\n                <span class=\"nt\">&lt;min_angle&gt;</span>-0.09<span class=\"nt\">&lt;/min_angle&gt;</span>\n                <span class=\"nt\">&lt;max_angle&gt;</span>-0.045<span class=\"nt\">&lt;/max_angle&gt;</span>\n              <span class=\"nt\">&lt;/vertical&gt;</span>\n            <span class=\"nt\">&lt;/scan&gt;</span>\n            <span class=\"nt\">&lt;range&gt;</span>\n              <span class=\"nt\">&lt;min&gt;</span>0.3<span class=\"nt\">&lt;/min&gt;</span>\n              <span class=\"nt\">&lt;max&gt;</span>64<span class=\"nt\">&lt;/max&gt;</span>\n              <span class=\"nt\">&lt;resolution&gt;</span>0.001<span class=\"nt\">&lt;/resolution&gt;</span>\n            <span class=\"nt\">&lt;/range&gt;</span>\n          <span class=\"nt\">&lt;/ray&gt;</span>\n          <span class=\"nt\">&lt;always_on&gt;</span>1<span class=\"nt\">&lt;/always_on&gt;</span>\n          <span class=\"nt\">&lt;update_rate&gt;</span>30<span class=\"nt\">&lt;/update_rate&gt;</span>\n          <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n        <span class=\"nt\">&lt;/sensor&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n  <span class=\"nt\">&lt;/world&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>gazebo 7.14 - cpu ray\n<img alt=\"7-cpu.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/621299507-7-cpu.png\" />\ngazebo 7.14 - gpu ray\n<img alt=\"7-gpu.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/1914566622-7-gpu.png\" />\ngazebo 9.6 - cpu ray\n<img alt=\"9-cpu.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/792769661-9-cpu.png\" />\ngazebo 9.6 - gpu ray\n<img alt=\"9-gpu.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/3164326772-9-gpu.png\" /></p>", "type": "rendered"}, "created_on": "2019-01-04T18:18:11.888652+00:00", "user": {"display_name": "Ilea Baltashov", "uuid": "{c494d5a7-3ac7-412d-aa0e-df970a70e8f6}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc494d5a7-3ac7-412d-aa0e-df970a70e8f6%7D"}, "html": {"href": "https://bitbucket.org/%7Bc494d5a7-3ac7-412d-aa0e-df970a70e8f6%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/bcbaa5e5462a04b98294ea0c4e6a03c9d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsIB-0.png"}}, "nickname": "Baltic1996", "type": "user", "account_id": "5a785dd72d61371e861f6b1e"}, "updated_on": "2019-01-04T18:20:17.650956+00:00", "type": "issue_comment", "id": 49743314}