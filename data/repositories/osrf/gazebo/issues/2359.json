{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2359/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2359.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2359/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2359/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2359/minimum-cmake-version"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2359/vote"}}, "reporter": {"display_name": "Martin Pecka", "uuid": "{41691c43-4ae0-49ba-ba45-3c36439f5af2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B41691c43-4ae0-49ba-ba45-3c36439f5af2%7D"}, "html": {"href": "https://bitbucket.org/%7B41691c43-4ae0-49ba-ba45-3c36439f5af2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d1ad32a09564f856909994613fdbc37cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMP-1.png"}}, "nickname": "peci1", "type": "user", "account_id": "557058:434ecab2-e510-4ede-8f9a-1c2a5a4032e1"}, "title": "Minimum CMake version?", "component": {"name": "build", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/132954.json"}}}, "votes": 0, "watches": 1, "content": {"raw": "In the `CMakesLists.txt` throughout the project, the minimum CMake version is said to be 2.8 .\r\n\r\nI'm testing gazebo8 branch on Ubuntu Trusty, which comes with CMake 3.2, and I have problems linking these integration tests: collada_visualization, insert_model, mouse_pick, visual_pose.\r\n\r\nThe linking error is always the same:\r\n\r\n```\r\nLinking CXX executable INTEGRATION_collada_visualization\r\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `QTestFixture::~QTestFixture()':\r\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/gazebo/gui/QTestFixture.hh:37: undefined reference to `vtable for QTestFixture'\r\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `ColladaVisualization::ColladaVisualization()':\r\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/test/integration/collada_visualization.hh:24: undefined reference to `vtable for ColladaVisualization'\r\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `ColladaVisualization::~ColladaVisualization()':\r\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/test/integration/collada_visualization.hh:24: undefined reference to `vtable for ColladaVisualization'\r\nCMakeFiles/INTEGRATION_collada_visualization.dir/__/__/gazebo/gui/QTestFixture.cc.o: In function `QTestFixture::QTestFixture()':\r\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/gazebo/gui/QTestFixture.cc:39: undefined reference to `vtable for QTestFixture'\r\ncollect2: error: ld returned 1 exit status\r\nmake[3]: *** [test/integration/INTEGRATION_collada_visualization] Error 1\r\n```\r\nAfter a while of googling, I think it is because automoc is not called on these files. But I don't know why. The automoc targets for these tests are not even generated by CMake.\r\n\r\nBut when I use CMake bundled with my IDE (CMake 3.9), the automoc/autogen targets are generated and I can successfully link these tests.\r\n\r\nI've noticed there were some changes regarding automoc in CMake 3.8 and 3.9. But the default version on Xenial is 3.5, and I assume building of the tests works fine on Xenial.\r\n\r\nSo maybe it's time to increase the minimum CMake version to at least 3.5?", "markup": "markdown", "html": "<p>In the <code>CMakesLists.txt</code> throughout the project, the minimum CMake version is said to be 2.8 .</p>\n<p>I'm testing gazebo8 branch on Ubuntu Trusty, which comes with CMake 3.2, and I have problems linking these integration tests: collada_visualization, insert_model, mouse_pick, visual_pose.</p>\n<p>The linking error is always the same:</p>\n<div class=\"codehilite\"><pre><span></span>Linking CXX executable INTEGRATION_collada_visualization\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `QTestFixture::~QTestFixture()&#39;:\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/gazebo/gui/QTestFixture.hh:37: undefined reference to `vtable for QTestFixture&#39;\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `ColladaVisualization::ColladaVisualization()&#39;:\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/test/integration/collada_visualization.hh:24: undefined reference to `vtable for ColladaVisualization&#39;\nCMakeFiles/INTEGRATION_collada_visualization.dir/collada_visualization.cc.o: In function `ColladaVisualization::~ColladaVisualization()&#39;:\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/test/integration/collada_visualization.hh:24: undefined reference to `vtable for ColladaVisualization&#39;\nCMakeFiles/INTEGRATION_collada_visualization.dir/__/__/gazebo/gui/QTestFixture.cc.o: In function `QTestFixture::QTestFixture()&#39;:\n/home/peci1/tradr-git/drivers/gazebo7-ws/src/gazebo/gazebo/gui/QTestFixture.cc:39: undefined reference to `vtable for QTestFixture&#39;\ncollect2: error: ld returned 1 exit status\nmake[3]: *** [test/integration/INTEGRATION_collada_visualization] Error 1\n</pre></div>\n\n\n<p>After a while of googling, I think it is because automoc is not called on these files. But I don't know why. The automoc targets for these tests are not even generated by CMake.</p>\n<p>But when I use CMake bundled with my IDE (CMake 3.9), the automoc/autogen targets are generated and I can successfully link these tests.</p>\n<p>I've noticed there were some changes regarding automoc in CMake 3.8 and 3.9. But the default version on Xenial is 3.5, and I assume building of the tests works fine on Xenial.</p>\n<p>So maybe it's time to increase the minimum CMake version to at least 3.5?</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "8.1", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/243455.json"}}}, "edited_on": null, "created_on": "2017-10-11T18:45:46.454262+00:00", "milestone": null, "updated_on": "2017-10-11T18:45:46.454262+00:00", "type": "issue", "id": 2359}