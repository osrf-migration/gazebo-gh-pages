{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2309/comments/38097505.json"}, "html": {"href": "#!/osrf/gazebo/issues/2309#comment-38097505"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2309.json"}}, "type": "issue", "id": 2309, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Simbody exception when manipulating object twice while paused"}, "content": {"raw": "The problem appears to be triggered by Gazebo's user command manager, which enables undo and redo. The exception occurs when it [queries the state of Simbody's integrator](#!/osrf/gazebo/src/8482aaa07fc9c7bddcd23cd638eca15d79618f0f/gazebo/physics/simbody/SimbodyLink.cc?at=default&fileviewer=file-view-default#SimbodyLink.cc-436). A backtrace:\n\n~~~\n#0  0x00007ffff65b7428 in __GI_raise (sig=sig@entry=6)\n    at ../sysdeps/unix/sysv/linux/raise.c:54\n#1  0x00007ffff65b902a in __GI_abort () at abort.c:89\n#2  0x00007ffff6efa84d in __gnu_cxx::__verbose_terminate_handler() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff6ef86b6 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff6ef8701 in std::terminate() ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff6ef8919 in __cxa_throw ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007fffed26edc4 in SimTK::StateImpl::getCacheEntry(SimTK::SubsystemIndex, SimTK::CacheEntryIndex) const ()\n   from /usr/lib/x86_64-linux-gnu/libSimTKsimbody.so.3.5\n#7  0x00007fffed4d5474 in SimTK::MobilizedBody::getBodyVelocity(SimTK::State const&) const () from /usr/lib/x86_64-linux-gnu/libSimTKsimbody.so.3.5\n#8  0x00007ffff5a29295 in SimTK::MobilizedBody::getBodyAngularVelocity (\n    this=0x17cce38, state=...)\n    at /usr/include/simbody/simbody/internal/MobilizedBody.h:354\n#9  0x00007ffff5a264bd in gazebo::physics::SimbodyLink::GetWorldAngularVel (\n    this=0x17cc910)\n    at /home/osrf/gazebo7/src/gazebo/gazebo/physics/simbody/SimbodyLink.cc:444\n#10 0x00007ffff5b13ba8 in gazebo::physics::LinkState::LinkState (\n    this=0x7fffcd06a190, _link=..., _realTime=..., _simTime=..., \n    _iterations=80754)\n    at /home/osrf/gazebo7/src/gazebo/gazebo/physics/LinkState.cc:44\n#11 0x00007ffff5b3bf0e in gazebo::physics::ModelState::ModelState (\n    this=0x7fffcd06a760, _model=..., _realTime=..., _simTime=..., \n    _iterations=80754)\n    at /home/osrf/gazebo7/src/gazebo/gazebo/physics/ModelState.cc:45\n#12 0x00007ffff5bc7616 in gazebo::physics::WorldState::WorldState (\n    this=0x7fffcd06aab0, _world=...)\n    at /home/osrf/gazebo7/src/gazebo/gazebo/physics/WorldState.cc:61\n#13 0x00007ffff5b80162 in gazebo::physics::UserCmd::UserCmd (\n    this=0x7fff80003940, _id=1, _world=..., \n    _description=\"Translate [unit_box]\", \n    _type=@0x7fffcd06abfc: gazebo::msgs::UserCmd_Type_MOVING)\n    at /home/osrf/gazebo7/src/gazebo/gazebo/physics/UserCmdManager.cc:51\n~~~\n\nSo, tests that translate the object through the \"~/model/modify\" topic directly do not detect the exception.", "markup": "markdown", "html": "<p>The problem appears to be triggered by Gazebo's user command manager, which enables undo and redo. The exception occurs when it <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/8482aaa07fc9c7bddcd23cd638eca15d79618f0f/gazebo/physics/simbody/SimbodyLink.cc?at=default&amp;fileviewer=file-view-default#SimbodyLink.cc-436\" rel=\"nofollow\">queries the state of Simbody's integrator</a>. A backtrace:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">#0  0x00007ffff65b7428 in __GI_raise (sig=sig@entry=6)</span>\n    <span class=\"n\">at</span> <span class=\"p\">..</span><span class=\"o\">/</span><span class=\"n\">sysdeps</span><span class=\"o\">/</span><span class=\"n\">unix</span><span class=\"o\">/</span><span class=\"n\">sysv</span><span class=\"o\">/</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">raise</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">54</span>\n<span class=\"cp\">#1  0x00007ffff65b902a in __GI_abort () at abort.c:89</span>\n<span class=\"cp\">#2  0x00007ffff6efa84d in __gnu_cxx::__verbose_terminate_handler() ()</span>\n   <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">libstdc</span><span class=\"o\">++</span><span class=\"p\">.</span><span class=\"n\">so</span><span class=\"mf\">.6</span>\n<span class=\"cp\">#3  0x00007ffff6ef86b6 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6</span>\n<span class=\"cp\">#4  0x00007ffff6ef8701 in std::terminate() ()</span>\n   <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">libstdc</span><span class=\"o\">++</span><span class=\"p\">.</span><span class=\"n\">so</span><span class=\"mf\">.6</span>\n<span class=\"cp\">#5  0x00007ffff6ef8919 in __cxa_throw ()</span>\n   <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">libstdc</span><span class=\"o\">++</span><span class=\"p\">.</span><span class=\"n\">so</span><span class=\"mf\">.6</span>\n<span class=\"cp\">#6  0x00007fffed26edc4 in SimTK::StateImpl::getCacheEntry(SimTK::SubsystemIndex, SimTK::CacheEntryIndex) const ()</span>\n   <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">libSimTKsimbody</span><span class=\"p\">.</span><span class=\"n\">so</span><span class=\"mf\">.3.5</span>\n<span class=\"cp\">#7  0x00007fffed4d5474 in SimTK::MobilizedBody::getBodyVelocity(SimTK::State const&amp;) const () from /usr/lib/x86_64-linux-gnu/libSimTKsimbody.so.3.5</span>\n<span class=\"cp\">#8  0x00007ffff5a29295 in SimTK::MobilizedBody::getBodyAngularVelocity (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x17cce38</span><span class=\"p\">,</span> <span class=\"n\">state</span><span class=\"o\">=</span><span class=\"p\">...)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">simbody</span><span class=\"o\">/</span><span class=\"n\">simbody</span><span class=\"o\">/</span><span class=\"n\">internal</span><span class=\"o\">/</span><span class=\"n\">MobilizedBody</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">354</span>\n<span class=\"cp\">#9  0x00007ffff5a264bd in gazebo::physics::SimbodyLink::GetWorldAngularVel (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x17cc910</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">osrf</span><span class=\"o\">/</span><span class=\"n\">gazebo7</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">simbody</span><span class=\"o\">/</span><span class=\"n\">SimbodyLink</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">444</span>\n<span class=\"cp\">#10 0x00007ffff5b13ba8 in gazebo::physics::LinkState::LinkState (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x7fffcd06a190</span><span class=\"p\">,</span> <span class=\"n\">_link</span><span class=\"o\">=</span><span class=\"p\">...,</span> <span class=\"n\">_realTime</span><span class=\"o\">=</span><span class=\"p\">...,</span> <span class=\"n\">_simTime</span><span class=\"o\">=</span><span class=\"p\">...,</span> \n    <span class=\"n\">_iterations</span><span class=\"o\">=</span><span class=\"mi\">80754</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">osrf</span><span class=\"o\">/</span><span class=\"n\">gazebo7</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">LinkState</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">44</span>\n<span class=\"cp\">#11 0x00007ffff5b3bf0e in gazebo::physics::ModelState::ModelState (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x7fffcd06a760</span><span class=\"p\">,</span> <span class=\"n\">_model</span><span class=\"o\">=</span><span class=\"p\">...,</span> <span class=\"n\">_realTime</span><span class=\"o\">=</span><span class=\"p\">...,</span> <span class=\"n\">_simTime</span><span class=\"o\">=</span><span class=\"p\">...,</span> \n    <span class=\"n\">_iterations</span><span class=\"o\">=</span><span class=\"mi\">80754</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">osrf</span><span class=\"o\">/</span><span class=\"n\">gazebo7</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">ModelState</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">45</span>\n<span class=\"cp\">#12 0x00007ffff5bc7616 in gazebo::physics::WorldState::WorldState (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x7fffcd06aab0</span><span class=\"p\">,</span> <span class=\"n\">_world</span><span class=\"o\">=</span><span class=\"p\">...)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">osrf</span><span class=\"o\">/</span><span class=\"n\">gazebo7</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">WorldState</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">61</span>\n<span class=\"cp\">#13 0x00007ffff5b80162 in gazebo::physics::UserCmd::UserCmd (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x7fff80003940</span><span class=\"p\">,</span> <span class=\"n\">_id</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">_world</span><span class=\"o\">=</span><span class=\"p\">...,</span> \n    <span class=\"n\">_description</span><span class=\"o\">=</span><span class=\"s\">&quot;Translate [unit_box]&quot;</span><span class=\"p\">,</span> \n    <span class=\"n\">_type</span><span class=\"o\">=</span><span class=\"mh\">@0x7fffcd06abfc</span><span class=\"o\">:</span> <span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">msgs</span><span class=\"o\">::</span><span class=\"n\">UserCmd_Type_MOVING</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">osrf</span><span class=\"o\">/</span><span class=\"n\">gazebo7</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">UserCmdManager</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">51</span>\n</pre></div>\n\n\n<p>So, tests that translate the object through the \"~/model/modify\" topic directly do not detect the exception.</p>", "type": "rendered"}, "created_on": "2017-07-07T21:44:51.282384+00:00", "user": {"display_name": "Peter Horak", "uuid": "{c72abe74-c12a-4128-a6fc-94f3844ac8ef}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D"}, "html": {"href": "https://bitbucket.org/%7Bc72abe74-c12a-4128-a6fc-94f3844ac8ef%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a/87d803b7-3e50-40c1-8159-a5c20abd84ea/128"}}, "nickname": "pchorak", "type": "user", "account_id": "557058:451ed60b-3cfa-4a97-b4d3-a3fc34c2b21a"}, "updated_on": "2017-07-07T21:45:11.667658+00:00", "type": "issue_comment", "id": 38097505}