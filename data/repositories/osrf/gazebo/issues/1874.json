{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1874/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1874.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1874/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1874/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1874/simbody-bullet-dependencies-not-added-to"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1874/vote"}}, "reporter": {"display_name": "Nicolae Rosia", "uuid": "{47441263-bb15-495f-b324-58a1e3c7b35f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B47441263-bb15-495f-b324-58a1e3c7b35f%7D"}, "html": {"href": "https://bitbucket.org/%7B47441263-bb15-495f-b324-58a1e3c7b35f%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1b61ff7ec618b3e8743b8ab9743e4108d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsNR-6.png"}}, "nickname": "nicolaerosia", "type": "user", "account_id": "557058:2ea02a3a-4b8d-4620-8154-81f2eb2f71af"}, "title": "Simbody, Bullet dependencies not added to gazebo-config.cmake", "component": {"name": "build", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/132954.json"}}}, "votes": 1, "watches": 1, "content": {"raw": "The gazebo-config.cmake doesn't include dependencies on Simbody and Bullet when Gazebo was compiled with Simbody and Bullet support.\r\nThis breaks building of ROS packages which fail to link with Gazebo.\r\n\r\nI have a patch for this but I'm trying to create a pull request.\r\n\r\n```\r\n#!patch\r\n\r\ndiff -r 61136bf84197 CMakeLists.txt\r\n--- a/CMakeLists.txt\tFri Feb 19 14:59:30 2016 -0800\r\n+++ b/CMakeLists.txt\tFri Mar 11 10:26:53 2016 +0200\r\n@@ -394,6 +394,14 @@\r\n \r\n   set(PKG_DEPENDS Boost Protobuf SDFormat OGRE)\r\n \r\n+  if (HAVE_SIMBODY)\r\n+    list(APPEND PKG_DEPENDS \"Simbody\")\r\n+  endif()\r\n+\r\n+  if (HAVE_BULLET)\r\n+    list(APPEND PKG_DEPENDS \"Bullet\")\r\n+  endif()\r\n+\r\n   set(cmake_conf_file \"cmake/gazebo-config.cmake\")\r\n   set(cmake_conf_version_file \"cmake/gazebo-config-version.cmake\")\r\n   configure_file(\"${CMAKE_CURRENT_SOURCE_DIR}/${cmake_conf_file}.in\" \"${CMAKE_CURRENT_BINARY_DIR}/${cmake_conf_file}\" @ONLY)\r\ndiff -r 61136bf84197 cmake/SearchForStuff.cmake\r\n--- a/cmake/SearchForStuff.cmake\tFri Feb 19 14:59:30 2016 -0800\r\n+++ b/cmake/SearchForStuff.cmake\tFri Mar 11 10:26:53 2016 +0200\r\n@@ -138,8 +138,10 @@\r\n   #list(APPEND CMAKE_MODULE_PATH ${SimTK_INSTALL_PREFIX}/share/cmake)\r\n   find_package(Simbody)\r\n   if (Simbody_FOUND)\r\n+    message (STATUS \"Looking for Simbody - found\")\r\n     set (HAVE_SIMBODY TRUE)\r\n   else()\r\n+    message (STATUS \"Looking for Simbody - not found\")\r\n     BUILD_WARNING (\"Simbody not found, for simbody physics engine option, please install libsimbody-dev.\")\r\n     set (HAVE_SIMBODY FALSE)\r\n   endif()\r\ndiff -r 61136bf84197 cmake/gazebo-config.cmake.in\r\n--- a/cmake/gazebo-config.cmake.in\tFri Feb 19 14:59:30 2016 -0800\r\n+++ b/cmake/gazebo-config.cmake.in\tFri Mar 11 10:26:53 2016 +0200\r\n@@ -114,17 +114,22 @@\r\n       find_package(${dep} REQUIRED)\r\n     endif()\r\n   endif()\r\n-  list(APPEND @PKG_NAME@_INCLUDE_DIRS ${${dep}_INCLUDE_DIRS})\r\n \r\n   # Protobuf needs to be capitalized to match PROTOBUF_LIBRARIES\r\n   if (${dep} STREQUAL \"Protobuf\")\r\n-    string (TOUPPER ${dep} dep_lib)\r\n-  else()\r\n-    set (dep_lib ${dep})\r\n+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${PROTOBUF_INCLUDE_DIRS})\r\n+    list(APPEND @PKG_NAME@_LIBRARIES ${PROTOBUF_LIBRARIES})\r\n+  elseif (${dep} STREQUAL \"Bullet\")\r\n+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${BULLET_INCLUDE_DIRS})\r\n+    list(APPEND @PKG_NAME@_LIBRARIES ${BULLET_LIBRARIES})\r\n+  elseif (${dep} STREQUAL \"Simbody\")\r\n+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${Simbody_INCLUDE_DIR})\r\n+    list(APPEND @PKG_NAME@_LIBRARIES ${Simbody_LIBRARIES})\r\n+  else ()\r\n+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${${dep}_INCLUDE_DIRS})\r\n+    list(APPEND @PKG_NAME@_LIBRARIES ${${dep}_LIBRARIES})\r\n   endif()\r\n \r\n-  list(APPEND @PKG_NAME@_LIBRARIES ${${dep_lib}_LIBRARIES})\r\n-\r\n   # When including OGRE, also include the Terrain and Paging components\r\n   if (${dep} STREQUAL \"OGRE\")\r\n     list(APPEND GAZEBO_INCLUDE_DIRS ${OGRE_Terrain_INCLUDE_DIRS}\r\n\r\n```\r\n", "markup": "markdown", "html": "<p>The gazebo-config.cmake doesn't include dependencies on Simbody and Bullet when Gazebo was compiled with Simbody and Bullet support.\nThis breaks building of ROS packages which fail to link with Gazebo.</p>\n<p>I have a patch for this but I'm trying to create a pull request.</p>\n<div class=\"codehilite language-patch\"><pre><span></span><span class=\"gh\">diff -r 61136bf84197 CMakeLists.txt</span>\n<span class=\"gd\">--- a/CMakeLists.txt    Fri Feb 19 14:59:30 2016 -0800</span>\n<span class=\"gi\">+++ b/CMakeLists.txt    Fri Mar 11 10:26:53 2016 +0200</span>\n<span class=\"gu\">@@ -394,6 +394,14 @@</span>\n\n   set(PKG_DEPENDS Boost Protobuf SDFormat OGRE)\n\n<span class=\"gi\">+  if (HAVE_SIMBODY)</span>\n<span class=\"gi\">+    list(APPEND PKG_DEPENDS &quot;Simbody&quot;)</span>\n<span class=\"gi\">+  endif()</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  if (HAVE_BULLET)</span>\n<span class=\"gi\">+    list(APPEND PKG_DEPENDS &quot;Bullet&quot;)</span>\n<span class=\"gi\">+  endif()</span>\n<span class=\"gi\">+</span>\n   set(cmake_conf_file &quot;cmake/gazebo-config.cmake&quot;)\n   set(cmake_conf_version_file &quot;cmake/gazebo-config-version.cmake&quot;)\n   configure_file(&quot;${CMAKE_CURRENT_SOURCE_DIR}/${cmake_conf_file}.in&quot; &quot;${CMAKE_CURRENT_BINARY_DIR}/${cmake_conf_file}&quot; @ONLY)\n<span class=\"gh\">diff -r 61136bf84197 cmake/SearchForStuff.cmake</span>\n<span class=\"gd\">--- a/cmake/SearchForStuff.cmake    Fri Feb 19 14:59:30 2016 -0800</span>\n<span class=\"gi\">+++ b/cmake/SearchForStuff.cmake    Fri Mar 11 10:26:53 2016 +0200</span>\n<span class=\"gu\">@@ -138,8 +138,10 @@</span>\n   #list(APPEND CMAKE_MODULE_PATH ${SimTK_INSTALL_PREFIX}/share/cmake)\n   find_package(Simbody)\n   if (Simbody_FOUND)\n<span class=\"gi\">+    message (STATUS &quot;Looking for Simbody - found&quot;)</span>\n     set (HAVE_SIMBODY TRUE)\n   else()\n<span class=\"gi\">+    message (STATUS &quot;Looking for Simbody - not found&quot;)</span>\n     BUILD_WARNING (&quot;Simbody not found, for simbody physics engine option, please install libsimbody-dev.&quot;)\n     set (HAVE_SIMBODY FALSE)\n   endif()\n<span class=\"gh\">diff -r 61136bf84197 cmake/gazebo-config.cmake.in</span>\n<span class=\"gd\">--- a/cmake/gazebo-config.cmake.in  Fri Feb 19 14:59:30 2016 -0800</span>\n<span class=\"gi\">+++ b/cmake/gazebo-config.cmake.in  Fri Mar 11 10:26:53 2016 +0200</span>\n<span class=\"gu\">@@ -114,17 +114,22 @@</span>\n       find_package(${dep} REQUIRED)\n     endif()\n   endif()\n<span class=\"gd\">-  list(APPEND @PKG_NAME@_INCLUDE_DIRS ${${dep}_INCLUDE_DIRS})</span>\n\n   # Protobuf needs to be capitalized to match PROTOBUF_LIBRARIES\n   if (${dep} STREQUAL &quot;Protobuf&quot;)\n<span class=\"gd\">-    string (TOUPPER ${dep} dep_lib)</span>\n<span class=\"gd\">-  else()</span>\n<span class=\"gd\">-    set (dep_lib ${dep})</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${PROTOBUF_INCLUDE_DIRS})</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_LIBRARIES ${PROTOBUF_LIBRARIES})</span>\n<span class=\"gi\">+  elseif (${dep} STREQUAL &quot;Bullet&quot;)</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${BULLET_INCLUDE_DIRS})</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_LIBRARIES ${BULLET_LIBRARIES})</span>\n<span class=\"gi\">+  elseif (${dep} STREQUAL &quot;Simbody&quot;)</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${Simbody_INCLUDE_DIR})</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_LIBRARIES ${Simbody_LIBRARIES})</span>\n<span class=\"gi\">+  else ()</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_INCLUDE_DIRS ${${dep}_INCLUDE_DIRS})</span>\n<span class=\"gi\">+    list(APPEND @PKG_NAME@_LIBRARIES ${${dep}_LIBRARIES})</span>\n   endif()\n\n<span class=\"gd\">-  list(APPEND @PKG_NAME@_LIBRARIES ${${dep_lib}_LIBRARIES})</span>\n<span class=\"gd\">-</span>\n   # When including OGRE, also include the Terrain and Paging components\n   if (${dep} STREQUAL &quot;OGRE&quot;)\n     list(APPEND GAZEBO_INCLUDE_DIRS ${OGRE_Terrain_INCLUDE_DIRS}\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2016-03-11T08:29:05.831086+00:00", "milestone": null, "updated_on": "2016-09-14T19:45:28.706491+00:00", "type": "issue", "id": 1874}