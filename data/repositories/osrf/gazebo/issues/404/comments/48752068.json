{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/404/comments/48752068.json"}, "html": {"href": "#!/osrf/gazebo/issues/404#comment-48752068"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/404.json"}}, "type": "issue", "id": 404, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "collada texture transparency bug"}, "content": {"raw": "Can't share that particular asset, but found out a few things in the meantime.\nI switched to importing the obj into Blender and exporting COLLADA from there.\n\nBlender exports materials with partly transparent textures like this per default:\n\n```\n       <transparent opaque=\"A_ONE\">\n              <texture texture=\"CLGGTM11_png-sampler\"/>\n       </transparent>        \n```\n\nAfter looking at the [ColladaLoader.cc](#!/osrf/gazebo/src/f4e51e8f64001beda70615ab8982a7d5a4e65b18/gazebo/common/ColladaLoader.cc#lines-1249) code I noticed that apparently, not only the `transparent` tag is required, but also the `transparency` tag should be there. After a bit of playing around, replacing the above entry with this ended up working for me:\n\n```\n            <transparent opaque=\"A_ONE\">\n              <color>1.0 1.0 1.0 0.99</color>\n              <texture texture=\"CLGGTM11_png-sampler\"/>\n            </transparent>\n            <transparency>\n              <float sid=\"transparency\">1</float>\n            </transparency>\n```\nA few notes about that:\n\n* It seems like it would be better to not initialize material transparency in ColladaLoader with 0 when a `transparent` tag is set, instead setting it to 1, as the intent most likely is to have transparency, if a `transparent` tag is set. This at least is the way Blender exports things.\n\n* For some weird reason, setting the alpha in the `color` tag to 1.0 makes the railing solid, but setting it to 0.99 makes transparency work correctly (apart from the railing being very slightly translucent). That behavior looks like a bug to me.", "markup": "markdown", "html": "<p>Can't share that particular asset, but found out a few things in the meantime.\nI switched to importing the obj into Blender and exporting COLLADA from there.</p>\n<p>Blender exports materials with partly transparent textures like this per default:</p>\n<div class=\"codehilite\"><pre><span></span>       <span class=\"nt\">&lt;transparent</span> <span class=\"na\">opaque=</span><span class=\"s\">&quot;A_ONE&quot;</span><span class=\"nt\">&gt;</span>\n              <span class=\"nt\">&lt;texture</span> <span class=\"na\">texture=</span><span class=\"s\">&quot;CLGGTM11_png-sampler&quot;</span><span class=\"nt\">/&gt;</span>\n       <span class=\"nt\">&lt;/transparent&gt;</span>        \n</pre></div>\n\n\n<p>After looking at the <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/f4e51e8f64001beda70615ab8982a7d5a4e65b18/gazebo/common/ColladaLoader.cc#lines-1249\" rel=\"nofollow\">ColladaLoader.cc</a> code I noticed that apparently, not only the <code>transparent</code> tag is required, but also the <code>transparency</code> tag should be there. After a bit of playing around, replacing the above entry with this ended up working for me:</p>\n<div class=\"codehilite\"><pre><span></span>            <span class=\"nt\">&lt;transparent</span> <span class=\"na\">opaque=</span><span class=\"s\">&quot;A_ONE&quot;</span><span class=\"nt\">&gt;</span>\n              <span class=\"nt\">&lt;color&gt;</span>1.0 1.0 1.0 0.99<span class=\"nt\">&lt;/color&gt;</span>\n              <span class=\"nt\">&lt;texture</span> <span class=\"na\">texture=</span><span class=\"s\">&quot;CLGGTM11_png-sampler&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/transparent&gt;</span>\n            <span class=\"nt\">&lt;transparency&gt;</span>\n              <span class=\"nt\">&lt;float</span> <span class=\"na\">sid=</span><span class=\"s\">&quot;transparency&quot;</span><span class=\"nt\">&gt;</span>1<span class=\"nt\">&lt;/float&gt;</span>\n            <span class=\"nt\">&lt;/transparency&gt;</span>\n</pre></div>\n\n\n<p>A few notes about that:</p>\n<ul>\n<li>\n<p>It seems like it would be better to not initialize material transparency in ColladaLoader with 0 when a <code>transparent</code> tag is set, instead setting it to 1, as the intent most likely is to have transparency, if a <code>transparent</code> tag is set. This at least is the way Blender exports things.</p>\n</li>\n<li>\n<p>For some weird reason, setting the alpha in the <code>color</code> tag to 1.0 makes the railing solid, but setting it to 0.99 makes transparency work correctly (apart from the railing being very slightly translucent). That behavior looks like a bug to me.</p>\n</li>\n</ul>", "type": "rendered"}, "created_on": "2018-11-05T22:27:26.056041+00:00", "user": {"display_name": "Stefan Kohlbrecher", "uuid": "{db06b03e-7b31-4483-9018-534df5bd723f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bdb06b03e-7b31-4483-9018-534df5bd723f%7D"}, "html": {"href": "https://bitbucket.org/%7Bdb06b03e-7b31-4483-9018-534df5bd723f%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/414f1c364e6406dde31a6ef70fbd3d21d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSK-6.png"}}, "nickname": "Stefan_Kohlbrecher", "type": "user", "account_id": "557058:e39b6a62-9eb0-45ca-b27e-4f6445009d3f"}, "updated_on": "2018-11-05T23:24:13.448359+00:00", "type": "issue_comment", "id": 48752068}