{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1934/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1934.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1934/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1934/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1934/flaky-segfault-in-unit_datalogger_test"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1934/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "Flaky segfault in UNIT_DataLogger_TEST", "component": {"name": "testing", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/128164.json"}}}, "votes": 0, "watches": 1, "content": {"raw": "I've seen an identical backtrace in `UNIT_DataLogger_TEST` two nights in a row, though with slightly different console output ([full details here](https://gist.github.com/scpeters/6e1a34aae023549b4f70985072f55adb)). It was found on the default branch (1d1e3a542af8).\r\n\r\nThe test fails during the `StressTest`, while randomly toggling the record button ([DataLogger_TEST.cc:188](#!/osrf/gazebo/src/1d1e3a542af8167/gazebo/gui/DataLogger_TEST.cc#DataLogger_TEST.cc-188)). The segfault comes from the `LogWorker` thread at [World.cc:2585-2586](#!/osrf/gazebo/src/1d1e3a542af81670f/gazebo/physics/World.cc#World.cc-2585), which is calling [WorldState::operator-](#!/osrf/gazebo/src/1d1e3a542af81/gazebo/physics/WorldState.cc#WorldState.cc-392):\r\n\r\n~~~\r\n#4  0x00002afb2791f804 in qFatal(char const*, ...) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\r\n#5  <signal handler called>\r\n#6  0x00002afb2a0cfb63 in std::_Rb_tree_increment(std::_Rb_tree_node_base const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#7  0x00002afb27feff4c in operator++ (this=<synthetic pointer>) at /usr/include/c++/4.8/bits/stl_tree.h:270\r\n#8  gazebo::physics::WorldState::operator- (this=0x2afb54bb6678, _state=...) at gazebo/physics/WorldState.cc:392\r\n#9  0x00002afb27fde165 in gazebo::physics::World::LogWorker (this=0x2afb54710c40) at gazebo/physics/World.cc:2586\r\n~~~\r\n", "markup": "markdown", "html": "<p>I've seen an identical backtrace in <code>UNIT_DataLogger_TEST</code> two nights in a row, though with slightly different console output (<a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/6e1a34aae023549b4f70985072f55adb\" rel=\"nofollow\">full details here</a>). It was found on the default branch (<a href=\"#!/osrf/gazebo/commits/1d1e3a542af8\" rel=\"nofollow\" class=\"ap-connect-link\">1d1e3a542af8</a>).</p>\n<p>The test fails during the <code>StressTest</code>, while randomly toggling the record button (<a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/1d1e3a542af8167/gazebo/gui/DataLogger_TEST.cc#DataLogger_TEST.cc-188\" rel=\"nofollow\">DataLogger_TEST.cc:188</a>). The segfault comes from the <code>LogWorker</code> thread at <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/1d1e3a542af81670f/gazebo/physics/World.cc#World.cc-2585\" rel=\"nofollow\">World.cc:2585-2586</a>, which is calling <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/1d1e3a542af81/gazebo/physics/WorldState.cc#WorldState.cc-392\" rel=\"nofollow\">WorldState::operator-</a>:</p>\n<div class=\"codehilite\"><pre><span></span>#4  0x00002afb2791f804 in qFatal(char const*, ...) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\n#5  &lt;signal handler called&gt;\n#6  0x00002afb2a0cfb63 in std::_Rb_tree_increment(std::_Rb_tree_node_base const*) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#7  0x00002afb27feff4c in operator++ (this=&lt;synthetic pointer&gt;) at /usr/include/c++/4.8/bits/stl_tree.h:270\n#8  gazebo::physics::WorldState::operator- (this=0x2afb54bb6678, _state=...) at gazebo/physics/WorldState.cc:392\n#9  0x00002afb27fde165 in gazebo::physics::World::LogWorker (this=0x2afb54710c40) at gazebo/physics/World.cc:2586\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2016-04-19T22:30:45.719296+00:00", "milestone": null, "updated_on": "2016-09-14T19:19:58.122303+00:00", "type": "issue", "id": 1934}