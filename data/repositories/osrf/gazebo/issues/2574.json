{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2574/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2574.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2574/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2574/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2574/gpurayplugin-segfaults-on-shutdown"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2574/vote"}}, "reporter": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "title": "GpuRayPlugin segfaults on shutdown", "component": {"name": "plugins", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/332959.json"}}}, "votes": 2, "watches": 4, "content": {"raw": "Issue identified in pull request #3026\r\n\r\nTo reproduce, create a model with the SDF below. Insert into gazebo and delete it to trigger the segfault:\r\n\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.5\">\r\n  <model name=\"hokuyo_gpu\">\r\n    <pose>0 0 0.035 0 0 0</pose>\r\n    <link name=\"link\">\r\n      <inertial>\r\n        <mass>0.1</mass>\r\n      </inertial>\r\n      <visual name=\"visual\">\r\n        <geometry>\r\n          <mesh>\r\n            <uri>model://hokuyo/meshes/hokuyo.dae</uri>\r\n          </mesh>\r\n        </geometry>\r\n      </visual>\r\n      <collision name=\"collision-base\">\r\n        <pose>0 0 -0.0145 0 0 0</pose>\r\n        <geometry>\r\n          <box>\r\n            <size>0.05 0.05 0.041</size>\r\n          </box>\r\n        </geometry>\r\n      </collision>\r\n      <collision name=\"collision-top\">\r\n        <pose>0 0 0.0205 0 0 0</pose>\r\n        <geometry>\r\n          <cylinder>\r\n            <radius>0.021</radius>\r\n            <length>0.029</length>\r\n          </cylinder>\r\n        </geometry>\r\n      </collision>\r\n      <sensor name=\"laser\" type=\"gpu_ray\">\r\n        <pose>0.01 0 0.0175 0 -0 0</pose>\r\n        <ray>\r\n          <scan>\r\n            <horizontal>\r\n              <samples>10</samples>\r\n              <resolution>1</resolution>\r\n              <min_angle>-0.1</min_angle>\r\n              <max_angle>0.1</max_angle>\r\n            </horizontal>\r\n          </scan>\r\n          <range>\r\n            <min>0.1</min>\r\n            <max>10</max>\r\n            <resolution>0.01</resolution>\r\n          </range>\r\n        </ray>\r\n        <always_on>1</always_on>\r\n        <update_rate>30</update_rate>\r\n        <visualize>true</visualize>\r\n\r\n        <plugin name=\"gpu\" filename=\"libGpuRayPlugin.so\"/>\r\n      </sensor>\r\n    </link>\r\n  </model>\r\n</sdf>\r\n```", "markup": "markdown", "html": "<p>Issue identified in <a href=\"#!/osrf/gazebo/pull-requests/3026/improve-gpu-laser-and-its-sensor-shutdown\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #3026</a></p>\n<p>To reproduce, create a model with the SDF below. Insert into gazebo and delete it to trigger the segfault:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.5&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;hokuyo_gpu&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;pose&gt;</span>0 0 0.035 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n    <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;inertial&gt;</span>\n        <span class=\"nt\">&lt;mass&gt;</span>0.1<span class=\"nt\">&lt;/mass&gt;</span>\n      <span class=\"nt\">&lt;/inertial&gt;</span>\n      <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;mesh&gt;</span>\n            <span class=\"nt\">&lt;uri&gt;</span>model://hokuyo/meshes/hokuyo.dae<span class=\"nt\">&lt;/uri&gt;</span>\n          <span class=\"nt\">&lt;/mesh&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;/visual&gt;</span>\n      <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision-base&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0 0 -0.0145 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;box&gt;</span>\n            <span class=\"nt\">&lt;size&gt;</span>0.05 0.05 0.041<span class=\"nt\">&lt;/size&gt;</span>\n          <span class=\"nt\">&lt;/box&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;/collision&gt;</span>\n      <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision-top&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0 0 0.0205 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;geometry&gt;</span>\n          <span class=\"nt\">&lt;cylinder&gt;</span>\n            <span class=\"nt\">&lt;radius&gt;</span>0.021<span class=\"nt\">&lt;/radius&gt;</span>\n            <span class=\"nt\">&lt;length&gt;</span>0.029<span class=\"nt\">&lt;/length&gt;</span>\n          <span class=\"nt\">&lt;/cylinder&gt;</span>\n        <span class=\"nt\">&lt;/geometry&gt;</span>\n      <span class=\"nt\">&lt;/collision&gt;</span>\n      <span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;laser&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;gpu_ray&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0.01 0 0.0175 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;ray&gt;</span>\n          <span class=\"nt\">&lt;scan&gt;</span>\n            <span class=\"nt\">&lt;horizontal&gt;</span>\n              <span class=\"nt\">&lt;samples&gt;</span>10<span class=\"nt\">&lt;/samples&gt;</span>\n              <span class=\"nt\">&lt;resolution&gt;</span>1<span class=\"nt\">&lt;/resolution&gt;</span>\n              <span class=\"nt\">&lt;min_angle&gt;</span>-0.1<span class=\"nt\">&lt;/min_angle&gt;</span>\n              <span class=\"nt\">&lt;max_angle&gt;</span>0.1<span class=\"nt\">&lt;/max_angle&gt;</span>\n            <span class=\"nt\">&lt;/horizontal&gt;</span>\n          <span class=\"nt\">&lt;/scan&gt;</span>\n          <span class=\"nt\">&lt;range&gt;</span>\n            <span class=\"nt\">&lt;min&gt;</span>0.1<span class=\"nt\">&lt;/min&gt;</span>\n            <span class=\"nt\">&lt;max&gt;</span>10<span class=\"nt\">&lt;/max&gt;</span>\n            <span class=\"nt\">&lt;resolution&gt;</span>0.01<span class=\"nt\">&lt;/resolution&gt;</span>\n          <span class=\"nt\">&lt;/range&gt;</span>\n        <span class=\"nt\">&lt;/ray&gt;</span>\n        <span class=\"nt\">&lt;always_on&gt;</span>1<span class=\"nt\">&lt;/always_on&gt;</span>\n        <span class=\"nt\">&lt;update_rate&gt;</span>30<span class=\"nt\">&lt;/update_rate&gt;</span>\n        <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n\n        <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;gpu&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libGpuRayPlugin.so&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/sensor&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n  <span class=\"nt\">&lt;/model&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "9.0", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/242746.json"}}}, "edited_on": null, "created_on": "2018-12-11T01:09:45.015922+00:00", "milestone": null, "updated_on": "2018-12-11T01:09:45.015922+00:00", "type": "issue", "id": 2574}