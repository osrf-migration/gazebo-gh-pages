{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1006/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1006.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1006/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1006/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1006/scene-getvisualcount-return-wrong-value"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1006/vote"}}, "reporter": {"display_name": "Eric Chuang", "uuid": "{d2e54829-e131-425c-bec9-376b28df3714}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd2e54829-e131-425c-bec9-376b28df3714%7D"}, "html": {"href": "https://bitbucket.org/%7Bd2e54829-e131-425c-bec9-376b28df3714%7D/"}, "avatar": {"href": "https://bitbucket.org/account/eric4337/avatar/"}}, "nickname": "eric4337", "type": "user", "account_id": null}, "title": "Scene::GetVisualCount()  return wrong value", "component": null, "votes": 0, "watches": 2, "content": {"raw": "It seems that the number of Visuals returned from Scene::GetVisualCount() is less then the actual Visuals.\r\n\r\nyou can recreate this problem using the following code.\r\n\r\n```\r\n#!c++\r\n\tunsigned int num_visual = m_scene->GetVisualCount();\r\n\tcout << \"num of visual instance:\" << num_visual << endl;\r\n\tunsigned int temp_count = 0;\r\n\t// go through every visual in rendering::Scene\r\n\tfor( unsigned int i = 1; i < num_visual + 99; i++ )\t// skip the first one\r\n\t{\r\n\t\trendering::VisualPtr cur_visual = m_scene->GetVisual( i );\r\n\r\n\t\tif( cur_visual )\r\n\t\t{\r\n\t\t\tcout << \"== \" << i << \" ==\" << endl;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttemp_count++;\r\n\t\t}\r\n\t}\r\n\r\n```\r\nNOTE in the for loop condition, i add 99 to num_visual.\r\n\r\nThe output will exceed  number of Visuals returned by Scene::GetVisualCount().\r\n\r\n\r\n------------------\r\nOUTPUT:\r\n\r\n...   \r\n== 1231 ==  \r\n== 1232 ==   \r\n== 1233 ==  \r\n\r\nnum of visuals : 1229\r\n\r\n\r\n", "markup": "markdown", "html": "<p>It seems that the number of Visuals returned from Scene::GetVisualCount() is less then the actual Visuals.</p>\n<p>you can recreate this problem using the following code.</p>\n<div class=\"codehilite language-c++\"><pre><span></span>    <span class=\"kt\">unsigned</span> <span class=\"kt\">int</span> <span class=\"n\">num_visual</span> <span class=\"o\">=</span> <span class=\"n\">m_scene</span><span class=\"o\">-&gt;</span><span class=\"n\">GetVisualCount</span><span class=\"p\">();</span>\n    <span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;num of visual instance:&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">num_visual</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">endl</span><span class=\"p\">;</span>\n    <span class=\"kt\">unsigned</span> <span class=\"kt\">int</span> <span class=\"n\">temp_count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n    <span class=\"c1\">// go through every visual in rendering::Scene</span>\n    <span class=\"k\">for</span><span class=\"p\">(</span> <span class=\"kt\">unsigned</span> <span class=\"kt\">int</span> <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">;</span> <span class=\"n\">i</span> <span class=\"o\">&lt;</span> <span class=\"n\">num_visual</span> <span class=\"o\">+</span> <span class=\"mi\">99</span><span class=\"p\">;</span> <span class=\"n\">i</span><span class=\"o\">++</span> <span class=\"p\">)</span> <span class=\"c1\">// skip the first one</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">rendering</span><span class=\"o\">::</span><span class=\"n\">VisualPtr</span> <span class=\"n\">cur_visual</span> <span class=\"o\">=</span> <span class=\"n\">m_scene</span><span class=\"o\">-&gt;</span><span class=\"n\">GetVisual</span><span class=\"p\">(</span> <span class=\"n\">i</span> <span class=\"p\">);</span>\n\n        <span class=\"k\">if</span><span class=\"p\">(</span> <span class=\"n\">cur_visual</span> <span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;== &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">i</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot; ==&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">endl</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">else</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">temp_count</span><span class=\"o\">++</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>NOTE in the for loop condition, i add 99 to num_visual.</p>\n<p>The output will exceed  number of Visuals returned by Scene::GetVisualCount().</p>\n<hr />\n<p>OUTPUT:</p>\n<p>... <br />\n== 1231 ==<br />\n== 1232 == <br />\n== 1233 ==  </p>\n<p>num of visuals : 1229</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2014-01-16T08:23:45.960957+00:00", "milestone": null, "updated_on": "2016-09-14T19:24:29.661792+00:00", "type": "issue", "id": 1006}