{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2240/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2240.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2240/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2240/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2240/logical-camera-pose-rotates-user-camera"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2240/vote"}}, "reporter": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "title": "Logical camera pose rotates user camera and heightmap", "component": {"name": "sensors", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/122877.json"}}}, "votes": 2, "watches": 5, "content": {"raw": "Try this minimal example world:\r\n\r\n~~~\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.5\">\r\n  <world name=\"default\">\r\n    <include>\r\n      <uri>model://vrc_driving_terrain</uri>\r\n    </include>\r\n\r\n    <include>\r\n      <uri>model://sun</uri>\r\n    </include>\r\n\r\n    <include>\r\n      <pose>0 10 0 0 0 0</pose>\r\n      <uri>model://house_1</uri>\r\n    </include>\r\n\r\n    <model name=\"box\">\r\n      <pose>0 0 0.5 0 0 0</pose>\r\n      <link name=\"link\">\r\n        <collision name=\"collision\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </collision>\r\n        <visual name=\"visual\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </visual>\r\n\r\n        <sensor name=\"logical_camera\" type=\"logical_camera\">\r\n\r\n          <!-- try with and without this pose element -->\r\n          <pose>0 0 0 0 0 1.57</pose>\r\n\r\n          <logical_camera>\r\n            <near>0.55</near>\r\n            <far>5</far>\r\n            <horizontal_fov>1.04719755</horizontal_fov>\r\n            <aspect_ratio>1.778</aspect_ratio>\r\n          </logical_camera>\r\n\r\n          <visualize>true</visualize>\r\n          <always_on>true</always_on>\r\n          <update_rate>10</update_rate>\r\n        </sensor>\r\n      </link>\r\n    </model>\r\n\r\n  </world>\r\n</sdf>\r\n~~~\r\n\r\nWithout the sensor pose element, the world looks like this:\r\n\r\n![posezero.png](data/bitbucket.org/repo/jgXqbo/images/1763289237-posezero.png)\r\n\r\n* Camera looking towards world's +X axis\r\n* House on world's +Y axis\r\n* Heightmap's \"open end\" towards world's +X\r\n* User camera starting view has +X axis towards bottom right corner\r\n\r\nWith the sensor pose element (just adding that, the rest of the world is all the same!), it looks like this:\r\n\r\n![pose_rotated.png](data/bitbucket.org/repo/jgXqbo/images/4173376790-pose_rotated.png)\r\n\r\n* Camera is now looking towards world's +Y axis - good, that's what we wanted\r\n* House on world's +Y axis - ok, that hasn't changed\r\n* Heightmap's \"open end\" towards world's -Y - how did that happen?!\r\n* User camera starting view has +X axis towards top right corner - so it was rotated on the opposite direction of the logical camera", "markup": "markdown", "html": "<p>Try this minimal example world:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>\n<span class=\"nt\">&lt;sdf</span> <span class=\"na\">version=</span><span class=\"s\">&quot;1.5&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;world</span> <span class=\"na\">name=</span><span class=\"s\">&quot;default&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://vrc_driving_terrain<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://sun<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 10 0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;uri&gt;</span>model://house_1<span class=\"nt\">&lt;/uri&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n\n    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;link&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/collision&gt;</span>\n        <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/visual&gt;</span>\n\n        <span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;logical_camera&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;logical_camera&quot;</span><span class=\"nt\">&gt;</span>\n\n          <span class=\"c\">&lt;!-- try with and without this pose element --&gt;</span>\n          <span class=\"nt\">&lt;pose&gt;</span>0 0 0 0 0 1.57<span class=\"nt\">&lt;/pose&gt;</span>\n\n          <span class=\"nt\">&lt;logical_camera&gt;</span>\n            <span class=\"nt\">&lt;near&gt;</span>0.55<span class=\"nt\">&lt;/near&gt;</span>\n            <span class=\"nt\">&lt;far&gt;</span>5<span class=\"nt\">&lt;/far&gt;</span>\n            <span class=\"nt\">&lt;horizontal_fov&gt;</span>1.04719755<span class=\"nt\">&lt;/horizontal_fov&gt;</span>\n            <span class=\"nt\">&lt;aspect_ratio&gt;</span>1.778<span class=\"nt\">&lt;/aspect_ratio&gt;</span>\n          <span class=\"nt\">&lt;/logical_camera&gt;</span>\n\n          <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n          <span class=\"nt\">&lt;always_on&gt;</span>true<span class=\"nt\">&lt;/always_on&gt;</span>\n          <span class=\"nt\">&lt;update_rate&gt;</span>10<span class=\"nt\">&lt;/update_rate&gt;</span>\n        <span class=\"nt\">&lt;/sensor&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n\n  <span class=\"nt\">&lt;/world&gt;</span>\n<span class=\"nt\">&lt;/sdf&gt;</span>\n</pre></div>\n\n\n<p>Without the sensor pose element, the world looks like this:</p>\n<p><img alt=\"posezero.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/1763289237-posezero.png\" /></p>\n<ul>\n<li>Camera looking towards world's +X axis</li>\n<li>House on world's +Y axis</li>\n<li>Heightmap's \"open end\" towards world's +X</li>\n<li>User camera starting view has +X axis towards bottom right corner</li>\n</ul>\n<p>With the sensor pose element (just adding that, the rest of the world is all the same!), it looks like this:</p>\n<p><img alt=\"pose_rotated.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/4173376790-pose_rotated.png\" /></p>\n<ul>\n<li>Camera is now looking towards world's +Y axis - good, that's what we wanted</li>\n<li>House on world's +Y axis - ok, that hasn't changed</li>\n<li>Heightmap's \"open end\" towards world's -Y - how did that happen?!</li>\n<li>User camera starting view has +X axis towards top right corner - so it was rotated on the opposite direction of the logical camera</li>\n</ul>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "7.0", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/242744.json"}}}, "edited_on": null, "created_on": "2017-03-24T23:58:51.039245+00:00", "milestone": null, "updated_on": "2017-11-22T17:02:20.563926+00:00", "type": "issue", "id": 2240}