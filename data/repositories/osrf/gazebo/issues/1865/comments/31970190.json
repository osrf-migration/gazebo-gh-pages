{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1865/comments/31970190.json"}, "html": {"href": "#!/osrf/gazebo/issues/1865#comment-31970190"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1865.json"}}, "type": "issue", "id": 1865, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "rendering::DepthCamera does not output colors properly for an RGB PointCloud."}, "content": {"raw": "Thanks for the pointer.  Changing the image format from R8G8B8 to B8G8R8 fixed the issue.  The working xml is below for reference:\n\n```\n#!xml\n<sensor type=\"depth\" name=\"${name}_frame_sensor\">\n        <always_on>true</always_on>\n        <update_rate>20.0</update_rate>\n        <camera>\n          <horizontal_fov>${57.0*M_PI/180.0}</horizontal_fov>\n          <image>\n            <format>B8G8R8</format>\n            <width>640</width>\n            <height>480</height>\n          </image>\n          <clip>\n            <near>0.01</near>\n            <far>5</far>\n          </clip>\n        </camera>\n        <plugin name=\"${name}_frame_controller\" filename=\"libgazebo_ros_openni_kinect.so\">\n          <alwaysOn>true</alwaysOn>\n          <updateRate>20.0</updateRate>\n          <cameraName>${name}</cameraName>\n          <imageTopicName>rgb/image_raw</imageTopicName>\n          <pointCloudTopicName>rgb/points</pointCloudTopicName>\n          <cameraInfoTopicName>rgb/camera_info</cameraInfoTopicName>\n          <frameName>${name}_optical_frame</frameName>\n          <pointCloudCutoff>0.5</pointCloudCutoff>\n          <distortionK1>0.00000001</distortionK1>\n          <distortionK2>0.00000001</distortionK2>\n          <distortionK3>0.00000001</distortionK3>\n          <distortionT1>0.00000001</distortionT1>\n          <distortionT2>0.00000001</distortionT2>\n        </plugin>\n      </sensor>\n\n```\n", "markup": "markdown", "html": "<p>Thanks for the pointer.  Changing the image format from R8G8B8 to B8G8R8 fixed the issue.  The working xml is below for reference:</p>\n<div class=\"codehilite language-xml\"><pre><span></span><span class=\"nt\">&lt;sensor</span> <span class=\"na\">type=</span><span class=\"s\">&quot;depth&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;${name}_frame_sensor&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;always_on&gt;</span>true<span class=\"nt\">&lt;/always_on&gt;</span>\n        <span class=\"nt\">&lt;update_rate&gt;</span>20.0<span class=\"nt\">&lt;/update_rate&gt;</span>\n        <span class=\"nt\">&lt;camera&gt;</span>\n          <span class=\"nt\">&lt;horizontal_fov&gt;</span>${57.0*M_PI/180.0}<span class=\"nt\">&lt;/horizontal_fov&gt;</span>\n          <span class=\"nt\">&lt;image&gt;</span>\n            <span class=\"nt\">&lt;format&gt;</span>B8G8R8<span class=\"nt\">&lt;/format&gt;</span>\n            <span class=\"nt\">&lt;width&gt;</span>640<span class=\"nt\">&lt;/width&gt;</span>\n            <span class=\"nt\">&lt;height&gt;</span>480<span class=\"nt\">&lt;/height&gt;</span>\n          <span class=\"nt\">&lt;/image&gt;</span>\n          <span class=\"nt\">&lt;clip&gt;</span>\n            <span class=\"nt\">&lt;near&gt;</span>0.01<span class=\"nt\">&lt;/near&gt;</span>\n            <span class=\"nt\">&lt;far&gt;</span>5<span class=\"nt\">&lt;/far&gt;</span>\n          <span class=\"nt\">&lt;/clip&gt;</span>\n        <span class=\"nt\">&lt;/camera&gt;</span>\n        <span class=\"nt\">&lt;plugin</span> <span class=\"na\">name=</span><span class=\"s\">&quot;${name}_frame_controller&quot;</span> <span class=\"na\">filename=</span><span class=\"s\">&quot;libgazebo_ros_openni_kinect.so&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;alwaysOn&gt;</span>true<span class=\"nt\">&lt;/alwaysOn&gt;</span>\n          <span class=\"nt\">&lt;updateRate&gt;</span>20.0<span class=\"nt\">&lt;/updateRate&gt;</span>\n          <span class=\"nt\">&lt;cameraName&gt;</span>${name}<span class=\"nt\">&lt;/cameraName&gt;</span>\n          <span class=\"nt\">&lt;imageTopicName&gt;</span>rgb/image_raw<span class=\"nt\">&lt;/imageTopicName&gt;</span>\n          <span class=\"nt\">&lt;pointCloudTopicName&gt;</span>rgb/points<span class=\"nt\">&lt;/pointCloudTopicName&gt;</span>\n          <span class=\"nt\">&lt;cameraInfoTopicName&gt;</span>rgb/camera_info<span class=\"nt\">&lt;/cameraInfoTopicName&gt;</span>\n          <span class=\"nt\">&lt;frameName&gt;</span>${name}_optical_frame<span class=\"nt\">&lt;/frameName&gt;</span>\n          <span class=\"nt\">&lt;pointCloudCutoff&gt;</span>0.5<span class=\"nt\">&lt;/pointCloudCutoff&gt;</span>\n          <span class=\"nt\">&lt;distortionK1&gt;</span>0.00000001<span class=\"nt\">&lt;/distortionK1&gt;</span>\n          <span class=\"nt\">&lt;distortionK2&gt;</span>0.00000001<span class=\"nt\">&lt;/distortionK2&gt;</span>\n          <span class=\"nt\">&lt;distortionK3&gt;</span>0.00000001<span class=\"nt\">&lt;/distortionK3&gt;</span>\n          <span class=\"nt\">&lt;distortionT1&gt;</span>0.00000001<span class=\"nt\">&lt;/distortionT1&gt;</span>\n          <span class=\"nt\">&lt;distortionT2&gt;</span>0.00000001<span class=\"nt\">&lt;/distortionT2&gt;</span>\n        <span class=\"nt\">&lt;/plugin&gt;</span>\n      <span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>", "type": "rendered"}, "created_on": "2016-11-07T19:35:36.375039+00:00", "user": {"display_name": "Shaun Edwards", "uuid": "{02006631-9f53-4d24-9a11-0c4ebfe20210}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02006631-9f53-4d24-9a11-0c4ebfe20210%7D"}, "html": {"href": "https://bitbucket.org/%7B02006631-9f53-4d24-9a11-0c4ebfe20210%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/92bea0e66917e3e84ae65b59f612a5add=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSE-2.png"}}, "nickname": "shaun-edwards", "type": "user", "account_id": "557058:de64fc64-15ec-4d1e-b80b-d90cfc23418b"}, "updated_on": null, "type": "issue_comment", "id": 31970190}