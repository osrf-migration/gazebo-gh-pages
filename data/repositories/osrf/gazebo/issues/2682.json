{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2682/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2682.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2682/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2682/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2682/segmentation-fault-on-spawning-model-with"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2682/vote"}}, "reporter": {"display_name": "Naoki-Hiraoka", "uuid": "{4fd5e4bf-7908-4c77-83ec-41bda47a480c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4fd5e4bf-7908-4c77-83ec-41bda47a480c%7D"}, "html": {"href": "https://bitbucket.org/%7B4fd5e4bf-7908-4c77-83ec-41bda47a480c%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/6518b615696867cdb2e0dbfc7f22c877d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsN-4.png"}}, "nickname": "Naoki-Hiraoka", "type": "user", "account_id": "5e167fc3c578120daca573e1"}, "title": "Segmentation fault on spawning model with collada mesh generated by assimp on ubuntu 18.04", "component": {"name": "common", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/138866.json"}}}, "votes": 0, "watches": 1, "content": {"raw": "related to [https://github.com/ros/collada\\_urdf/issues/34](https://github.com/ros/collada_urdf/issues/34)\r\n\r\nWhen I spawned an urdf model with collada meshes into gazebo9 \\(ubuntu18.04\\), I got Segmentation fault \\(core dumped\\).\r\n\r\nI generated the collada meshes with assimp v4.1.0.  \r\nI did not get this Segmentation fault on ubuntu 16.04 \\(gazebo7, assimp v3.2\\).\r\n\r\n```\r\nThread 39 \"gzserver\" received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7fff1ffff700 (LWP 23344)]\r\n0x00007ffff6a0aa76 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::find_first_not_of(char, unsigned long) const ()\r\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n(gdb) Segmentation fault (core dumped)\r\n[gazebo_gui-3] process has died [pid 23197, exit code 139, cmd /opt/ros/melodic/lib/gazebo_ros/gzclient __name:=gazebo_gui __log:=/home/hiraoka/.ros/log/d975cdd0-31f4-11ea-99d9-5c514f34f247/gazebo_gui-3.log].\r\nlog file: /home/hiraoka/.ros/log/d975cdd0-31f4-11ea-99d9-5c514f34f247/gazebo_gui-3*.log\r\n\r\n(gdb) bt\r\n#0  0x00007ffff6a0aa76 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::find_first_not_of(char, unsigned long) const ()\r\n    at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#1  0x00007ffff6ec6acf in  ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#2  0x00007ffff6ed9a63 in gazebo::common::ColladaLoader::LoadPolylist(TiXmlElement*, ignition::math::v4::Matrix4<double> const&, gazebo::common::Mesh*) ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#3  0x00007ffff6edc859 in gazebo::common::ColladaLoader::LoadGeometry(TiXmlElement*, ignition::math::v4::Matrix4<double> const&, gazebo::common::Mesh*) ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#4  0x00007ffff6ede830 in gazebo::common::ColladaLoader::LoadNode(TiXmlElement*, gazebo::common::Mesh*, ignition::math::v4::Matrix4<double> const&) ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#5  0x00007ffff6edef89 in gazebo::common::ColladaLoader::LoadScene(gazebo::common::Mesh*) () at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#6  0x00007ffff6edf4b0 in gazebo::common::ColladaLoader::Load(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#7  0x00007ffff6efe89a in gazebo::common::MeshManager::Load(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\r\n#8  0x00007ffff5abee8b in gazebo::physics::MeshShape::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#9  0x00007ffff59d54c4 in gazebo::physics::ODEMeshShape::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#10 0x00007ffff5a65762 in gazebo::physics::Collision::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#11 0x00007ffff5aac27e in gazebo::physics::Link::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#12 0x00007ffff59d30ae in gazebo::physics::ODELink::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#13 0x00007ffff5ac9a9e in gazebo::physics::Model::Init() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#14 0x00007ffff5b13727 in gazebo::physics::World::ProcessFactoryMsgs() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#15 0x00007ffff5b1945d in gazebo::physics::World::ProcessMessages() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#16 0x00007ffff5b1ad84 in gazebo::physics::World::Step() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#17 0x00007ffff5b1b1cd in gazebo::physics::World::RunLoop() ()\r\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\r\n#18 0x00007ffff69a166f in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#19 0x00007ffff5dfd6db in start_thread (arg=0x7fff1ffff700)\r\n    at pthread_create.c:463\r\n#20 0x00007ffff63fc88f in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n```\r\n\r\n\u200c\r\n\r\nI think this is because of versions of assimp.  \r\nThis commit of assimp [https://github.com/assimp/assimp/commit/36e53b75fa24b9286a57c1e1eaaf25a9427da26b#diff-758737a587ca204dec82e47c452466d2](https://github.com/assimp/assimp/commit/36e53b75fa24b9286a57c1e1eaaf25a9427da26b#diff-758737a587ca204dec82e47c452466d2)  \r\nchanged the output collada mesh  \r\nftom\r\n\r\n```\r\n<mesh>\r\n  ...\r\n  <vertices id=\"meshId0-vertices\">\r\n    <input semantic=\"POSITION\" source=\"#meshId0-positions\" />\r\n    <input semantic=\"NORMAL\" source=\"#meshId0-normals\" />\r\n  </vertices>\r\n  <polylist count=\"11\" material=\"defaultMaterial\">\r\n    <input offset=\"0\" semantic=\"VERTEX\" source=\"#meshId0-vertices\" />\r\n    <vcount>3 3 3 3 3 3 3 3 3 3 3 </vcount>\r\n    <p>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 17 18 15 19 20 21 21 22 19 23 24 25 26 27 28 </p>\r\n  </polylist>\r\n</mesh>\r\n```\r\n\r\nto\r\n\r\n```\r\n<mesh>\r\n  ...\r\n  <vertices id=\"meshId0-vertices\">                                                                                \r\n    <input semantic=\"POSITION\" source=\"#meshId0-positions\" />                                                     \r\n  </vertices>                                                                                                     \r\n  <polylist count=\"11\" material=\"defaultMaterial\">                                                                \r\n    <input offset=\"0\" semantic=\"VERTEX\" source=\"#meshId0-vertices\" />                                             \r\n    <input offset=\"0\" semantic=\"NORMAL\" source=\"#meshId0-normals\" />                                              \r\n    <vcount>3 3 3 3 3 3 3 3 3 3 3 </vcount>                                                                       \r\n    <p>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 17 18 15 19 20 21 21 22 19 23 24 25 26 27 28 </p>              \r\n  </polylist>\r\n</mesh>\r\n```\r\n\r\nThis modification may cause `index out of range` at this line of gazebo.  \r\n[#!/osrf/gazebo/src/a3eb517b0fa58d230f87e5dadf5976b1d4f1d3c9/gazebo/common/ColladaLoader.cc?fileviewer=file-view-default#lines-1548](#!/osrf/gazebo/src/a3eb517b0fa58d230f87e5dadf5976b1d4f1d3c9/gazebo/common/ColladaLoader.cc?fileviewer=file-view-default#lines-1548)", "markup": "markdown", "html": "<p>related to <a data-is-external-link=\"true\" href=\"https://github.com/ros/collada_urdf/issues/34\" rel=\"nofollow\">https://github.com/ros/collada_urdf/issues/34</a></p>\n<p>When I spawned an urdf model with collada meshes into gazebo9 (ubuntu18.04), I got Segmentation fault (core dumped).</p>\n<p>I generated the collada meshes with assimp v4.1.0.<br />\nI did not get this Segmentation fault on ubuntu 16.04 (gazebo7, assimp v3.2).</p>\n<div class=\"codehilite\"><pre><span></span>Thread 39 &quot;gzserver&quot; received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7fff1ffff700 (LWP 23344)]\n0x00007ffff6a0aa76 in std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::find_first_not_of(char, unsigned long) const ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n(gdb) Segmentation fault (core dumped)\n[gazebo_gui-3] process has died [pid 23197, exit code 139, cmd /opt/ros/melodic/lib/gazebo_ros/gzclient __name:=gazebo_gui __log:=/home/hiraoka/.ros/log/d975cdd0-31f4-11ea-99d9-5c514f34f247/gazebo_gui-3.log].\nlog file: /home/hiraoka/.ros/log/d975cdd0-31f4-11ea-99d9-5c514f34f247/gazebo_gui-3*.log\n\n(gdb) bt\n#0  0x00007ffff6a0aa76 in std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::find_first_not_of(char, unsigned long) const ()\n    at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#1  0x00007ffff6ec6acf in  ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#2  0x00007ffff6ed9a63 in gazebo::common::ColladaLoader::LoadPolylist(TiXmlElement*, ignition::math::v4::Matrix4&lt;double&gt; const&amp;, gazebo::common::Mesh*) ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#3  0x00007ffff6edc859 in gazebo::common::ColladaLoader::LoadGeometry(TiXmlElement*, ignition::math::v4::Matrix4&lt;double&gt; const&amp;, gazebo::common::Mesh*) ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#4  0x00007ffff6ede830 in gazebo::common::ColladaLoader::LoadNode(TiXmlElement*, gazebo::common::Mesh*, ignition::math::v4::Matrix4&lt;double&gt; const&amp;) ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#5  0x00007ffff6edef89 in gazebo::common::ColladaLoader::LoadScene(gazebo::common::Mesh*) () at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#6  0x00007ffff6edf4b0 in gazebo::common::ColladaLoader::Load(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;) ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#7  0x00007ffff6efe89a in gazebo::common::MeshManager::Load(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;) ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_common.so.9\n#8  0x00007ffff5abee8b in gazebo::physics::MeshShape::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#9  0x00007ffff59d54c4 in gazebo::physics::ODEMeshShape::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#10 0x00007ffff5a65762 in gazebo::physics::Collision::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#11 0x00007ffff5aac27e in gazebo::physics::Link::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#12 0x00007ffff59d30ae in gazebo::physics::ODELink::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#13 0x00007ffff5ac9a9e in gazebo::physics::Model::Init() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#14 0x00007ffff5b13727 in gazebo::physics::World::ProcessFactoryMsgs() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#15 0x00007ffff5b1945d in gazebo::physics::World::ProcessMessages() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#16 0x00007ffff5b1ad84 in gazebo::physics::World::Step() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#17 0x00007ffff5b1b1cd in gazebo::physics::World::RunLoop() ()\n    at /usr/lib/x86_64-linux-gnu/libgazebo_physics.so.9\n#18 0x00007ffff69a166f in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#19 0x00007ffff5dfd6db in start_thread (arg=0x7fff1ffff700)\n    at pthread_create.c:463\n#20 0x00007ffff63fc88f in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n</pre></div>\n\n\n<p>\u200c</p>\n<p>I think this is because of versions of assimp.<br />\nThis commit of assimp <a data-is-external-link=\"true\" href=\"https://github.com/assimp/assimp/commit/36e53b75fa24b9286a57c1e1eaaf25a9427da26b#diff-758737a587ca204dec82e47c452466d2\" rel=\"nofollow\">https://github.com/assimp/assimp/commit/36e53b75fa24b9286a57c1e1eaaf25a9427da26b#diff-758737a587ca204dec82e47c452466d2</a><br />\nchanged the output collada mesh<br />\nftom</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;mesh&gt;</span>\n  ...\n  <span class=\"nt\">&lt;vertices</span> <span class=\"na\">id=</span><span class=\"s\">&quot;meshId0-vertices&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;input</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;POSITION&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-positions&quot;</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;input</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;NORMAL&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-normals&quot;</span> <span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/vertices&gt;</span>\n  <span class=\"nt\">&lt;polylist</span> <span class=\"na\">count=</span><span class=\"s\">&quot;11&quot;</span> <span class=\"na\">material=</span><span class=\"s\">&quot;defaultMaterial&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;input</span> <span class=\"na\">offset=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;VERTEX&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-vertices&quot;</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;vcount&gt;</span>3 3 3 3 3 3 3 3 3 3 3 <span class=\"nt\">&lt;/vcount&gt;</span>\n    <span class=\"nt\">&lt;p&gt;</span>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 17 18 15 19 20 21 21 22 19 23 24 25 26 27 28 <span class=\"nt\">&lt;/p&gt;</span>\n  <span class=\"nt\">&lt;/polylist&gt;</span>\n<span class=\"nt\">&lt;/mesh&gt;</span>\n</pre></div>\n\n\n<p>to</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;mesh&gt;</span>\n  ...\n  <span class=\"nt\">&lt;vertices</span> <span class=\"na\">id=</span><span class=\"s\">&quot;meshId0-vertices&quot;</span><span class=\"nt\">&gt;</span>                                                                                \n    <span class=\"nt\">&lt;input</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;POSITION&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-positions&quot;</span> <span class=\"nt\">/&gt;</span>                                                     \n  <span class=\"nt\">&lt;/vertices&gt;</span>                                                                                                     \n  <span class=\"nt\">&lt;polylist</span> <span class=\"na\">count=</span><span class=\"s\">&quot;11&quot;</span> <span class=\"na\">material=</span><span class=\"s\">&quot;defaultMaterial&quot;</span><span class=\"nt\">&gt;</span>                                                                \n    <span class=\"nt\">&lt;input</span> <span class=\"na\">offset=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;VERTEX&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-vertices&quot;</span> <span class=\"nt\">/&gt;</span>                                             \n    <span class=\"nt\">&lt;input</span> <span class=\"na\">offset=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">semantic=</span><span class=\"s\">&quot;NORMAL&quot;</span> <span class=\"na\">source=</span><span class=\"s\">&quot;#meshId0-normals&quot;</span> <span class=\"nt\">/&gt;</span>                                              \n    <span class=\"nt\">&lt;vcount&gt;</span>3 3 3 3 3 3 3 3 3 3 3 <span class=\"nt\">&lt;/vcount&gt;</span>                                                                       \n    <span class=\"nt\">&lt;p&gt;</span>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 17 18 15 19 20 21 21 22 19 23 24 25 26 27 28 <span class=\"nt\">&lt;/p&gt;</span>              \n  <span class=\"nt\">&lt;/polylist&gt;</span>\n<span class=\"nt\">&lt;/mesh&gt;</span>\n</pre></div>\n\n\n<p>This modification may cause <code>index out of range</code> at this line of gazebo.<br />\n<a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/a3eb517b0fa58d230f87e5dadf5976b1d4f1d3c9/gazebo/common/ColladaLoader.cc?fileviewer=file-view-default#lines-1548\" rel=\"nofollow\">#!/osrf/gazebo/src/a3eb517b0fa58d230f87e5dadf5976b1d4f1d3c9/gazebo/common/ColladaLoader.cc?fileviewer=file-view-default#lines-1548</a></p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2020-01-09T01:34:32.774448+00:00", "milestone": null, "updated_on": "2020-01-09T01:34:32.774448+00:00", "type": "issue", "id": 2682}