{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/722/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/722.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/722/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/722/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/722/infrequent-transport_stress-test-seg-fault"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/722/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "Infrequent transport_stress test seg-fault", "component": {"name": "testing", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/128164.json"}}}, "votes": 0, "watches": 4, "content": {"raw": "I have seen infrequent seg-faults of the transport_stress test in my overnight builds for a while (about 1 in 50). It occurs during teardown after an otherwise successful test.\r\n\r\nConsole output:\r\n~~~\r\n[ RUN      ] TransportStressTest.ManyNodes\r\nMsg Waiting for master\r\nMsg Connected to gazebo master @ http://127.0.0.1:11345\r\nMsg Publicized address: 192.168.1.67\r\nDbg ServerFixture load in 0.02 seconds, timeout after 60 seconds\r\nMsg Publish complete\r\nWarning [Publisher.cc:144] Queue limit reached for topic /gazebo/default/physics/contacts, deleting message. This warning is printed only once.\r\nWarning [Publisher.cc:144] Queue limit reached for topic /gazebo/default/diagnostics, deleting message. This warning is printed only once.\r\nMsg Time to publish 10000 = 0 162833906\r\nMsg Time to receive 10000000 = 3 412667086\r\nSegmentation fault (core dumped)\r\n~~~\r\n\r\nI've just gotten a backtrace from a source build of gazebo_1.8.5 (6564bf3). The complaint seems to be an increment operator in [Publication::RemoveSubscription](#!/osrf/gazebo/src/6564bf34fc453f7d5a7aaa06ca18073d0a2d10cf/gazebo/transport/Publication.cc?at=gazebo_1.8#cl-187)\r\n~~~\r\nCore was generated by `test/performance/transport_stress'.\r\nProgram terminated with signal 11, Segmentation fault.\r\n#0  operator++ (this=<optimized out>)\r\n    at /usr/include/c++/4.6/bits/stl_list.h:234\r\n234\t\t_M_node = _M_node->_M_next;\r\n(gdb) bt\r\n#0  operator++ (this=<optimized out>)\r\n    at /usr/include/c++/4.6/bits/stl_list.h:234\r\n#1  __distance<std::_List_const_iterator<boost::shared_ptr<gazebo::transport::Node> > > (__last=..., __first=...)\r\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:82\r\n#2  distance<std::_List_const_iterator<boost::shared_ptr<gazebo::transport::Node> > > (__last=..., __first=...)\r\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:117\r\n#3  size (this=0x1c5d450) at /usr/include/c++/4.6/bits/stl_list.h:846\r\n#4  gazebo::transport::Publication::RemoveSubscription (this=0x1c5d420, \r\n    _host=..., _port=54692)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Publication.cc:219\r\n#5  0x00007fe75e4ec214 in gazebo::transport::TopicManager::DisconnectPubFromSub\r\n    (this=<optimized out>, topic=..., host=..., port=54692)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:273\r\n#6  0x00007fe75e4d593a in gazebo::transport::ConnectionManager::ProcessMessage\r\n    (this=<optimized out>, _data=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:430\r\n#7  0x00007fe75e4d673c in gazebo::transport::ConnectionManager::RunUpdate (\r\n    this=0x6a42e0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:263\r\n#8  0x00007fe75e4d7a22 in gazebo::transport::ConnectionManager::Run (\r\n    this=0x6a42e0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:310\r\n#9  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#10 0x00007fe75e26ce9a in start_thread (arg=0x7fe73abff700)\r\n    at pthread_create.c:308\r\n#11 0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#12 0x0000000000000000 in ?? ()\r\n(gdb)\r\n~~~\r\n\r\nBacktrace of all threads:\r\n~~~\r\n(gdb) thread apply all bt\r\n\r\nThread 17 (Thread 0x7fe7393d9700 (LWP 7093)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe7393d9700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 16 (Thread 0x7fe7397da700 (LWP 7099)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe7397da700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 15 (Thread 0x7fe72ffff700 (LWP 7100)):\r\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\r\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\r\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (this=0x6a4a80, \r\n    m=...) at /usr/include/boost/thread/pthread/condition_variable.hpp:53\r\n#2  0x00007fe75f670c37 in gazebo::common::ModelDatabase::UpdateModelCache (\r\n    this=0x6a49a0, _fetchImmediately=false)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/ModelDatabase.cc:274\r\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72ffff700)\r\n    at pthread_create.c:308\r\n#5  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#6  0x0000000000000000 in ?? ()\r\n\r\n---Type <return> to continue, or q <return> to quit---\r\nThread 14 (Thread 0x7fe72e7fc700 (LWP 7103)):\r\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\r\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\r\n#2  0x00007fe75f16780f in gazebo::physics::World::Step (this=0x7fe73c5b7d60)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:483\r\n#3  0x00007fe75f16a5bc in gazebo::physics::World::RunLoop (this=0x7fe73c5b7d60)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:365\r\n#4  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#5  0x00007fe75e26ce9a in start_thread (arg=0x7fe72e7fc700)\r\n    at pthread_create.c:308\r\n#6  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#7  0x0000000000000000 in ?? ()\r\n\r\nThread 13 (Thread 0x7fe748bc5700 (LWP 7096)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe748bc5700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 12 (Thread 0x7fe72f7fe700 (LWP 7101)):\r\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\r\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\r\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (\r\n    this=0x7fe73c190390, m=...)\r\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\r\n#2  0x00007fe75ee3f729 in gazebo::sensors::SensorManager::SensorContainer::RunLoop (this=0x7fe73c1902f0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/sensors/SensorManager.cc:463\r\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n---Type <return> to continue, or q <return> to quit---\r\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72f7fe700)\r\n    at pthread_create.c:308\r\n#5  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#6  0x0000000000000000 in ?? ()\r\n\r\nThread 11 (Thread 0x7fe749be7700 (LWP 7089)):\r\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\r\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\r\n#2  0x00007fe75f68a893 in gazebo::common::Time::MSleep (_ms=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:189\r\n#3  0x000000000044da4f in gazebo::Server::Run (this=0x7fe73c14aae0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/Server.cc:470\r\n#4  0x0000000000444458 in ServerFixture::RunServer (this=0x1c5bf70, \r\n    _worldFilename=..., _paused=false, _physics=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/ServerFixture.hh:222\r\n#5  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#6  0x00007fe75e26ce9a in start_thread (arg=0x7fe749be7700)\r\n    at pthread_create.c:308\r\n#7  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#8  0x0000000000000000 in ?? ()\r\n\r\nThread 10 (Thread 0x7fe72d7f9700 (LWP 7104)):\r\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\r\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\r\n#1  0x00007fe75f168fbb in wait (m=..., this=0x7fe73c5b84b0)\r\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\r\n#2  gazebo::physics::World::LogWorker (this=0x7fe73c5b7d60)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:1888\r\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72d7f9700)\r\n    at pthread_create.c:308\r\n#5  0x00007fe75ca63cbd in clone ()\r\n---Type <return> to continue, or q <return> to quit---\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#6  0x0000000000000000 in ?? ()\r\n\r\nThread 9 (Thread 0x7fe72effd700 (LWP 7102)):\r\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\r\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\r\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (\r\n    this=0x7fe73c190490, m=...)\r\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\r\n#2  0x00007fe75ee3f729 in gazebo::sensors::SensorManager::SensorContainer::RunLoop (this=0x7fe73c1903f0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/sensors/SensorManager.cc:463\r\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72effd700)\r\n    at pthread_create.c:308\r\n#5  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#6  0x0000000000000000 in ?? ()\r\n\r\nThread 8 (Thread 0x7fe739bdb700 (LWP 7097)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe739bdb700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 7 (Thread 0x7fe738bd7700 (LWP 7098)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe738bd7700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n---Type <return> to continue, or q <return> to quit---\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 6 (Thread 0x7fe739fdc700 (LWP 7094)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe739fdc700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 5 (Thread 0x7fe738fd8700 (LWP 7095)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\r\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe738fd8700)\r\n    at pthread_create.c:308\r\n#4  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 4 (Thread 0x7fe7493e6700 (LWP 7091)):\r\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\r\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\r\n#2  0x00007fe75f68a893 in gazebo::common::Time::MSleep (_ms=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:189\r\n#3  0x000000000045c95d in gazebo::Master::Run (this=0x7fe73c50e740)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/Master.cc:300\r\n#4  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#5  0x00007fe75e26ce9a in start_thread (arg=0x7fe7493e6700)\r\n    at pthread_create.c:308\r\n#6  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n---Type <return> to continue, or q <return> to quit---\r\n#7  0x0000000000000000 in ?? ()\r\n\r\nThread 3 (Thread 0x7fe75fd26840 (LWP 7072)):\r\n#0  0x00007fe75ca64b67 in getsockname ()\r\n    at ../sysdeps/unix/syscall-template.S:82\r\n#1  0x00007fe75e4c0d10 in call_getsockname<unsigned int> (\r\n    addrlen=<synthetic pointer>, addr=0x7fff4ee03460, s=9)\r\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:1395\r\n#2  getsockname (addrlen=<synthetic pointer>, addr=0x7fff4ee03460, s=9, ec=...)\r\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:1411\r\n#3  local_endpoint (ec=..., impl=..., this=<optimized out>)\r\n    at /usr/include/boost/asio/detail/reactive_socket_service.hpp:146\r\n#4  local_endpoint (ec=..., impl=..., this=<optimized out>)\r\n    at /usr/include/boost/asio/socket_acceptor_service.hpp:188\r\n#5  local_endpoint (this=<optimized out>)\r\n    at /usr/include/boost/asio/basic_socket_acceptor.hpp:585\r\n#6  gazebo::transport::Connection::GetLocalPort (this=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Connection.cc:554\r\n#7  0x00007fe75e4d4edb in gazebo::transport::ConnectionManager::Unsubscribe (\r\n    this=0x6a42e0, _topic=..., _msgType=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:593\r\n#8  0x00007fe75e4ed4fa in gazebo::transport::TopicManager::Unsubscribe (\r\n    this=0x6a4140, _topic=..., _node=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:255\r\n#9  0x00007fe75e4eb9b7 in gazebo::transport::Subscriber::Unsubscribe (\r\n    this=0x1d64f50)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:52\r\n#10 0x00007fe75e4eba8c in gazebo::transport::Subscriber::~Subscriber (\r\n    this=0x1d64f50, __in_chrg=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:37\r\n#11 0x00007fe75e4ebb99 in gazebo::transport::Subscriber::~Subscriber (\r\n    this=0x1d64f50, __in_chrg=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:39\r\n#12 0x0000000000443499 in release (this=0x1d64db0)\r\n    at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:145\r\n#13 release (this=0x1d64db0)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:243\r\n---Type <return> to continue, or q <return> to quit---\r\n#14 boost::detail::shared_count::~shared_count (this=<optimized out>, \r\n    __in_chrg=<optimized out>)\r\n    at /usr/include/boost/smart_ptr/detail/shared_count.hpp:217\r\n#15 0x000000000043f62f in ~shared_ptr (this=0x1d65020, \r\n    __in_chrg=<optimized out>)\r\n    at /usr/include/boost/smart_ptr/shared_ptr.hpp:168\r\n#16 destroy (__p=0x1d65020, this=<optimized out>)\r\n    at /usr/include/c++/4.6/ext/new_allocator.h:118\r\n#17 _M_clear (this=0x7fff4ee03770) at /usr/include/c++/4.6/bits/list.tcc:78\r\n#18 ~_List_base (this=0x7fff4ee03770, __in_chrg=<optimized out>)\r\n    at /usr/include/c++/4.6/bits/stl_list.h:372\r\n#19 ~list (this=0x7fff4ee03770, __in_chrg=<optimized out>)\r\n    at /usr/include/c++/4.6/bits/stl_list.h:429\r\n#20 TransportStressTest_ManyNodes_Test::TestBody (this=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:234\r\n#21 0x000000000048112d in HandleSehExceptionsInMethodIfSupported<testing::Test, void> (method=<optimized out>, object=<optimized out>, \r\n    location=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2090\r\n#22 testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>\r\n    (object=0x1c5bf70, method=&virtual testing::Test::TestBody(), \r\n    location=0x486dee \"the test body\")\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2126\r\n#23 0x0000000000479061 in testing::Test::Run (this=0x1c5bf70)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2162\r\n#24 0x0000000000479146 in testing::TestInfo::Run (this=0x1c56a40)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2338\r\n#25 0x0000000000479287 in testing::TestCase::Run (this=0x1c56960)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2445\r\n#26 0x00000000004795de in RunAllTests (this=0x1c56680)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:4237\r\n#27 testing::internal::UnitTestImpl::RunAllTests (this=0x1c56680)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:4145\r\n#28 0x0000000000480cad in HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool> (method=<optimized out>, object=<optimized out>, \r\n    location=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2090\r\n---Type <return> to continue, or q <return> to quit---\r\n#29 testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool> (object=0x1c56680, method=\r\n    (bool (testing::internal::UnitTestImpl::*)(testing::internal::UnitTestImpl * const)) 0x479300 <testing::internal::UnitTestImpl::RunAllTests()>, \r\n    location=0x487fd8 \"auxiliary test code (environments or event listeners)\")\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2126\r\n#30 0x00000000004786be in testing::UnitTest::Run (this=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:3874\r\n#31 0x000000000043afef in main (argc=1, argv=<optimized out>)\r\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:242\r\n\r\nThread 2 (Thread 0x7fe74a3e8700 (LWP 7090)):\r\n#0  0x00007fe75ca64353 in epoll_wait ()\r\n    at ../sysdeps/unix/syscall-template.S:82\r\n#1  0x00007fe75e4dfad4 in boost::asio::detail::epoll_reactor::run (\r\n    this=0x7fe73c5fa620, block=<optimized out>, ops=...)\r\n    at /usr/include/boost/asio/detail/impl/epoll_reactor.ipp:240\r\n#2  0x00007fe75e4e00f6 in do_one (this_idle_thread=<optimized out>, lock=..., \r\n    this=<optimized out>)\r\n    at /usr/include/boost/asio/detail/impl/task_io_service.ipp:264\r\n#3  boost::asio::detail::task_io_service::run (this=0x7fe73c5ecb90, ec=...)\r\n    at /usr/include/boost/asio/detail/impl/task_io_service.ipp:130\r\n#4  0x00007fe75e4e06a5 in boost::asio::io_service::run (this=0x7fe73c553800)\r\n    at /usr/include/boost/asio/impl/io_service.ipp:57\r\n#5  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#6  0x00007fe75e26ce9a in start_thread (arg=0x7fe74a3e8700)\r\n    at pthread_create.c:308\r\n#7  0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#8  0x0000000000000000 in ?? ()\r\n\r\nThread 1 (Thread 0x7fe73abff700 (LWP 7092)):\r\n#0  operator++ (this=<optimized out>)\r\n    at /usr/include/c++/4.6/bits/stl_list.h:234\r\n#1  __distance<std::_List_const_iterator<boost::shared_ptr<gazebo::transport::Node> > > (__last=..., __first=...)\r\n---Type <return> to continue, or q <return> to quit---\r\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:82\r\n#2  distance<std::_List_const_iterator<boost::shared_ptr<gazebo::transport::Node> > > (__last=..., __first=...)\r\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:117\r\n#3  size (this=0x1c5d450) at /usr/include/c++/4.6/bits/stl_list.h:846\r\n#4  gazebo::transport::Publication::RemoveSubscription (this=0x1c5d420, \r\n    _host=..., _port=54692)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Publication.cc:219\r\n#5  0x00007fe75e4ec214 in gazebo::transport::TopicManager::DisconnectPubFromSub\r\n    (this=<optimized out>, topic=..., host=..., port=54692)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:273\r\n#6  0x00007fe75e4d593a in gazebo::transport::ConnectionManager::ProcessMessage\r\n    (this=<optimized out>, _data=...)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:430\r\n#7  0x00007fe75e4d673c in gazebo::transport::ConnectionManager::RunUpdate (\r\n    this=0x6a42e0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:263\r\n#8  0x00007fe75e4d7a22 in gazebo::transport::ConnectionManager::Run (\r\n    this=0x6a42e0)\r\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:310\r\n#9  0x00007fe75d8e7ce9 in thread_proxy ()\r\n   from /usr/lib/libboost_thread.so.1.46.1\r\n#10 0x00007fe75e26ce9a in start_thread (arg=0x7fe73abff700)\r\n    at pthread_create.c:308\r\n#11 0x00007fe75ca63cbd in clone ()\r\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\r\n#12 0x0000000000000000 in ?? ()\r\n(gdb) \r\n~~~", "markup": "markdown", "html": "<p>I have seen infrequent seg-faults of the transport_stress test in my overnight builds for a while (about 1 in 50). It occurs during teardown after an otherwise successful test.</p>\n<p>Console output:</p>\n<div class=\"codehilite\"><pre><span></span>[ RUN      ] TransportStressTest.ManyNodes\nMsg Waiting for master\nMsg Connected to gazebo master @ http://127.0.0.1:11345\nMsg Publicized address: 192.168.1.67\nDbg ServerFixture load in 0.02 seconds, timeout after 60 seconds\nMsg Publish complete\nWarning [Publisher.cc:144] Queue limit reached for topic /gazebo/default/physics/contacts, deleting message. This warning is printed only once.\nWarning [Publisher.cc:144] Queue limit reached for topic /gazebo/default/diagnostics, deleting message. This warning is printed only once.\nMsg Time to publish 10000 = 0 162833906\nMsg Time to receive 10000000 = 3 412667086\nSegmentation fault (core dumped)\n</pre></div>\n\n\n<p>I've just gotten a backtrace from a source build of gazebo_1.8.5 (<a href=\"#!/osrf/gazebo/commits/6564bf3\" rel=\"nofollow\" class=\"ap-connect-link\">6564bf3</a>). The complaint seems to be an increment operator in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/6564bf34fc453f7d5a7aaa06ca18073d0a2d10cf/gazebo/transport/Publication.cc?at=gazebo_1.8#cl-187\" rel=\"nofollow\">Publication::RemoveSubscription</a></p>\n<div class=\"codehilite\"><pre><span></span>Core was generated by `test/performance/transport_stress&#39;.\nProgram terminated with signal 11, Segmentation fault.\n#0  operator++ (this=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/bits/stl_list.h:234\n234     _M_node = _M_node-&gt;_M_next;\n(gdb) bt\n#0  operator++ (this=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/bits/stl_list.h:234\n#1  __distance&lt;std::_List_const_iterator&lt;boost::shared_ptr&lt;gazebo::transport::Node&gt; &gt; &gt; (__last=..., __first=...)\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:82\n#2  distance&lt;std::_List_const_iterator&lt;boost::shared_ptr&lt;gazebo::transport::Node&gt; &gt; &gt; (__last=..., __first=...)\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:117\n#3  size (this=0x1c5d450) at /usr/include/c++/4.6/bits/stl_list.h:846\n#4  gazebo::transport::Publication::RemoveSubscription (this=0x1c5d420, \n    _host=..., _port=54692)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Publication.cc:219\n#5  0x00007fe75e4ec214 in gazebo::transport::TopicManager::DisconnectPubFromSub\n    (this=&lt;optimized out&gt;, topic=..., host=..., port=54692)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:273\n#6  0x00007fe75e4d593a in gazebo::transport::ConnectionManager::ProcessMessage\n    (this=&lt;optimized out&gt;, _data=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:430\n#7  0x00007fe75e4d673c in gazebo::transport::ConnectionManager::RunUpdate (\n    this=0x6a42e0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:263\n#8  0x00007fe75e4d7a22 in gazebo::transport::ConnectionManager::Run (\n    this=0x6a42e0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:310\n#9  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#10 0x00007fe75e26ce9a in start_thread (arg=0x7fe73abff700)\n    at pthread_create.c:308\n#11 0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#12 0x0000000000000000 in ?? ()\n(gdb)\n</pre></div>\n\n\n<p>Backtrace of all threads:</p>\n<div class=\"codehilite\"><pre><span></span>(gdb) thread apply all bt\n\nThread 17 (Thread 0x7fe7393d9700 (LWP 7093)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe7393d9700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 16 (Thread 0x7fe7397da700 (LWP 7099)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe7397da700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 15 (Thread 0x7fe72ffff700 (LWP 7100)):\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (this=0x6a4a80, \n    m=...) at /usr/include/boost/thread/pthread/condition_variable.hpp:53\n#2  0x00007fe75f670c37 in gazebo::common::ModelDatabase::UpdateModelCache (\n    this=0x6a49a0, _fetchImmediately=false)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/ModelDatabase.cc:274\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72ffff700)\n    at pthread_create.c:308\n#5  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#6  0x0000000000000000 in ?? ()\n\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\nThread 14 (Thread 0x7fe72e7fc700 (LWP 7103)):\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\n#2  0x00007fe75f16780f in gazebo::physics::World::Step (this=0x7fe73c5b7d60)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:483\n#3  0x00007fe75f16a5bc in gazebo::physics::World::RunLoop (this=0x7fe73c5b7d60)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:365\n#4  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#5  0x00007fe75e26ce9a in start_thread (arg=0x7fe72e7fc700)\n    at pthread_create.c:308\n#6  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#7  0x0000000000000000 in ?? ()\n\nThread 13 (Thread 0x7fe748bc5700 (LWP 7096)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe748bc5700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 12 (Thread 0x7fe72f7fe700 (LWP 7101)):\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (\n    this=0x7fe73c190390, m=...)\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\n#2  0x00007fe75ee3f729 in gazebo::sensors::SensorManager::SensorContainer::RunLoop (this=0x7fe73c1902f0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/sensors/SensorManager.cc:463\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72f7fe700)\n    at pthread_create.c:308\n#5  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#6  0x0000000000000000 in ?? ()\n\nThread 11 (Thread 0x7fe749be7700 (LWP 7089)):\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\n#2  0x00007fe75f68a893 in gazebo::common::Time::MSleep (_ms=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:189\n#3  0x000000000044da4f in gazebo::Server::Run (this=0x7fe73c14aae0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/Server.cc:470\n#4  0x0000000000444458 in ServerFixture::RunServer (this=0x1c5bf70, \n    _worldFilename=..., _paused=false, _physics=...)\n    at /home/scpeters/osrf/gazebo_1.8/test/ServerFixture.hh:222\n#5  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#6  0x00007fe75e26ce9a in start_thread (arg=0x7fe749be7700)\n    at pthread_create.c:308\n#7  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#8  0x0000000000000000 in ?? ()\n\nThread 10 (Thread 0x7fe72d7f9700 (LWP 7104)):\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\n#1  0x00007fe75f168fbb in wait (m=..., this=0x7fe73c5b84b0)\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\n#2  gazebo::physics::World::LogWorker (this=0x7fe73c5b7d60)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/physics/World.cc:1888\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72d7f9700)\n    at pthread_create.c:308\n#5  0x00007fe75ca63cbd in clone ()\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#6  0x0000000000000000 in ?? ()\n\nThread 9 (Thread 0x7fe72effd700 (LWP 7102)):\n#0  pthread_cond_wait@@GLIBC_2.3.2 ()\n    at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162\n#1  0x00007fe75f6762e3 in boost::condition_variable::wait (\n    this=0x7fe73c190490, m=...)\n    at /usr/include/boost/thread/pthread/condition_variable.hpp:53\n#2  0x00007fe75ee3f729 in gazebo::sensors::SensorManager::SensorContainer::RunLoop (this=0x7fe73c1903f0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/sensors/SensorManager.cc:463\n#3  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#4  0x00007fe75e26ce9a in start_thread (arg=0x7fe72effd700)\n    at pthread_create.c:308\n#5  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#6  0x0000000000000000 in ?? ()\n\nThread 8 (Thread 0x7fe739bdb700 (LWP 7097)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe739bdb700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 7 (Thread 0x7fe738bd7700 (LWP 7098)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe738bd7700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 6 (Thread 0x7fe739fdc700 (LWP 7094)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe739fdc700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 5 (Thread 0x7fe738fd8700 (LWP 7095)):\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:39\n#1  0x00007fe75d25c293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007fe75d25c2c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007fe75e26ce9a in start_thread (arg=0x7fe738fd8700)\n    at pthread_create.c:308\n#4  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#5  0x0000000000000000 in ?? ()\n\nThread 4 (Thread 0x7fe7493e6700 (LWP 7091)):\n#0  0x00007fe75e27452d in nanosleep () at ../sysdeps/unix/syscall-template.S:82\n#1  0x00007fe75f68a34d in gazebo::common::Time::Sleep (_time=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:171\n#2  0x00007fe75f68a893 in gazebo::common::Time::MSleep (_ms=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/common/Time.cc:189\n#3  0x000000000045c95d in gazebo::Master::Run (this=0x7fe73c50e740)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/Master.cc:300\n#4  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#5  0x00007fe75e26ce9a in start_thread (arg=0x7fe7493e6700)\n    at pthread_create.c:308\n#6  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#7  0x0000000000000000 in ?? ()\n\nThread 3 (Thread 0x7fe75fd26840 (LWP 7072)):\n#0  0x00007fe75ca64b67 in getsockname ()\n    at ../sysdeps/unix/syscall-template.S:82\n#1  0x00007fe75e4c0d10 in call_getsockname&lt;unsigned int&gt; (\n    addrlen=&lt;synthetic pointer&gt;, addr=0x7fff4ee03460, s=9)\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:1395\n#2  getsockname (addrlen=&lt;synthetic pointer&gt;, addr=0x7fff4ee03460, s=9, ec=...)\n    at /usr/include/boost/asio/detail/impl/socket_ops.ipp:1411\n#3  local_endpoint (ec=..., impl=..., this=&lt;optimized out&gt;)\n    at /usr/include/boost/asio/detail/reactive_socket_service.hpp:146\n#4  local_endpoint (ec=..., impl=..., this=&lt;optimized out&gt;)\n    at /usr/include/boost/asio/socket_acceptor_service.hpp:188\n#5  local_endpoint (this=&lt;optimized out&gt;)\n    at /usr/include/boost/asio/basic_socket_acceptor.hpp:585\n#6  gazebo::transport::Connection::GetLocalPort (this=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Connection.cc:554\n#7  0x00007fe75e4d4edb in gazebo::transport::ConnectionManager::Unsubscribe (\n    this=0x6a42e0, _topic=..., _msgType=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:593\n#8  0x00007fe75e4ed4fa in gazebo::transport::TopicManager::Unsubscribe (\n    this=0x6a4140, _topic=..., _node=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:255\n#9  0x00007fe75e4eb9b7 in gazebo::transport::Subscriber::Unsubscribe (\n    this=0x1d64f50)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:52\n#10 0x00007fe75e4eba8c in gazebo::transport::Subscriber::~Subscriber (\n    this=0x1d64f50, __in_chrg=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:37\n#11 0x00007fe75e4ebb99 in gazebo::transport::Subscriber::~Subscriber (\n    this=0x1d64f50, __in_chrg=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Subscriber.cc:39\n#12 0x0000000000443499 in release (this=0x1d64db0)\n    at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:145\n#13 release (this=0x1d64db0)\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:243\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#14 boost::detail::shared_count::~shared_count (this=&lt;optimized out&gt;, \n    __in_chrg=&lt;optimized out&gt;)\n    at /usr/include/boost/smart_ptr/detail/shared_count.hpp:217\n#15 0x000000000043f62f in ~shared_ptr (this=0x1d65020, \n    __in_chrg=&lt;optimized out&gt;)\n    at /usr/include/boost/smart_ptr/shared_ptr.hpp:168\n#16 destroy (__p=0x1d65020, this=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/ext/new_allocator.h:118\n#17 _M_clear (this=0x7fff4ee03770) at /usr/include/c++/4.6/bits/list.tcc:78\n#18 ~_List_base (this=0x7fff4ee03770, __in_chrg=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/bits/stl_list.h:372\n#19 ~list (this=0x7fff4ee03770, __in_chrg=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/bits/stl_list.h:429\n#20 TransportStressTest_ManyNodes_Test::TestBody (this=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:234\n#21 0x000000000048112d in HandleSehExceptionsInMethodIfSupported&lt;testing::Test, void&gt; (method=&lt;optimized out&gt;, object=&lt;optimized out&gt;, \n    location=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2090\n#22 testing::internal::HandleExceptionsInMethodIfSupported&lt;testing::Test, void&gt;\n    (object=0x1c5bf70, method=&amp;virtual testing::Test::TestBody(), \n    location=0x486dee &quot;the test body&quot;)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2126\n#23 0x0000000000479061 in testing::Test::Run (this=0x1c5bf70)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2162\n#24 0x0000000000479146 in testing::TestInfo::Run (this=0x1c56a40)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2338\n#25 0x0000000000479287 in testing::TestCase::Run (this=0x1c56960)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2445\n#26 0x00000000004795de in RunAllTests (this=0x1c56680)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:4237\n#27 testing::internal::UnitTestImpl::RunAllTests (this=0x1c56680)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:4145\n#28 0x0000000000480cad in HandleSehExceptionsInMethodIfSupported&lt;testing::internal::UnitTestImpl, bool&gt; (method=&lt;optimized out&gt;, object=&lt;optimized out&gt;, \n    location=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2090\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#29 testing::internal::HandleExceptionsInMethodIfSupported&lt;testing::internal::UnitTestImpl, bool&gt; (object=0x1c56680, method=\n    (bool (testing::internal::UnitTestImpl::*)(testing::internal::UnitTestImpl * const)) 0x479300 &lt;testing::internal::UnitTestImpl::RunAllTests()&gt;, \n    location=0x487fd8 &quot;auxiliary test code (environments or event listeners)&quot;)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:2126\n#30 0x00000000004786be in testing::UnitTest::Run (this=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/test/gtest/src/gtest.cc:3874\n#31 0x000000000043afef in main (argc=1, argv=&lt;optimized out&gt;)\n    at /home/scpeters/osrf/gazebo_1.8/test/performance/transport_stress.cc:242\n\nThread 2 (Thread 0x7fe74a3e8700 (LWP 7090)):\n#0  0x00007fe75ca64353 in epoll_wait ()\n    at ../sysdeps/unix/syscall-template.S:82\n#1  0x00007fe75e4dfad4 in boost::asio::detail::epoll_reactor::run (\n    this=0x7fe73c5fa620, block=&lt;optimized out&gt;, ops=...)\n    at /usr/include/boost/asio/detail/impl/epoll_reactor.ipp:240\n#2  0x00007fe75e4e00f6 in do_one (this_idle_thread=&lt;optimized out&gt;, lock=..., \n    this=&lt;optimized out&gt;)\n    at /usr/include/boost/asio/detail/impl/task_io_service.ipp:264\n#3  boost::asio::detail::task_io_service::run (this=0x7fe73c5ecb90, ec=...)\n    at /usr/include/boost/asio/detail/impl/task_io_service.ipp:130\n#4  0x00007fe75e4e06a5 in boost::asio::io_service::run (this=0x7fe73c553800)\n    at /usr/include/boost/asio/impl/io_service.ipp:57\n#5  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#6  0x00007fe75e26ce9a in start_thread (arg=0x7fe74a3e8700)\n    at pthread_create.c:308\n#7  0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#8  0x0000000000000000 in ?? ()\n\nThread 1 (Thread 0x7fe73abff700 (LWP 7092)):\n#0  operator++ (this=&lt;optimized out&gt;)\n    at /usr/include/c++/4.6/bits/stl_list.h:234\n#1  __distance&lt;std::_List_const_iterator&lt;boost::shared_ptr&lt;gazebo::transport::Node&gt; &gt; &gt; (__last=..., __first=...)\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:82\n#2  distance&lt;std::_List_const_iterator&lt;boost::shared_ptr&lt;gazebo::transport::Node&gt; &gt; &gt; (__last=..., __first=...)\n    at /usr/include/c++/4.6/bits/stl_iterator_base_funcs.h:117\n#3  size (this=0x1c5d450) at /usr/include/c++/4.6/bits/stl_list.h:846\n#4  gazebo::transport::Publication::RemoveSubscription (this=0x1c5d420, \n    _host=..., _port=54692)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/Publication.cc:219\n#5  0x00007fe75e4ec214 in gazebo::transport::TopicManager::DisconnectPubFromSub\n    (this=&lt;optimized out&gt;, topic=..., host=..., port=54692)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/TopicManager.cc:273\n#6  0x00007fe75e4d593a in gazebo::transport::ConnectionManager::ProcessMessage\n    (this=&lt;optimized out&gt;, _data=...)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:430\n#7  0x00007fe75e4d673c in gazebo::transport::ConnectionManager::RunUpdate (\n    this=0x6a42e0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:263\n#8  0x00007fe75e4d7a22 in gazebo::transport::ConnectionManager::Run (\n    this=0x6a42e0)\n    at /home/scpeters/osrf/gazebo_1.8/gazebo/transport/ConnectionManager.cc:310\n#9  0x00007fe75d8e7ce9 in thread_proxy ()\n   from /usr/lib/libboost_thread.so.1.46.1\n#10 0x00007fe75e26ce9a in start_thread (arg=0x7fe73abff700)\n    at pthread_create.c:308\n#11 0x00007fe75ca63cbd in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#12 0x0000000000000000 in ?? ()\n(gdb) \n</pre></div>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2013-06-04T17:20:45.167626+00:00", "milestone": null, "updated_on": "2016-09-14T19:43:32.650559+00:00", "type": "issue", "id": 722}