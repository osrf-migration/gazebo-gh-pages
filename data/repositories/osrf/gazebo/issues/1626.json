{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1626/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1626.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1626/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1626/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1626/unit_timer_test-fails-on-os-x"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1626/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "UNIT_Timer_TEST fails on OS X", "component": {"name": "os::osx", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/126618.json"}}}, "votes": 0, "watches": 2, "content": {"raw": "The `UNIT_Timer_TEST` from pull request #1690 fails on OS X with tolerances that are fine on Ubuntu. Here's an example of the failed expectations:\r\n\r\n~~~\r\n79: [ RUN      ] TimerTest.Timer\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:41: Failure\r\n79: The difference between elapsed.nsec and 2e8 is 10075000, which exceeds 1e5, where\r\n79: elapsed.nsec evaluates to 210075000,\r\n79: 2e8 evaluates to 200000000, and\r\n79: 1e5 evaluates to 100000.\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:48: Failure\r\n79: The difference between elapsed.nsec and timer.GetElapsed().nsec is 276000, which exceeds 1e5, where\r\n79: elapsed.nsec evaluates to 210075000,\r\n79: timer.GetElapsed().nsec evaluates to 210351000, and\r\n79: 1e5 evaluates to 100000.\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:55: Failure\r\n79: The difference between timer.GetElapsed().nsec and 3e8 is 20427000, which exceeds 1e6, where\r\n79: timer.GetElapsed().nsec evaluates to 320427000,\r\n79: 3e8 evaluates to 300000000, and\r\n79: 1e6 evaluates to 1000000.\r\n79: [  FAILED  ] TimerTest.Timer (422 ms)\r\n79: [ RUN      ] TimerTest.CountdownTimer\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:78: Failure\r\n79: The difference between elapsed.nsec and 8e8 is 2854000, which exceeds 1e5, where\r\n79: elapsed.nsec evaluates to 797146000,\r\n79: 8e8 evaluates to 800000000, and\r\n79: 1e5 evaluates to 100000.\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:85: Failure\r\n79: The difference between elapsed.nsec and timer.GetElapsed().nsec is 206000, which exceeds 1e5, where\r\n79: elapsed.nsec evaluates to 797146000,\r\n79: timer.GetElapsed().nsec evaluates to 796940000, and\r\n79: 1e5 evaluates to 100000.\r\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:92: Failure\r\n79: The difference between timer.GetElapsed().nsec and 7e8 is 4907000, which exceeds 1e6, where\r\n79: timer.GetElapsed().nsec evaluates to 695093000,\r\n79: 7e8 evaluates to 700000000, and\r\n79: 1e6 evaluates to 1000000.\r\n79: [  FAILED  ] TimerTest.CountdownTimer (408 ms)\r\n~~~\r\n\r\nIt could be a bug in our `Time::MSleep` functions. The test is currently disabled for OSX.", "markup": "markdown", "html": "<p>The <code>UNIT_Timer_TEST</code> from <a href=\"#!/osrf/gazebo/pull-requests/1690/add-countdown-feature-to-common-timer\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #1690</a> fails on OS X with tolerances that are fine on Ubuntu. Here's an example of the failed expectations:</p>\n<div class=\"codehilite\"><pre><span></span>79: [ RUN      ] TimerTest.Timer\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:41: Failure\n79: The difference between elapsed.nsec and 2e8 is 10075000, which exceeds 1e5, where\n79: elapsed.nsec evaluates to 210075000,\n79: 2e8 evaluates to 200000000, and\n79: 1e5 evaluates to 100000.\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:48: Failure\n79: The difference between elapsed.nsec and timer.GetElapsed().nsec is 276000, which exceeds 1e5, where\n79: elapsed.nsec evaluates to 210075000,\n79: timer.GetElapsed().nsec evaluates to 210351000, and\n79: 1e5 evaluates to 100000.\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:55: Failure\n79: The difference between timer.GetElapsed().nsec and 3e8 is 20427000, which exceeds 1e6, where\n79: timer.GetElapsed().nsec evaluates to 320427000,\n79: 3e8 evaluates to 300000000, and\n79: 1e6 evaluates to 1000000.\n79: [  FAILED  ] TimerTest.Timer (422 ms)\n79: [ RUN      ] TimerTest.CountdownTimer\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:78: Failure\n79: The difference between elapsed.nsec and 8e8 is 2854000, which exceeds 1e5, where\n79: elapsed.nsec evaluates to 797146000,\n79: 8e8 evaluates to 800000000, and\n79: 1e5 evaluates to 100000.\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:85: Failure\n79: The difference between elapsed.nsec and timer.GetElapsed().nsec is 206000, which exceeds 1e5, where\n79: elapsed.nsec evaluates to 797146000,\n79: timer.GetElapsed().nsec evaluates to 796940000, and\n79: 1e5 evaluates to 100000.\n79: /Users/jenkins/workspace/gazebo-any-devel-homebrew-amd64/gazebo6/gazebo/common/Timer_TEST.cc:92: Failure\n79: The difference between timer.GetElapsed().nsec and 7e8 is 4907000, which exceeds 1e6, where\n79: timer.GetElapsed().nsec evaluates to 695093000,\n79: 7e8 evaluates to 700000000, and\n79: 1e6 evaluates to 1000000.\n79: [  FAILED  ] TimerTest.CountdownTimer (408 ms)\n</pre></div>\n\n\n<p>It could be a bug in our <code>Time::MSleep</code> functions. The test is currently disabled for OSX.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2015-06-03T00:41:22.463715+00:00", "milestone": null, "updated_on": "2016-10-19T15:22:17.266953+00:00", "type": "issue", "id": 1626}