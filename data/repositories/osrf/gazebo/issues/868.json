{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/868/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/868.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/868/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/868/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/868/setting-position-on-heightmap-creates"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/868/vote"}}, "reporter": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "title": "Setting position on heightmap creates offset between collision and visual", "component": {"name": "rendering", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/122881.json"}}}, "votes": 0, "watches": 1, "content": {"raw": "[Copyed from [answers.gazebosim.org](http://answers.gazebosim.org/question/4555/setting-position-on-heightmap-creates-offset/)]\r\n\r\nWhen I set a position in my sdf for my heightmap I get an offset between collision and visual for the map as shown in the snapshot below. If I move the objects around I can see that the collision of the map has an offset. I'm able to move the objects into the mountains etc. All objects are affected by this not only the ones in the example snapshot. When I set the y position in the collision and visual to 0 the offset is gone. This error is a new behaviour that wasn't there 2 month ago(I haven't changed anything on the sdf files since july) so this is probably a bug... I'm not sure when this behaviour first occured because I haven't worked with an heightmap for quite a while...\r\n\r\nI'm working with ubuntu precise and gazebo 1.9.1 from the osrf repository(not from source)\r\n\r\nSnapshot of the BUG:\r\n![](http://gsyc.es/~caguero/heightmap_offset.png)\r\n\r\nHere is the SDF for the heightmap:\r\n\r\n\r\n```\r\n#!c++\r\n\r\n<?xml version='1.0'?>\r\n<sdf version='1.4'>\r\n<model name=\"my_map\">\r\n  <static>true</static>\r\n  <link name=\"link\">\r\n    <collision name=\"collision\">\r\n      <geometry>\r\n        <heightmap>\r\n          <uri>file://path/to/image/terrain.png</uri>\r\n          <size>1500 1500 450</size>\r\n          <pos>0 -35 -71</pos>\r\n        </heightmap>\r\n      </geometry>\r\n    </collision>\r\n    <visual name=\"visual\">\r\n      <geometry>\r\n        <heightmap>\r\n          <texture>\r\n            <diffuse>file://path/to/image/GrassFrozen.png</diffuse>\r\n            <normal>file://path/to/image/flat_normal.png</normal>\r\n            <size>50</size>\r\n          </texture>\r\n          <texture>\r\n            <diffuse>file://path/to/image/Snow.png</diffuse>\r\n            <normal>file://path/to/image/flat_normal.png</normal>\r\n            <size>20</size>\r\n          </texture>\r\n          <texture>\r\n            <diffuse>file://path/to/image/RockRough.png</diffuse>\r\n            <normal>file://path/to/image/flat_normal.png</normal>\r\n            <size>80</size>\r\n          </texture>\r\n          <blend>\r\n            <min_height>-100</min_height>\r\n            <fade_dist>5</fade_dist>\r\n          </blend>\r\n          <blend>\r\n            <min_height>-50</min_height>\r\n            <fade_dist>5</fade_dist>\r\n          </blend>\r\n          <uri>file://path/to/image/terrain.png</uri>\r\n          <size>1500 1500 450</size>\r\n          <pos>0 -35 -71</pos>\r\n        </heightmap>\r\n      </geometry>\r\n    </visual>\r\n  </link>\r\n</model>\r\n\r\n</sdf>\r\n```", "markup": "markdown", "html": "<p>[Copyed from <a data-is-external-link=\"true\" href=\"http://answers.gazebosim.org/question/4555/setting-position-on-heightmap-creates-offset/\" rel=\"nofollow\">answers.gazebosim.org</a>]</p>\n<p>When I set a position in my sdf for my heightmap I get an offset between collision and visual for the map as shown in the snapshot below. If I move the objects around I can see that the collision of the map has an offset. I'm able to move the objects into the mountains etc. All objects are affected by this not only the ones in the example snapshot. When I set the y position in the collision and visual to 0 the offset is gone. This error is a new behaviour that wasn't there 2 month ago(I haven't changed anything on the sdf files since july) so this is probably a bug... I'm not sure when this behaviour first occured because I haven't worked with an heightmap for quite a while...</p>\n<p>I'm working with ubuntu precise and gazebo 1.9.1 from the osrf repository(not from source)</p>\n<p>Snapshot of the BUG:\n<img alt=\"\" src=\"http://gsyc.es/~caguero/heightmap_offset.png\" /></p>\n<p>Here is the SDF for the heightmap:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"o\">&lt;?</span><span class=\"n\">xml</span> <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"err\">&#39;</span><span class=\"mf\">1.0</span><span class=\"err\">&#39;</span><span class=\"o\">?&gt;</span>\n<span class=\"o\">&lt;</span><span class=\"n\">sdf</span> <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"err\">&#39;</span><span class=\"mf\">1.4</span><span class=\"err\">&#39;</span><span class=\"o\">&gt;</span>\n<span class=\"o\">&lt;</span><span class=\"n\">model</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s\">&quot;my_map&quot;</span><span class=\"o\">&gt;</span>\n  <span class=\"o\">&lt;</span><span class=\"k\">static</span><span class=\"o\">&gt;</span><span class=\"nb\">true</span><span class=\"o\">&lt;/</span><span class=\"k\">static</span><span class=\"o\">&gt;</span>\n  <span class=\"o\">&lt;</span><span class=\"n\">link</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s\">&quot;link&quot;</span><span class=\"o\">&gt;</span>\n    <span class=\"o\">&lt;</span><span class=\"n\">collision</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s\">&quot;collision&quot;</span><span class=\"o\">&gt;</span>\n      <span class=\"o\">&lt;</span><span class=\"n\">geometry</span><span class=\"o\">&gt;</span>\n        <span class=\"o\">&lt;</span><span class=\"n\">heightmap</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">uri</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/terrain.png&lt;/uri&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">size</span><span class=\"o\">&gt;</span><span class=\"mi\">1500</span> <span class=\"mi\">1500</span> <span class=\"mi\">450</span><span class=\"o\">&lt;/</span><span class=\"n\">size</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">pos</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span> <span class=\"o\">-</span><span class=\"mi\">35</span> <span class=\"o\">-</span><span class=\"mi\">71</span><span class=\"o\">&lt;/</span><span class=\"n\">pos</span><span class=\"o\">&gt;</span>\n        <span class=\"o\">&lt;/</span><span class=\"n\">heightmap</span><span class=\"o\">&gt;</span>\n      <span class=\"o\">&lt;/</span><span class=\"n\">geometry</span><span class=\"o\">&gt;</span>\n    <span class=\"o\">&lt;/</span><span class=\"n\">collision</span><span class=\"o\">&gt;</span>\n    <span class=\"o\">&lt;</span><span class=\"n\">visual</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s\">&quot;visual&quot;</span><span class=\"o\">&gt;</span>\n      <span class=\"o\">&lt;</span><span class=\"n\">geometry</span><span class=\"o\">&gt;</span>\n        <span class=\"o\">&lt;</span><span class=\"n\">heightmap</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">diffuse</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/GrassFrozen.png&lt;/diffuse&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">normal</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/flat_normal.png&lt;/normal&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">size</span><span class=\"o\">&gt;</span><span class=\"mi\">50</span><span class=\"o\">&lt;/</span><span class=\"n\">size</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;/</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">diffuse</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/Snow.png&lt;/diffuse&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">normal</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/flat_normal.png&lt;/normal&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">size</span><span class=\"o\">&gt;</span><span class=\"mi\">20</span><span class=\"o\">&lt;/</span><span class=\"n\">size</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;/</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">diffuse</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/RockRough.png&lt;/diffuse&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">normal</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/flat_normal.png&lt;/normal&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">size</span><span class=\"o\">&gt;</span><span class=\"mi\">80</span><span class=\"o\">&lt;/</span><span class=\"n\">size</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;/</span><span class=\"n\">texture</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">blend</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">min_height</span><span class=\"o\">&gt;-</span><span class=\"mi\">100</span><span class=\"o\">&lt;/</span><span class=\"n\">min_height</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">fade_dist</span><span class=\"o\">&gt;</span><span class=\"mi\">5</span><span class=\"o\">&lt;/</span><span class=\"n\">fade_dist</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;/</span><span class=\"n\">blend</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">blend</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">min_height</span><span class=\"o\">&gt;-</span><span class=\"mi\">50</span><span class=\"o\">&lt;/</span><span class=\"n\">min_height</span><span class=\"o\">&gt;</span>\n            <span class=\"o\">&lt;</span><span class=\"n\">fade_dist</span><span class=\"o\">&gt;</span><span class=\"mi\">5</span><span class=\"o\">&lt;/</span><span class=\"n\">fade_dist</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;/</span><span class=\"n\">blend</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">uri</span><span class=\"o\">&gt;</span><span class=\"nl\">file</span><span class=\"p\">:</span><span class=\"c1\">//path/to/image/terrain.png&lt;/uri&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">size</span><span class=\"o\">&gt;</span><span class=\"mi\">1500</span> <span class=\"mi\">1500</span> <span class=\"mi\">450</span><span class=\"o\">&lt;/</span><span class=\"n\">size</span><span class=\"o\">&gt;</span>\n          <span class=\"o\">&lt;</span><span class=\"n\">pos</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span> <span class=\"o\">-</span><span class=\"mi\">35</span> <span class=\"o\">-</span><span class=\"mi\">71</span><span class=\"o\">&lt;/</span><span class=\"n\">pos</span><span class=\"o\">&gt;</span>\n        <span class=\"o\">&lt;/</span><span class=\"n\">heightmap</span><span class=\"o\">&gt;</span>\n      <span class=\"o\">&lt;/</span><span class=\"n\">geometry</span><span class=\"o\">&gt;</span>\n    <span class=\"o\">&lt;/</span><span class=\"n\">visual</span><span class=\"o\">&gt;</span>\n  <span class=\"o\">&lt;/</span><span class=\"n\">link</span><span class=\"o\">&gt;</span>\n<span class=\"o\">&lt;/</span><span class=\"n\">model</span><span class=\"o\">&gt;</span>\n\n<span class=\"o\">&lt;/</span><span class=\"n\">sdf</span><span class=\"o\">&gt;</span>\n</pre></div>", "type": "rendered"}, "assignee": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2013-10-01T16:57:38.242553+00:00", "milestone": null, "updated_on": "2016-09-14T19:19:56.383237+00:00", "type": "issue", "id": 868}