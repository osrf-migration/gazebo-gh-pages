{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/716/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/716.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/716/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/716/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/716/gzlog-can-hang"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/716/vote"}}, "reporter": {"display_name": "Brian Gerkey", "uuid": "{3d8b5763-9dad-4be7-85c2-a7ab6cd49173}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d8b5763-9dad-4be7-85c2-a7ab6cd49173%7D"}, "html": {"href": "https://bitbucket.org/%7B3d8b5763-9dad-4be7-85c2-a7ab6cd49173%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:2e35028e-9ad8-4d6a-a3a5-275159a304a9/5fa9ec73-0fec-4860-a202-e34ae23b6a12/128"}}, "nickname": "Brian Gerkey", "type": "user", "account_id": "557058:2e35028e-9ad8-4d6a-a3a5-275159a304a9"}, "title": "gzlog can hang", "component": null, "votes": 0, "watches": 1, "content": {"raw": "Found a long-running `gzlog stop` process, attached with gdb, found this bt:\r\n\r\n~~~\r\nThread 8 (Thread 0x7f38c90dc700 (LWP 3869)):\r\n#0  0x00007f38dcd70d84 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007f38dde29e61 in ?? () from /usr/lib/libgazebo_common.so.1\r\n#2  0x00007f38dde2c194 in gazebo::common::ModelDatabase::UpdateModelCache(bool) () from /usr/lib/libgazebo_common.so.1\r\n#3  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\r\n#4  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#5  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#6  0x0000000000000000 in ?? ()\r\n\r\nThread 7 (Thread 0x7f38c88db700 (LWP 3870)):\r\n#0  0x00007f38db674363 in epoll_wait () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007f38dd836cb4 in ?? () from /usr/lib/libgazebo_transport.so.1\r\n#2  0x00007f38dd837424 in ?? () from /usr/lib/libgazebo_transport.so.1\r\n#3  0x00007f38dd8382e5 in boost::asio::io_service::run() () from /usr/lib/libgazebo_transport.so.1\r\n#4  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\r\n#5  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#6  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#7  0x0000000000000000 in ?? ()\r\n\r\nThread 6 (Thread 0x7f38c3df2700 (LWP 3871)):\r\n#0  0x00007f38dcd710fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007f38dd82f35e in gazebo::transport::ConnectionManager::Run() () from /usr/lib/libgazebo_transport.so.1\r\n#2  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\r\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 5 (Thread 0x7f38c31cf700 (LWP 3872)):\r\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 4 (Thread 0x7f38c2dce700 (LWP 3873)):\r\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 3 (Thread 0x7f38c29cd700 (LWP 3874)):\r\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n---Type <return> to continue, or q <return> to quit---\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 2 (Thread 0x7f38c25cc700 (LWP 3875)):\r\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\r\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\r\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\r\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\r\n#5  0x0000000000000000 in ?? ()\r\n\r\nThread 1 (Thread 0x7f38de234840 (LWP 3868)):\r\n#0  0x00007f38dcd7452d in nanosleep () from /lib/x86_64-linux-gnu/libpthread.so.0\r\n#1  0x00007f38dde4696d in gazebo::common::Time::Sleep(gazebo::common::Time const&) () from /usr/lib/libgazebo_common.so.1\r\n#2  0x00007f38dde46eb3 in gazebo::common::Time::MSleep(unsigned int) () from /usr/lib/libgazebo_common.so.1\r\n#3  0x00007f38dd84108d in gazebo::transport::Publisher::WaitForConnection() const () from /usr/lib/libgazebo_transport.so.1\r\n#4  0x0000000000424acd in record(bool) ()\r\n#5  0x0000000000420c18 in main ()\r\n~~~\r\n\r\nBecause `gzlog` was still running, `start_sim.bash` was stuck in a task shutdown.\r\n\r\nKilling the `gzlog` process (with the default TERM) allowed `stop_sim.bash` to complete.", "markup": "markdown", "html": "<p>Found a long-running <code>gzlog stop</code> process, attached with gdb, found this bt:</p>\n<div class=\"codehilite\"><pre><span></span>Thread 8 (Thread 0x7f38c90dc700 (LWP 3869)):\n#0  0x00007f38dcd70d84 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\n#1  0x00007f38dde29e61 in ?? () from /usr/lib/libgazebo_common.so.1\n#2  0x00007f38dde2c194 in gazebo::common::ModelDatabase::UpdateModelCache(bool) () from /usr/lib/libgazebo_common.so.1\n#3  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\n#4  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#5  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#6  0x0000000000000000 in ?? ()\n\nThread 7 (Thread 0x7f38c88db700 (LWP 3870)):\n#0  0x00007f38db674363 in epoll_wait () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f38dd836cb4 in ?? () from /usr/lib/libgazebo_transport.so.1\n#2  0x00007f38dd837424 in ?? () from /usr/lib/libgazebo_transport.so.1\n#3  0x00007f38dd8382e5 in boost::asio::io_service::run() () from /usr/lib/libgazebo_transport.so.1\n#4  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\n#5  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#6  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#7  0x0000000000000000 in ?? ()\n\nThread 6 (Thread 0x7f38c3df2700 (LWP 3871)):\n#0  0x00007f38dcd710fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0\n#1  0x00007f38dd82f35e in gazebo::transport::ConnectionManager::Run() () from /usr/lib/libgazebo_transport.so.1\n#2  0x00007f38db373ce9 in thread_proxy () from /usr/lib/libboost_thread.so.1.46.1\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#5  0x0000000000000000 in ?? ()\n\nThread 5 (Thread 0x7f38c31cf700 (LWP 3872)):\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#5  0x0000000000000000 in ?? ()\n\nThread 4 (Thread 0x7f38c2dce700 (LWP 3873)):\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#5  0x0000000000000000 in ?? ()\n\nThread 3 (Thread 0x7f38c29cd700 (LWP 3874)):\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#5  0x0000000000000000 in ?? ()\n\nThread 2 (Thread 0x7f38c25cc700 (LWP 3875)):\n#0  0x00007f38db66fee9 in syscall () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f38d97b2293 in ?? () from /usr/lib/libtbb.so.2\n#2  0x00007f38d97b22c9 in ?? () from /usr/lib/libtbb.so.2\n#3  0x00007f38dcd6ce9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#4  0x00007f38db673ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#5  0x0000000000000000 in ?? ()\n\nThread 1 (Thread 0x7f38de234840 (LWP 3868)):\n#0  0x00007f38dcd7452d in nanosleep () from /lib/x86_64-linux-gnu/libpthread.so.0\n#1  0x00007f38dde4696d in gazebo::common::Time::Sleep(gazebo::common::Time const&amp;) () from /usr/lib/libgazebo_common.so.1\n#2  0x00007f38dde46eb3 in gazebo::common::Time::MSleep(unsigned int) () from /usr/lib/libgazebo_common.so.1\n#3  0x00007f38dd84108d in gazebo::transport::Publisher::WaitForConnection() const () from /usr/lib/libgazebo_transport.so.1\n#4  0x0000000000424acd in record(bool) ()\n#5  0x0000000000420c18 in main ()\n</pre></div>\n\n\n<p>Because <code>gzlog</code> was still running, <code>start_sim.bash</code> was stuck in a task shutdown.</p>\n<p>Killing the <code>gzlog</code> process (with the default TERM) allowed <code>stop_sim.bash</code> to complete.</p>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2013-06-03T14:55:16.439963+00:00", "milestone": null, "updated_on": "2016-09-14T19:45:07.075532+00:00", "type": "issue", "id": 716}