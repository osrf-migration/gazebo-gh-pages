{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294/comments/37409219.json"}, "html": {"href": "#!/osrf/gazebo/issues/2294#comment-37409219"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294.json"}}, "type": "issue", "id": 2294, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "PID controller broken with non-default max_step_size"}, "content": {"raw": null, "markup": "markdown", "html": "", "type": "rendered"}, "created_on": "2017-06-06T16:32:16.888216+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 37409219}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294/comments/37409240.json"}, "html": {"href": "#!/osrf/gazebo/issues/2294#comment-37409240"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294.json"}}, "type": "issue", "id": 2294, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "PID controller broken with non-default max_step_size"}, "content": {"raw": "How are the PID controllers implemented? Are you using a ModelPlugin?", "markup": "markdown", "html": "<p>How are the PID controllers implemented? Are you using a ModelPlugin?</p>", "type": "rendered"}, "created_on": "2017-06-06T16:33:14.038467+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 37409240}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294/comments/37409602.json"}, "html": {"href": "#!/osrf/gazebo/issues/2294#comment-37409602"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294.json"}}, "type": "issue", "id": 2294, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "PID controller broken with non-default max_step_size"}, "content": {"raw": "For implementation, I do inherit ModelPlugin. I use common::PID; I haven't implemented my own. I include these two lines in the Load method:\n\n```\n#!c++\n\n        this->pid = common::PID(40, 0, 0);\n        this->model->GetJointController()->SetVelocityPID(this->joint->GetScopedName(), this->pid);\n```\n\nDuring the update method (subscribed with ConnectWorldBeginUpdate), I do this:\n\n```\n#!c++\n\n        this->model->GetJointController()->SetVelocityTarget(this->joint->GetScopedName(), vel_rad_sec);\n```\n\nwhere vel_rad_sec ranges -10 to 10.", "markup": "markdown", "html": "<p>For implementation, I do inherit ModelPlugin. I use common::PID; I haven't implemented my own. I include these two lines in the Load method:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>        <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">pid</span> <span class=\"o\">=</span> <span class=\"n\">common</span><span class=\"o\">::</span><span class=\"n\">PID</span><span class=\"p\">(</span><span class=\"mi\">40</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n        <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">model</span><span class=\"o\">-&gt;</span><span class=\"n\">GetJointController</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">SetVelocityPID</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">joint</span><span class=\"o\">-&gt;</span><span class=\"n\">GetScopedName</span><span class=\"p\">(),</span> <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">pid</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>During the update method (subscribed with ConnectWorldBeginUpdate), I do this:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>        <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">model</span><span class=\"o\">-&gt;</span><span class=\"n\">GetJointController</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">SetVelocityTarget</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">joint</span><span class=\"o\">-&gt;</span><span class=\"n\">GetScopedName</span><span class=\"p\">(),</span> <span class=\"n\">vel_rad_sec</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>where vel_rad_sec ranges -10 to 10.</p>", "type": "rendered"}, "created_on": "2017-06-06T16:49:08.759510+00:00", "user": {"display_name": "Brannon King", "uuid": "{3ca32111-9d7e-43e2-889d-573ee5947113}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3ca32111-9d7e-43e2-889d-573ee5947113%7D"}, "html": {"href": "https://bitbucket.org/%7B3ca32111-9d7e-43e2-889d-573ee5947113%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d8540673c67cfdaa5c756423a1385ffdd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsBK-1.png"}}, "nickname": "brannonking", "type": "user", "account_id": "557058:04241785-a8ac-455f-9aef-7713c5e053e6"}, "updated_on": null, "type": "issue_comment", "id": 37409602}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294/comments/37439426.json"}, "html": {"href": "#!/osrf/gazebo/issues/2294#comment-37439426"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294.json"}}, "type": "issue", "id": 2294, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "PID controller broken with non-default max_step_size"}, "content": {"raw": "Looking at the [JointController::Update](#!/osrf/gazebo/src/42215f2019f5ae64fc8a0610ef804a0fc53b0740/gazebo/physics/JointController.cc?fileviewer=file-view-default#JointController.cc-112) function, it looks to me like the code is not assuming a time step size, but is inferring it by repeatedly calling `World::GetSimTime`. If you are having problems with `inf` and `nan`, I don't think it is directly coming from the PID calculation.\n\nIt could be that the solver is simply unstable with that combination of gains and timestep, or that the solver is not converging with the specified parameters. Can you try increasing the solver iterations and/or setting the SOR parameter to 1.0?", "markup": "markdown", "html": "<p>Looking at the <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/42215f2019f5ae64fc8a0610ef804a0fc53b0740/gazebo/physics/JointController.cc?fileviewer=file-view-default#JointController.cc-112\" rel=\"nofollow\">JointController::Update</a> function, it looks to me like the code is not assuming a time step size, but is inferring it by repeatedly calling <code>World::GetSimTime</code>. If you are having problems with <code>inf</code> and <code>nan</code>, I don't think it is directly coming from the PID calculation.</p>\n<p>It could be that the solver is simply unstable with that combination of gains and timestep, or that the solver is not converging with the specified parameters. Can you try increasing the solver iterations and/or setting the SOR parameter to 1.0?</p>", "type": "rendered"}, "created_on": "2017-06-07T17:37:53.453074+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 37439426}, {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294/comments/37466513.json"}, "html": {"href": "#!/osrf/gazebo/issues/2294#comment-37466513"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/2294.json"}}, "type": "issue", "id": 2294, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "PID controller broken with non-default max_step_size"}, "content": {"raw": "I tried iters at 20, 200, and 1200 with SOR at 1.0. I saw the error in all three situations.", "markup": "markdown", "html": "<p>I tried iters at 20, 200, and 1200 with SOR at 1.0. I saw the error in all three situations.</p>", "type": "rendered"}, "created_on": "2017-06-08T16:53:37.446040+00:00", "user": {"display_name": "Brannon King", "uuid": "{3ca32111-9d7e-43e2-889d-573ee5947113}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3ca32111-9d7e-43e2-889d-573ee5947113%7D"}, "html": {"href": "https://bitbucket.org/%7B3ca32111-9d7e-43e2-889d-573ee5947113%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d8540673c67cfdaa5c756423a1385ffdd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsBK-1.png"}}, "nickname": "brannonking", "type": "user", "account_id": "557058:04241785-a8ac-455f-9aef-7713c5e053e6"}, "updated_on": null, "type": "issue_comment", "id": 37466513}], "page": 1, "size": 5}