{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1124/comments/11367648.json"}, "html": {"href": "#!/osrf/gazebo/issues/1124#comment-11367648"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1124.json"}}, "type": "issue", "id": 1124, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Collision WorldPose does not get updated."}, "content": {"raw": "The issue still appears for models with multiple links. I have installed gazebo from default (currently version 4.0.0).\n\nI am using for testing a [model](http://pastebin.com/h58N9WBY) with 2 links. First link has 2 collision, second link 1 collision:\n\n* model: *model_box*\n* * link1: *link_green_blue*\n* * * collision1: *collision_green*\n* * * collision2: *collision_blue*\n* * link2: *link_orange*\n* * * collision1: *collision_orange*\n\nThe second collision doesn't get updated. Only when manually moving it with the mouse, and then only for one iteration.\n\nTesting code:\n\n\n```\n#!c++\n\t// DEBUG collision issue\n\tphysics::ModelPtr box = this->world->GetModel(\"box\");\n\n\tstd::cout << \"model name: '\" << box2->GetName()\n\t\t\t<< \"' --> world pos: \" << box2->GetWorldPose().pos << std::endl;\n\n\t// get all links from the model\n\tphysics::Link_V _links = box2->GetLinks();\n\n\t// iterate through all the links\n\tfor (physics::Link_V::iterator l_iter = _links.begin();\n\t\t\tl_iter != _links.end(); ++l_iter)\n\t{\n\t\t// get all collisions of the link\n\t\tphysics::Collision_V _collisions = l_iter->get()->GetCollisions();\n\n\t\tstd::cout << \"\\t link name: '\" << l_iter->get()->GetName()\n\t\t\t\t<< \"' --> world pos: \" << l_iter->get()->GetWorldPose().pos << std::endl;\n\n\t\t// iterate through all the collisions\n\t\tfor (physics::Collision_V::iterator c_iter = _collisions.begin();\n\t\t\t\tc_iter != _collisions.end(); ++c_iter)\n\t\t{\n\t\t\tstd::cout << \"\\t\\t collision name: '\" << c_iter->get()->GetName()\n\t\t\t\t\t<< \"' --> world pos: \" << c_iter->get()->GetWorldPose().pos << std::endl;\n\t\t}\n\t}\n\n```\nScreenshot with the terminal output:\n![collision_issue.png](data/bitbucket.org/repo/jgXqbo/images/2966386764-collision_issue.png)\n", "markup": "markdown", "html": "<p>The issue still appears for models with multiple links. I have installed gazebo from default (currently version 4.0.0).</p>\n<p>I am using for testing a <a data-is-external-link=\"true\" href=\"http://pastebin.com/h58N9WBY\" rel=\"nofollow\">model</a> with 2 links. First link has 2 collision, second link 1 collision:</p>\n<ul>\n<li>model: <em>model_box</em></li>\n<li>\n<ul>\n<li>link1: <em>link_green_blue</em></li>\n</ul>\n</li>\n<li>\n<ul>\n<li>\n<ul>\n<li>collision1: <em>collision_green</em></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>\n<ul>\n<li>collision2: <em>collision_blue</em></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>link2: <em>link_orange</em></li>\n</ul>\n</li>\n<li>\n<ul>\n<li>\n<ul>\n<li>collision1: <em>collision_orange</em></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>The second collision doesn't get updated. Only when manually moving it with the mouse, and then only for one iteration.</p>\n<p>Testing code:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>    <span class=\"c1\">// DEBUG collision issue</span>\n    <span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">ModelPtr</span> <span class=\"n\">box</span> <span class=\"o\">=</span> <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">world</span><span class=\"o\">-&gt;</span><span class=\"n\">GetModel</span><span class=\"p\">(</span><span class=\"s\">&quot;box&quot;</span><span class=\"p\">);</span>\n\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;model name: &#39;&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">box2</span><span class=\"o\">-&gt;</span><span class=\"n\">GetName</span><span class=\"p\">()</span>\n            <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;&#39; --&gt; world pos: &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">box2</span><span class=\"o\">-&gt;</span><span class=\"n\">GetWorldPose</span><span class=\"p\">().</span><span class=\"n\">pos</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\n    <span class=\"c1\">// get all links from the model</span>\n    <span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Link_V</span> <span class=\"n\">_links</span> <span class=\"o\">=</span> <span class=\"n\">box2</span><span class=\"o\">-&gt;</span><span class=\"n\">GetLinks</span><span class=\"p\">();</span>\n\n    <span class=\"c1\">// iterate through all the links</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Link_V</span><span class=\"o\">::</span><span class=\"n\">iterator</span> <span class=\"n\">l_iter</span> <span class=\"o\">=</span> <span class=\"n\">_links</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">();</span>\n            <span class=\"n\">l_iter</span> <span class=\"o\">!=</span> <span class=\"n\">_links</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">();</span> <span class=\"o\">++</span><span class=\"n\">l_iter</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"c1\">// get all collisions of the link</span>\n        <span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Collision_V</span> <span class=\"n\">_collisions</span> <span class=\"o\">=</span> <span class=\"n\">l_iter</span><span class=\"o\">-&gt;</span><span class=\"n\">get</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">GetCollisions</span><span class=\"p\">();</span>\n\n        <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;</span><span class=\"se\">\\t</span><span class=\"s\"> link name: &#39;&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">l_iter</span><span class=\"o\">-&gt;</span><span class=\"n\">get</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">GetName</span><span class=\"p\">()</span>\n                <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;&#39; --&gt; world pos: &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">l_iter</span><span class=\"o\">-&gt;</span><span class=\"n\">get</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">GetWorldPose</span><span class=\"p\">().</span><span class=\"n\">pos</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n\n        <span class=\"c1\">// iterate through all the collisions</span>\n        <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Collision_V</span><span class=\"o\">::</span><span class=\"n\">iterator</span> <span class=\"n\">c_iter</span> <span class=\"o\">=</span> <span class=\"n\">_collisions</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">();</span>\n                <span class=\"n\">c_iter</span> <span class=\"o\">!=</span> <span class=\"n\">_collisions</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">();</span> <span class=\"o\">++</span><span class=\"n\">c_iter</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;</span><span class=\"se\">\\t\\t</span><span class=\"s\"> collision name: &#39;&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">c_iter</span><span class=\"o\">-&gt;</span><span class=\"n\">get</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">GetName</span><span class=\"p\">()</span>\n                    <span class=\"o\">&lt;&lt;</span> <span class=\"s\">&quot;&#39; --&gt; world pos: &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">c_iter</span><span class=\"o\">-&gt;</span><span class=\"n\">get</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"n\">GetWorldPose</span><span class=\"p\">().</span><span class=\"n\">pos</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>Screenshot with the terminal output:\n<img alt=\"collision_issue.png\" src=\"data/bitbucket.org/repo/jgXqbo/images/2966386764-collision_issue.png\" /></p>", "type": "rendered"}, "created_on": "2014-07-22T10:52:51.876031+00:00", "user": {"display_name": "Andrei Haidu", "uuid": "{825ae8d9-4737-437d-9090-c0b932f32bf2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B825ae8d9-4737-437d-9090-c0b932f32bf2%7D"}, "html": {"href": "https://bitbucket.org/%7B825ae8d9-4737-437d-9090-c0b932f32bf2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1a5e83c62729680f092d723cd0bf4c57d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsAH-4.png"}}, "nickname": "ahaidu", "type": "user", "account_id": "557058:7ed02d0b-401c-4f0c-8500-f87172d5477d"}, "updated_on": null, "type": "issue_comment", "id": 11367648}