{"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1032/comments/8423097.json"}, "html": {"href": "#!/osrf/gazebo/issues/1032#comment-8423097"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/gazebo/issues/1032.json"}}, "type": "issue", "id": 1032, "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "title": "Gazebo fails to start when compiled with visibility=hidden"}, "content": {"raw": "Thanks @scpeters . I've continued my research.\n\nWhen using the *visibility=hidden* by default the method ```TopicManager::ConnectPubToSub``` behaves different than when not using this compiler option.\n\nIn particular, the line:\n```\n  PublicationPtr publication = this->FindPublication(_topic);\n```\n_topic has the value of ```/gazebo/default/request``` and ```FindPublication``` is returning an empty PublicationPtr, so publication pointer is really invalid and the boost assertion is triggered in the line below.\n\nI've fixed some obscure macro generation in c5c215e and 48a9008 but the problem still exists.\n\nAnother way of triggering the bug is:\n\n```\n#!bash\n\ngzserver &\ngztopic echo /gazebo/default/request\n```\n", "markup": "markdown", "html": "<p>Thanks @scpeters . I've continued my research.</p>\n<p>When using the <em>visibility=hidden</em> by default the method <code>TopicManager::ConnectPubToSub</code> behaves different than when not using this compiler option.</p>\n<p>In particular, the line:</p>\n<div class=\"codehilite\"><pre><span></span>  PublicationPtr publication = this-&gt;FindPublication(_topic);\n</pre></div>\n\n\n<p>_topic has the value of <code>/gazebo/default/request</code> and <code>FindPublication</code> is returning an empty PublicationPtr, so publication pointer is really invalid and the boost assertion is triggered in the line below.</p>\n<p>I've fixed some obscure macro generation in <a href=\"#!/osrf/gazebo/commits/c5c215e\" rel=\"nofollow\" class=\"ap-connect-link\">c5c215e</a> and <a href=\"#!/osrf/gazebo/commits/48a9008\" rel=\"nofollow\" class=\"ap-connect-link\">48a9008</a> but the problem still exists.</p>\n<p>Another way of triggering the bug is:</p>\n<div class=\"codehilite language-bash\"><pre><span></span>gzserver <span class=\"p\">&amp;</span>\ngztopic <span class=\"nb\">echo</span> /gazebo/default/request\n</pre></div>", "type": "rendered"}, "created_on": "2014-02-17T00:38:25.082954+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": "2014-02-17T00:42:53.263506+00:00", "type": "issue_comment", "id": 8423097}