{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1102/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1102.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1102/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1102/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1102/tutorials-19-custom_messages-issue"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1102/vote"}}, "reporter": {"display_name": "Max Sporyshev", "uuid": "{cb898fcc-a76c-42fd-9d24-13d08160fa7e}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bcb898fcc-a76c-42fd-9d24-13d08160fa7e%7D"}, "html": {"href": "https://bitbucket.org/%7Bcb898fcc-a76c-42fd-9d24-13d08160fa7e%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/bf3767bca8771268145497502edfeba2d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMS-1.png"}}, "nickname": "msporyshev", "type": "user", "account_id": "557058:559fc3f3-6c92-447f-8fdf-7dc1f5643530"}, "title": "Tutorials/1.9/custom_messages issue", "component": {"name": "documentation", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/141921.json"}}}, "votes": 0, "watches": 3, "content": {"raw": "When I was creating custom messages for my project I faced with an issue in this tutorial http://gazebosim.org/wiki/Tutorials/1.9/custom_messages. I caught a bug becase of this lines in CMakeLists.txt.\r\n\r\n\r\n```\r\n#!c++\r\n\r\n\r\n\r\nset (msgs\r\n  collision_map_request.proto\r\n  ${PROTOBUF_IMPORT_DIRS}/vector2d.proto\r\n  ${PROTOBUF_IMPORT_DIRS}/header.proto\r\n  ${PROTOBUF_IMPORT_DIRS}/time.proto\r\n)\r\nPROTOBUF_GENERATE_CPP(PROTO_SRCS PROTO_HDRS ${msgs})\r\nadd_library(collision_map_creator_msgs SHARED ${PROTO_SRCS})\r\ntarget_link_libraries(collision_map_creator_msgs ${PROTOBUF_LIBRARY})\r\n```\r\nAfter building my project with this message and executing it I've got such an error: \r\n\r\n\r\n\r\n```\r\n#!\r\n\r\n[libprotobuf ERROR google/protobuf/descriptor_database.cc:57] File already exists in database: time.proto\r\n[libprotobuf FATAL google/protobuf/descriptor.cc:954] CHECK failed: generated_database_->Add(encoded_file_descriptor, size): \r\nlibc++abi.dylib: terminating with uncaught exception of type google::protobuf::FatalException: CHECK failed: generated_database_->Add(encoded_file_descriptor, size): \r\n```\r\nFixed this by adding ${GAZEBO_LIBRARIES} to target_link_libraries for collision_map_creator_msgs and switching from ${PROTO_SRCS} to collision_map_request.pb.cc", "markup": "markdown", "html": "<p>When I was creating custom messages for my project I faced with an issue in this tutorial <a href=\"http://gazebosim.org/wiki/Tutorials/1.9/custom_messages\" rel=\"nofollow\" class=\"ap-connect-link\">http://gazebosim.org/wiki/Tutorials/1.9/custom_messages</a>. I caught a bug becase of this lines in CMakeLists.txt.</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"n\">set</span> <span class=\"p\">(</span><span class=\"n\">msgs</span>\n  <span class=\"n\">collision_map_request</span><span class=\"p\">.</span><span class=\"n\">proto</span>\n  <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">PROTOBUF_IMPORT_DIRS</span><span class=\"p\">}</span><span class=\"o\">/</span><span class=\"n\">vector2d</span><span class=\"p\">.</span><span class=\"n\">proto</span>\n  <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">PROTOBUF_IMPORT_DIRS</span><span class=\"p\">}</span><span class=\"o\">/</span><span class=\"n\">header</span><span class=\"p\">.</span><span class=\"n\">proto</span>\n  <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">PROTOBUF_IMPORT_DIRS</span><span class=\"p\">}</span><span class=\"o\">/</span><span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">proto</span>\n<span class=\"p\">)</span>\n<span class=\"n\">PROTOBUF_GENERATE_CPP</span><span class=\"p\">(</span><span class=\"n\">PROTO_SRCS</span> <span class=\"n\">PROTO_HDRS</span> <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">msgs</span><span class=\"p\">})</span>\n<span class=\"n\">add_library</span><span class=\"p\">(</span><span class=\"n\">collision_map_creator_msgs</span> <span class=\"n\">SHARED</span> <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">PROTO_SRCS</span><span class=\"p\">})</span>\n<span class=\"n\">target_link_libraries</span><span class=\"p\">(</span><span class=\"n\">collision_map_creator_msgs</span> <span class=\"err\">$</span><span class=\"p\">{</span><span class=\"n\">PROTOBUF_LIBRARY</span><span class=\"p\">})</span>\n</pre></div>\n\n\n<p>After building my project with this message and executing it I've got such an error: </p>\n<div class=\"codehilite\"><pre><span></span>[libprotobuf ERROR google/protobuf/descriptor_database.cc:57] File already exists in database: time.proto\n[libprotobuf FATAL google/protobuf/descriptor.cc:954] CHECK failed: generated_database_-&gt;Add(encoded_file_descriptor, size): \nlibc++abi.dylib: terminating with uncaught exception of type google::protobuf::FatalException: CHECK failed: generated_database_-&gt;Add(encoded_file_descriptor, size): \n</pre></div>\n\n\n<p>Fixed this by adding ${GAZEBO_LIBRARIES} to target_link_libraries for collision_map_creator_msgs and switching from ${PROTO_SRCS} to collision_map_request.pb.cc</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "2.0", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/51082.json"}}}, "edited_on": null, "created_on": "2014-03-13T05:14:34.855817+00:00", "milestone": null, "updated_on": "2015-08-02T17:51:11.082202+00:00", "type": "issue", "id": 1102}