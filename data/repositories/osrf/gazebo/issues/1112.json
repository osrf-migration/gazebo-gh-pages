{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1112/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1112.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1112/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1112/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1112/sensor-destructor-are-never-called-after"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1112/vote"}}, "reporter": {"display_name": "Silvio Traversaro", "uuid": "{34f404cb-5642-4f27-a032-e04c7143d776}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D"}, "html": {"href": "https://bitbucket.org/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6/578caaa1-056c-45a2-8bf9-bee94c3bebef/128"}}, "nickname": "traversaro", "type": "user", "account_id": "557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6"}, "title": "Sensor destructor are never called after Model removal", "component": null, "votes": 5, "watches": 7, "content": {"raw": "Apparently (tried on current default with some prints) Joint (and Link) destructors methods are never called when the corresponding Model is removed from the simulation. \r\n\r\nIs this the intended behaviour?\r\n\r\nWe became aware of this issue because we have some sensor plugins that opened some connections, and we had crashes when exiting. \r\n\r\nApparently the sensor plugins that are child of Link elements close correctly because they are removed in the Link::Fini() method [1] that is properly called, while the sensor plugins that are child of Joint elements don't close correctly because they should be removed in Joint destructor [2], that is never called.\r\n\r\nIf this is the intended behaviour, it is then difficult to handle connection in joint-sensor plugins, because there is no place in which to close the opened connections. \r\n\r\n\r\n[1] : #!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Link.cc?at=default#cl-256\r\n\r\n[2] : #!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Joint.cc?at=default#cl-81", "markup": "markdown", "html": "<p>Apparently (tried on current default with some prints) Joint (and Link) destructors methods are never called when the corresponding Model is removed from the simulation. </p>\n<p>Is this the intended behaviour?</p>\n<p>We became aware of this issue because we have some sensor plugins that opened some connections, and we had crashes when exiting. </p>\n<p>Apparently the sensor plugins that are child of Link elements close correctly because they are removed in the Link::Fini() method [1] that is properly called, while the sensor plugins that are child of Joint elements don't close correctly because they should be removed in Joint destructor [2], that is never called.</p>\n<p>If this is the intended behaviour, it is then difficult to handle connection in joint-sensor plugins, because there is no place in which to close the opened connections. </p>\n<p>[1] : <a href=\"#!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Link.cc?at=default#cl-256\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Link.cc?at=default#cl-256</a></p>\n<p>[2] : <a href=\"#!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Joint.cc?at=default#cl-81\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/gazebo/src/399a916b9ae4d64b1c570209a9b7eb889466d795/gazebo/physics/Joint.cc?at=default#cl-81</a></p>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "3.0", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/100247.json"}}}, "edited_on": null, "created_on": "2014-03-19T10:02:16.126468+00:00", "milestone": null, "updated_on": "2016-09-14T19:45:36.824329+00:00", "type": "issue", "id": 1112}