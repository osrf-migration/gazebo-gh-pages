{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/1833/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/1833.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1833/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/1833/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/1833/nested-models-not-working-with-dart"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/1833/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "Nested models not working with dart", "component": {"name": "physics::DARTPhysics", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/139387.json"}}}, "votes": 0, "watches": 4, "content": {"raw": "Nested models were added by pull request #1868 with an example world ([worlds/nested_model.world](#!/osrf/gazebo/src/0bcccacf92920d3173b3ea06ed5fbbc1feb2240f/worlds/nested_model.world?at=default&fileviewer=file-view-default)) and a test ([INTEGRATION_nested_model](#!/osrf/gazebo/src/0bcccacf92920d3173b3ea06ed5fbbc1feb2240f/test/integration/nested_model.cc?at=default&fileviewer=file-view-default)) that currently passes. The test with that world remains paused for the duration of the test, which hides the fact that DART will crash when running that world unpaused. The recent pull request #2085 added `nested_model.world` to the `INTEGRATION_world_reset` test, which is now failing for dart. We should probably disable that test for now.\r\n\r\n~~~\r\n$ gdb gzserver\r\n...\r\n(gdb) r worlds/nested_model.world -e dart --verbose\r\n...\r\nGazebo multi-robot simulator, version 7.0.1\r\nCopyright (C) 2012-2015 Open Source Robotics Foundation.\r\nReleased under the Apache 2 License.\r\nhttp://gazebosim.org\r\n\r\n[Msg] Waiting for master.\r\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\r\n[Msg] Publicized address: 172.23.2.91\r\n...\r\nThe collision detector already has a collision node for body node [link_01].\r\n[New Thread 0x7fff977fc700 (LWP 31762)]\r\n[New Thread 0x7fff96ffb700 (LWP 31763)]\r\n[New Thread 0x7fff967fa700 (LWP 31764)]\r\n[New Thread 0x7fff95ff9700 (LWP 31765)]\r\n***** Internal Program Error - assertion (dartLink2.get() != __null) failed in virtual void gazebo::physics::DARTPhysics::UpdateCollision():\r\n/data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc(156): dartLink2 in collision pare is NULL\r\n\r\nProgram received signal SIGABRT, Aborted.\r\n[Switching to Thread 0x7fff967fa700 (LWP 31764)]\r\n0x00007ffff68bbcc9 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\r\n56\t../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\r\n(gdb)\r\n~~~\r\n\r\n~~~\r\n(gdb) bt\r\n#0  0x00007ffff68bbcc9 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\r\n#1  0x00007ffff68bf0d8 in __GI_abort () at abort.c:89\r\n#2  0x00007ffff61b4556 in boost::assertion::detail::assertion_failed_msg (expr=expr@entry=0x7ffff63338cb \"dartLink2.get() != __null\", \r\n    msg=msg@entry=0x7ffff6333810 \"dartLink2 in collision pare is NULL\", \r\n    function=function@entry=0x7ffff63350c0 <gazebo::physics::DARTPhysics::UpdateCollision()::__PRETTY_FUNCTION__> \"virtual void gazebo::physics::DARTPhysics::UpdateCollision()\", \r\n    file=file@entry=0x7ffff6333768 \"/data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc\", \r\n    line=line@entry=156) at /usr/include/boost/assert.hpp:108\r\n#3  0x00007ffff622b963 in gazebo::physics::DARTPhysics::UpdateCollision (this=0x17e6c20)\r\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc:156\r\n#4  0x00007ffff62f0ec2 in gazebo::physics::World::Update (this=this@entry=0xcedf30)\r\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:750\r\n#5  0x00007ffff62fda4b in gazebo::physics::World::Step (this=this@entry=0xcedf30)\r\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:672\r\n#6  0x00007ffff62fde7d in gazebo::physics::World::RunLoop (this=0xcedf30)\r\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:481\r\n#7  0x00007ffff42dca4a in ?? () from /usr/lib/x86_64-linux-gnu/libboost_thread.so.1.54.0\r\n#8  0x00007ffff55a9182 in start_thread (arg=0x7fff967fa700) at pthread_create.c:312\r\n#9  0x00007ffff697f47d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\r\n~~~\r\n\r\nThis is with gazebo's default branch using dart 4.3.5 debian from the PPA.", "markup": "markdown", "html": "<p>Nested models were added by <a href=\"#!/osrf/gazebo/pull-requests/1868/nested-model-part-1\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #1868</a> with an example world (<a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/0bcccacf92920d3173b3ea06ed5fbbc1feb2240f/worlds/nested_model.world?at=default&amp;fileviewer=file-view-default\" rel=\"nofollow\">worlds/nested_model.world</a>) and a test (<a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/0bcccacf92920d3173b3ea06ed5fbbc1feb2240f/test/integration/nested_model.cc?at=default&amp;fileviewer=file-view-default\" rel=\"nofollow\">INTEGRATION_nested_model</a>) that currently passes. The test with that world remains paused for the duration of the test, which hides the fact that DART will crash when running that world unpaused. The recent <a href=\"#!/osrf/gazebo/pull-requests/2085/add-followerplugin-for-ftu-tutorial\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #2085</a> added <code>nested_model.world</code> to the <code>INTEGRATION_world_reset</code> test, which is now failing for dart. We should probably disable that test for now.</p>\n<div class=\"codehilite\"><pre><span></span>$ gdb gzserver\n...\n<span class=\"o\">(</span>gdb<span class=\"o\">)</span> r worlds/nested_model.world -e dart --verbose\n...\nGazebo multi-robot simulator, version <span class=\"m\">7</span>.0.1\nCopyright <span class=\"o\">(</span>C<span class=\"o\">)</span> <span class=\"m\">2012</span>-2015 Open Source Robotics Foundation.\nReleased under the Apache <span class=\"m\">2</span> License.\nhttp://gazebosim.org\n\n<span class=\"o\">[</span>Msg<span class=\"o\">]</span> Waiting <span class=\"k\">for</span> master.\n<span class=\"o\">[</span>Msg<span class=\"o\">]</span> Connected to gazebo master @ http://127.0.0.1:11345\n<span class=\"o\">[</span>Msg<span class=\"o\">]</span> Publicized address: <span class=\"m\">172</span>.23.2.91\n...\nThe collision detector already has a collision node <span class=\"k\">for</span> body node <span class=\"o\">[</span>link_01<span class=\"o\">]</span>.\n<span class=\"o\">[</span>New Thread 0x7fff977fc700 <span class=\"o\">(</span>LWP <span class=\"m\">31762</span><span class=\"o\">)]</span>\n<span class=\"o\">[</span>New Thread 0x7fff96ffb700 <span class=\"o\">(</span>LWP <span class=\"m\">31763</span><span class=\"o\">)]</span>\n<span class=\"o\">[</span>New Thread 0x7fff967fa700 <span class=\"o\">(</span>LWP <span class=\"m\">31764</span><span class=\"o\">)]</span>\n<span class=\"o\">[</span>New Thread 0x7fff95ff9700 <span class=\"o\">(</span>LWP <span class=\"m\">31765</span><span class=\"o\">)]</span>\n***** Internal Program Error - assertion <span class=\"o\">(</span>dartLink2.get<span class=\"o\">()</span> !<span class=\"o\">=</span> __null<span class=\"o\">)</span> failed in virtual void gazebo::physics::DARTPhysics::UpdateCollision<span class=\"o\">()</span>:\n/data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc<span class=\"o\">(</span><span class=\"m\">156</span><span class=\"o\">)</span>: dartLink2 in collision pare is NULL\n\nProgram received signal SIGABRT, Aborted.\n<span class=\"o\">[</span>Switching to Thread 0x7fff967fa700 <span class=\"o\">(</span>LWP <span class=\"m\">31764</span><span class=\"o\">)]</span>\n0x00007ffff68bbcc9 in __GI_raise <span class=\"o\">(</span><span class=\"nv\">sig</span><span class=\"o\">=</span>sig@entry<span class=\"o\">=</span><span class=\"m\">6</span><span class=\"o\">)</span> at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n<span class=\"m\">56</span>  ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n<span class=\"o\">(</span>gdb<span class=\"o\">)</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>(gdb) bt\n#0  0x00007ffff68bbcc9 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007ffff68bf0d8 in __GI_abort () at abort.c:89\n#2  0x00007ffff61b4556 in boost::assertion::detail::assertion_failed_msg (expr=expr@entry=0x7ffff63338cb &quot;dartLink2.get() != __null&quot;, \n    msg=msg@entry=0x7ffff6333810 &quot;dartLink2 in collision pare is NULL&quot;, \n    function=function@entry=0x7ffff63350c0 &lt;gazebo::physics::DARTPhysics::UpdateCollision()::__PRETTY_FUNCTION__&gt; &quot;virtual void gazebo::physics::DARTPhysics::UpdateCollision()&quot;, \n    file=file@entry=0x7ffff6333768 &quot;/data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc&quot;, \n    line=line@entry=156) at /usr/include/boost/assert.hpp:108\n#3  0x00007ffff622b963 in gazebo::physics::DARTPhysics::UpdateCollision (this=0x17e6c20)\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/dart/DARTPhysics.cc:156\n#4  0x00007ffff62f0ec2 in gazebo::physics::World::Update (this=this@entry=0xcedf30)\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:750\n#5  0x00007ffff62fda4b in gazebo::physics::World::Step (this=this@entry=0xcedf30)\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:672\n#6  0x00007ffff62fde7d in gazebo::physics::World::RunLoop (this=0xcedf30)\n    at /data_fast/scpeters/ws/tmp/gazebo_build/src/gazebo/gazebo/physics/World.cc:481\n#7  0x00007ffff42dca4a in ?? () from /usr/lib/x86_64-linux-gnu/libboost_thread.so.1.54.0\n#8  0x00007ffff55a9182 in start_thread (arg=0x7fff967fa700) at pthread_create.c:312\n#9  0x00007ffff697f47d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n</pre></div>\n\n\n<p>This is with gazebo's default branch using dart 4.3.5 debian from the PPA.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2016-01-14T22:53:13.489098+00:00", "milestone": null, "updated_on": "2016-09-14T19:23:56.294405+00:00", "type": "issue", "id": 1833}