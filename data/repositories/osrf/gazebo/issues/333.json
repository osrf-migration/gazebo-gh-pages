{"priority": "critical", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/333/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/333.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/333/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/333/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/333/race-condition-using-uninitialized-scene"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/333/vote"}}, "reporter": {"display_name": "John Hsu", "uuid": "{0a186eae-abf0-4514-a951-23db5eccc286}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D"}, "html": {"href": "https://bitbucket.org/%7B0a186eae-abf0-4514-a951-23db5eccc286%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:f3968cd3-4910-4384-8349-482a6c7889ec/5445ce6e-6273-47f0-84eb-621c86ca11cb/128"}}, "nickname": "hsu", "type": "user", "account_id": "557058:f3968cd3-4910-4384-8349-482a6c7889ec"}, "title": "race condition, using uninitialized Scene::jointMsgs containing NaN's", "component": null, "votes": 0, "watches": 1, "content": {"raw": "starting pr2 simulation sometimes leads to this segfault:\r\n\r\n~~~\r\n(gdb) /home/hsu/projects/groovy/simulator_gazebo/gazebo/scripts/gui: line 2: 28902 Aborted                 (core dumped) `rospack find gazebo`/gazebo/bin/gzclient -g `rospack find gazebo`/lib/libgazebo_ros_paths_plugin.so\r\n[gazebo_gui-3] process has died [pid 28899, exit code 134, cmd /home/hsu/projects/groovy/simulator_gazebo/gazebo/scripts/gui __name:=gazebo_gui __log:=/home/hsu/.ros/log/dc93b228-513e-11e2-944f-90e2ba191409/gazebo_gui-3.log].\r\nlog file: /home/hsu/.ros/log/dc93b228-513e-11e2-944f-90e2ba191409/gazebo_gui-3*.log\r\nbt\r\n#0  0x00007ffff4f6e425 in __GI_raise (sig=<optimized out>) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\r\n#1  0x00007ffff4f71b8b in __GI_abort () at abort.c:91\r\n#2  0x00007ffff4f670ee in __assert_fail_base (fmt=<optimized out>, \r\n    assertion=0x7fffee9a63f0 \"!pos.isNaN() && \\\"Invalid vector supplied as parameter\\\"\", \r\n    file=0x7fffee9a62b0 \"/tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp\", line=<optimized out>, function=<optimized out>)\r\n    at assert.c:94\r\n#3  0x00007ffff4f67192 in __GI___assert_fail (\r\n    assertion=0x7fffee9a63f0 \"!pos.isNaN() && \\\"Invalid vector supplied as parameter\\\"\", \r\n    file=0x7fffee9a62b0 \"/tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp\", line=413, \r\n    function=0x7fffee9a67e0 \"virtual void Ogre::Node::setPosition(const Ogre::Vector3&)\") at assert.c:103\r\n#4  0x00007fffee7feb86 in setPosition (this=<optimized out>, pos=...)\r\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:413\r\n#5  Ogre::Node::setPosition (this=<optimized out>, pos=...)\r\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:411\r\n#6  0x00007fffee7fd972 in Ogre::Node::_setDerivedPosition (this=0x7fff48121f30, pos=...)\r\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:548\r\n#7  0x00007ffff29e4c86 in gazebo::rendering::Visual::SetWorldPosition (this=0xcbb2830, _pos=...)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Visual.cc:1263\r\n#8  0x00007ffff29645b9 in gazebo::rendering::JointVisual::Load (this=0xcbb2830, _msg=...)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/JointVisual.cc:55\r\n#9  0x00007ffff29aa5fe in gazebo::rendering::Scene::ProcessJointMsg (this=0x16d8bb0, _msg=...)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Scene.cc:1656\r\n#10 0x00007ffff29a8be5 in gazebo::rendering::Scene::PreRender (this=0x16d8bb0)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Scene.cc:1501\r\n#11 0x00007ffff29ce118 in boost::_mfi::mf0<void, gazebo::rendering::Scene>::operator() (this=0x2945fe8, p=0x16d8bb0)\r\n    at /usr/include/boost/bind/mem_fn_template.hpp:49\r\n#12 0x00007ffff29ccd2e in boost::_bi::list1<boost::_bi::value<gazebo::rendering::Scene*> >::operator()<boost::_mfi::mf0<void, gazebo::rendering::Scene>, boost::_bi::list0> (this=0x2945ff8, f=..., a=...) at /usr/include/boost/bind/bind.hpp:253\r\n#13 0x00007ffff29cb999 in boost::_bi::bind_t<void, boost::_mfi::mf0<void, gazebo::rendering::Scene>, boost::_bi::list1<boost::_bi::value<gazebo::rendering::Scene*> > >::operator() (this=0x2945fe8) at /usr/include/boost/bind/bind_template.hpp:20\r\n#14 0x00007ffff29c9d8e in boost::detail::function::void_function_obj_invoker0<boost::_bi::bind_t<void, boost::_mfi::mf0<void, gazebo::rendering::Scene>, boost::_bi::list1<boost::_bi::value<gazebo::rendering::Scene*> > >, void>::invoke (function_obj_ptr=...)\r\n    at /usr/include/boost/function/function_template.hpp:153\r\n#15 0x00007ffff74242d4 in boost::function0<void>::operator() (this=0x2945fe0)\r\n    at /usr/include/boost/function/function_template.hpp:1013\r\n#16 0x00007ffff7427f0b in gazebo::event::EventT<void ()>::Signal() (this=0x7ffff7dd89e0)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/common/Event.hh:126\r\n#17 0x00007ffff74258ce in gazebo::event::EventT<void ()>::operator()() (this=0x7ffff7dd89e0)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/common/Event.hh:119\r\n#18 0x00007ffff6c65e94 in gazebo::sensors::SensorManager::Update (this=0x7ffff733f5a0, _force=false)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/sensors/SensorManager.cc:87\r\n#19 0x00007ffff6c5ac2d in gazebo::sensors::run_once (_force=false)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/sensors/Sensors.cc:88\r\n#20 0x00000000004697b1 in gazebo::Server::Run (this=0x6e96f0)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/Server.cc:371\r\n#21 0x000000000046513f in main (argc=9, argv=0x7fffffffdcf8)\r\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/server_main.cc:32\r\n(gdb)\r\n~~~", "markup": "markdown", "html": "<p>starting pr2 simulation sometimes leads to this segfault:</p>\n<div class=\"codehilite\"><pre><span></span>(gdb) /home/hsu/projects/groovy/simulator_gazebo/gazebo/scripts/gui: line 2: 28902 Aborted                 (core dumped) `rospack find gazebo`/gazebo/bin/gzclient -g `rospack find gazebo`/lib/libgazebo_ros_paths_plugin.so\n[gazebo_gui-3] process has died [pid 28899, exit code 134, cmd /home/hsu/projects/groovy/simulator_gazebo/gazebo/scripts/gui __name:=gazebo_gui __log:=/home/hsu/.ros/log/dc93b228-513e-11e2-944f-90e2ba191409/gazebo_gui-3.log].\nlog file: /home/hsu/.ros/log/dc93b228-513e-11e2-944f-90e2ba191409/gazebo_gui-3*.log\nbt\n#0  0x00007ffff4f6e425 in __GI_raise (sig=&lt;optimized out&gt;) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#1  0x00007ffff4f71b8b in __GI_abort () at abort.c:91\n#2  0x00007ffff4f670ee in __assert_fail_base (fmt=&lt;optimized out&gt;, \n    assertion=0x7fffee9a63f0 &quot;!pos.isNaN() &amp;&amp; \\&quot;Invalid vector supplied as parameter\\&quot;&quot;, \n    file=0x7fffee9a62b0 &quot;/tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp&quot;, line=&lt;optimized out&gt;, function=&lt;optimized out&gt;)\n    at assert.c:94\n#3  0x00007ffff4f67192 in __GI___assert_fail (\n    assertion=0x7fffee9a63f0 &quot;!pos.isNaN() &amp;&amp; \\&quot;Invalid vector supplied as parameter\\&quot;&quot;, \n    file=0x7fffee9a62b0 &quot;/tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp&quot;, line=413, \n    function=0x7fffee9a67e0 &quot;virtual void Ogre::Node::setPosition(const Ogre::Vector3&amp;)&quot;) at assert.c:103\n#4  0x00007fffee7feb86 in setPosition (this=&lt;optimized out&gt;, pos=...)\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:413\n#5  Ogre::Node::setPosition (this=&lt;optimized out&gt;, pos=...)\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:411\n#6  0x00007fffee7fd972 in Ogre::Node::_setDerivedPosition (this=0x7fff48121f30, pos=...)\n    at /tmp/buildd/ros-groovy-visualization-common-1.8.4/debian/ros-groovy-visualization-common/opt/ros/groovy/stacks/visualization_common/ogre/build/ogre_src_v1-7-3/OgreMain/src/OgreNode.cpp:548\n#7  0x00007ffff29e4c86 in gazebo::rendering::Visual::SetWorldPosition (this=0xcbb2830, _pos=...)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Visual.cc:1263\n#8  0x00007ffff29645b9 in gazebo::rendering::JointVisual::Load (this=0xcbb2830, _msg=...)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/JointVisual.cc:55\n#9  0x00007ffff29aa5fe in gazebo::rendering::Scene::ProcessJointMsg (this=0x16d8bb0, _msg=...)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Scene.cc:1656\n#10 0x00007ffff29a8be5 in gazebo::rendering::Scene::PreRender (this=0x16d8bb0)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/rendering/Scene.cc:1501\n#11 0x00007ffff29ce118 in boost::_mfi::mf0&lt;void, gazebo::rendering::Scene&gt;::operator() (this=0x2945fe8, p=0x16d8bb0)\n    at /usr/include/boost/bind/mem_fn_template.hpp:49\n#12 0x00007ffff29ccd2e in boost::_bi::list1&lt;boost::_bi::value&lt;gazebo::rendering::Scene*&gt; &gt;::operator()&lt;boost::_mfi::mf0&lt;void, gazebo::rendering::Scene&gt;, boost::_bi::list0&gt; (this=0x2945ff8, f=..., a=...) at /usr/include/boost/bind/bind.hpp:253\n#13 0x00007ffff29cb999 in boost::_bi::bind_t&lt;void, boost::_mfi::mf0&lt;void, gazebo::rendering::Scene&gt;, boost::_bi::list1&lt;boost::_bi::value&lt;gazebo::rendering::Scene*&gt; &gt; &gt;::operator() (this=0x2945fe8) at /usr/include/boost/bind/bind_template.hpp:20\n#14 0x00007ffff29c9d8e in boost::detail::function::void_function_obj_invoker0&lt;boost::_bi::bind_t&lt;void, boost::_mfi::mf0&lt;void, gazebo::rendering::Scene&gt;, boost::_bi::list1&lt;boost::_bi::value&lt;gazebo::rendering::Scene*&gt; &gt; &gt;, void&gt;::invoke (function_obj_ptr=...)\n    at /usr/include/boost/function/function_template.hpp:153\n#15 0x00007ffff74242d4 in boost::function0&lt;void&gt;::operator() (this=0x2945fe0)\n    at /usr/include/boost/function/function_template.hpp:1013\n#16 0x00007ffff7427f0b in gazebo::event::EventT&lt;void ()&gt;::Signal() (this=0x7ffff7dd89e0)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/common/Event.hh:126\n#17 0x00007ffff74258ce in gazebo::event::EventT&lt;void ()&gt;::operator()() (this=0x7ffff7dd89e0)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/common/Event.hh:119\n#18 0x00007ffff6c65e94 in gazebo::sensors::SensorManager::Update (this=0x7ffff733f5a0, _force=false)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/sensors/SensorManager.cc:87\n#19 0x00007ffff6c5ac2d in gazebo::sensors::run_once (_force=false)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/sensors/Sensors.cc:88\n#20 0x00000000004697b1 in gazebo::Server::Run (this=0x6e96f0)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/Server.cc:371\n#21 0x000000000046513f in main (argc=9, argv=0x7fffffffdcf8)\n    at /home/hsu/projects/groovy/simulator_gazebo/gazebo/build/gazebo-hg/gazebo/server_main.cc:32\n(gdb)\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "closed", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2012-12-28T23:00:24.609262+00:00", "milestone": null, "updated_on": "2016-09-14T19:43:44.229171+00:00", "type": "issue", "id": 333}