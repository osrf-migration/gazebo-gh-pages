{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2610/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2610.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2610/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2610/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2610/ctest-nmake-fail-to-run-the-tests-on"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2610/vote"}}, "reporter": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "title": "ctest/nmake fail to run the tests on Windows", "component": null, "votes": 0, "watches": 1, "content": {"raw": "There is a problem when running tests on Windows using ctest or nmake. The error displayed by Jenkins (also present locally) is:\r\n\r\n```\r\nTest project D:/Jenkins/workspace/gazebo-ci-pr_any-windows7-amd64/ws/gazebo/build\r\n    Start 65: UNIT_Timer_TEST\r\n1/2 Test #65: UNIT_Timer_TEST ..................***Exception: Exit code 0xc0000135\r\n  0.00 sec\r\n```\r\n\r\nI think that the exception 0xc0000135 refers to the lack of a DLL to run the app. If the same test is called directly using the full path the test is executed fine. My main hypothesis is that somehow the PATH is not being respected (not the same) when running the tests through ctest.\r\n\r\nWe are using [cmake to include the PATH inside the tests](#!/osrf/gazebo/src/0cc79a2e3c176cfd3bdf5437918c502eb0c5c59c/cmake/GazeboTestUtils.cmake#lines-65). One of my tests was to [modify the release-tools script to add the PATH before configure gazebo](https://bitbucket.org/osrf/release-tools/compare/gazebo_windows_run_tests_clean%0Ddefault#diff) with the hope of getting the right paths at configuring time but no luck.\r\n\r\nThe results of that [release-tools modification](https://bitbucket.org/osrf/release-tools/compare/gazebo_windows_run_tests_clean%0Ddefault#diff) can be found here: \r\nhttps://build.osrfoundation.org/job/gazebo-ci-pr_any-windows7-amd64/2504/console#console-section-1\r\n\r\n@seanyen-msft do you have any idea what could be wrong? //cc @scpeters", "markup": "markdown", "html": "<p>There is a problem when running tests on Windows using ctest or nmake. The error displayed by Jenkins (also present locally) is:</p>\n<div class=\"codehilite\"><pre><span></span>Test project D:/Jenkins/workspace/gazebo-ci-pr_any-windows7-amd64/ws/gazebo/build\n    Start 65: UNIT_Timer_TEST\n1/2 Test #65: UNIT_Timer_TEST ..................***Exception: Exit code 0xc0000135\n  0.00 sec\n</pre></div>\n\n\n<p>I think that the exception 0xc0000135 refers to the lack of a DLL to run the app. If the same test is called directly using the full path the test is executed fine. My main hypothesis is that somehow the PATH is not being respected (not the same) when running the tests through ctest.</p>\n<p>We are using <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/0cc79a2e3c176cfd3bdf5437918c502eb0c5c59c/cmake/GazeboTestUtils.cmake#lines-65\" rel=\"nofollow\">cmake to include the PATH inside the tests</a>. One of my tests was to <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/release-tools/compare/gazebo_windows_run_tests_clean%0Ddefault#diff\" rel=\"nofollow\">modify the release-tools script to add the PATH before configure gazebo</a> with the hope of getting the right paths at configuring time but no luck.</p>\n<p>The results of that <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/release-tools/compare/gazebo_windows_run_tests_clean%0Ddefault#diff\" rel=\"nofollow\">release-tools modification</a> can be found here: \n<a href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any-windows7-amd64/2504/console#console-section-1\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/gazebo-ci-pr_any-windows7-amd64/2504/console#console-section-1</a></p>\n<p>@seanyen-msft do you have any idea what could be wrong? //cc @scpeters</p>", "type": "rendered"}, "assignee": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "state": "new", "version": null, "edited_on": null, "created_on": "2019-03-26T21:47:13.483419+00:00", "milestone": null, "updated_on": "2019-03-27T20:16:14.241302+00:00", "type": "issue", "id": 2610}