{"priority": "minor", "kind": "proposal", "repository": {"links": {"self": {"href": "data/repositories/osrf/gazebo.json"}, "html": {"href": "#!/osrf/gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}ts=1694483"}}, "type": "repository", "name": "gazebo", "full_name": "osrf/gazebo", "uuid": "{51a0cd5d-8697-4eb1-8b08-e919ee881e1c}"}, "links": {"attachments": {"href": "data/repositories/osrf/gazebo/issues/2185/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gazebo/issues/2185.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2185/watch"}, "comments": {"href": "data/repositories/osrf/gazebo/issues/2185/comments_page=1.json"}, "html": {"href": "#!/osrf/gazebo/issues/2185/linkstate-pose-is-it-relative-or-world"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo/issues/2185/vote"}}, "reporter": {"display_name": "Jennifer Buehler", "uuid": "{5949baad-8c43-4d52-9a82-bb8c3511fed8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D"}, "html": {"href": "https://bitbucket.org/%7B5949baad-8c43-4d52-9a82-bb8c3511fed8%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/b28ae0e95eada6ee16f0860c1fa59fdcd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJB-4.png"}}, "nickname": "JenniferBuehler", "type": "user", "account_id": "557058:96bd489a-ec14-4a06-8d31-7bb6d46d1209"}, "title": "LinkState pose: is it relative or world?", "component": {"name": "physics", "links": {"self": {"href": "data/repositories/osrf/gazebo/components/122876.json"}}}, "votes": 0, "watches": 3, "content": {"raw": "This is more of a question than an issue at this point, but it could be that there are discrepancies in the documentation or usage of LinkState / Link.\r\n\r\nI want to create a physics::LinkState out of a msgs::Link message. I noticed then that in [Link::SetState](#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/Link.cc?at=default&fileviewer=file-view-default#Link.cc-1272), the world pose is used:\r\n\r\n```cpp\r\n//////////////////////////////////////////////////\r\nvoid Link::SetState(const LinkState &_state)\r\n{\r\n  this->SetWorldPose(_state.Pose());\r\n...\r\n```  \r\n\r\nHowever in [LinkState](#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/LinkState.hh?at=default&fileviewer=file-view-default#LinkState.hh-247), the documentation says this is the pose relative to the model:\r\n\r\n```cpp\r\n      /// \\brief 3D pose of the link relative to the model.\r\n      private: ignition::math::Pose3d pose;\r\n```\r\n\r\nand the relative pose is also what is being used in [Link::ProcessMsg](#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/Link.cc?at=default&fileviewer=file-view-default#Link.cc-1178) \r\n\r\n```cpp\r\n if (_msg.has_pose())\r\n  {\r\n    this->SetEnabled(true);\r\n    this->SetRelativePose(msgs::ConvertIgn(_msg.pose()));\r\n  }\r\n```\r\nDoes msgs::Link use the relative pose, while the physics::LinkState uses world pose? Or are they both meant to use the relative pose? Unless I'm missing something here, in the former case, the comment in LinkState should be updated, in the latter Link::SetState has to set the relative pose instead of the world pose.", "markup": "markdown", "html": "<p>This is more of a question than an issue at this point, but it could be that there are discrepancies in the documentation or usage of LinkState / Link.</p>\n<p>I want to create a physics::LinkState out of a msgs::Link message. I noticed then that in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/Link.cc?at=default&amp;fileviewer=file-view-default#Link.cc-1272\" rel=\"nofollow\">Link::SetState</a>, the world pose is used:</p>\n<div class=\"codehilite language-cpp\"><pre><span></span><span class=\"c1\">//////////////////////////////////////////////////</span>\n<span class=\"kt\">void</span> <span class=\"n\">Link</span><span class=\"o\">::</span><span class=\"n\">SetState</span><span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"n\">LinkState</span> <span class=\"o\">&amp;</span><span class=\"n\">_state</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n  <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">SetWorldPose</span><span class=\"p\">(</span><span class=\"n\">_state</span><span class=\"p\">.</span><span class=\"n\">Pose</span><span class=\"p\">());</span>\n<span class=\"p\">...</span>\n</pre></div>\n\n\n<p>However in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/LinkState.hh?at=default&amp;fileviewer=file-view-default#LinkState.hh-247\" rel=\"nofollow\">LinkState</a>, the documentation says this is the pose relative to the model:</p>\n<div class=\"codehilite language-cpp\"><pre><span></span>      <span class=\"c1\">/// \\brief 3D pose of the link relative to the model.</span>\n      <span class=\"k\">private</span><span class=\"o\">:</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">math</span><span class=\"o\">::</span><span class=\"n\">Pose3d</span> <span class=\"n\">pose</span><span class=\"p\">;</span>\n</pre></div>\n\n\n<p>and the relative pose is also what is being used in <a data-is-external-link=\"true\" href=\"#!/osrf/gazebo/src/56be256c4ba911e9ffb6fece23b0c51170f6dbdf/gazebo/physics/Link.cc?at=default&amp;fileviewer=file-view-default#Link.cc-1178\" rel=\"nofollow\">Link::ProcessMsg</a> </p>\n<div class=\"codehilite language-cpp\"><pre><span></span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">_msg</span><span class=\"p\">.</span><span class=\"n\">has_pose</span><span class=\"p\">())</span>\n  <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">SetEnabled</span><span class=\"p\">(</span><span class=\"nb\">true</span><span class=\"p\">);</span>\n    <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">SetRelativePose</span><span class=\"p\">(</span><span class=\"n\">msgs</span><span class=\"o\">::</span><span class=\"n\">ConvertIgn</span><span class=\"p\">(</span><span class=\"n\">_msg</span><span class=\"p\">.</span><span class=\"n\">pose</span><span class=\"p\">()));</span>\n  <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>Does msgs::Link use the relative pose, while the physics::LinkState uses world pose? Or are they both meant to use the relative pose? Unless I'm missing something here, in the former case, the comment in LinkState should be updated, in the latter Link::SetState has to set the relative pose instead of the world pose.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": {"name": "all", "links": {"self": {"href": "data/repositories/osrf/gazebo/versions/225575.json"}}}, "edited_on": null, "created_on": "2017-02-07T00:28:34.636916+00:00", "milestone": null, "updated_on": "2017-02-08T16:58:23.665563+00:00", "type": "issue", "id": 2185}